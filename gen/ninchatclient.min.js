"use strict";
(function() {

Error.stackTraceLimit=Infinity;var $global,$module;if(typeof window!=="undefined"){$global=window;}else if(typeof self!=="undefined"){$global=self;}else if(typeof global!=="undefined"){$global=global;$global.require=require;}else{console.log("warning: no global object found");}if(typeof module!=="undefined"){$module=module;}var $packages={},$reflect,$idCounter=0;var $keys=function(m){return m?Object.keys(m):[];};var $min=Math.min;var $mod=function(x,y){return x%y;};var $parseInt=parseInt;var $parseFloat=function(f){if(f!==undefined&&f!==null&&f.constructor===Number){return f;}return parseFloat(f);};var $flushConsole=function(){};var $mapArray=function(array,f){var newArray=new array.constructor(array.length),i;for(i=0;i<array.length;i++){newArray[i]=f(array[i]);}return newArray;};var $methodVal=function(recv,name){var vals=recv.$methodVals||{};recv.$methodVals=vals;var f=vals[name];if(f!==undefined){return f;}var method=recv[name];f=function(){$stackDepthOffset--;try{return method.apply(recv,arguments);}finally{$stackDepthOffset++;}};vals[name]=f;return f;};var $methodExpr=function(method){if(method.$expr===undefined){method.$expr=function(){$stackDepthOffset--;try{return Function.call.apply(method,arguments);}finally{$stackDepthOffset++;}};}return method.$expr;};var $subslice=function(slice,low,high,max){if(low<0||high<low||max<high||high>slice.$capacity||max>slice.$capacity){$throwRuntimeError("slice bounds out of range");}var s=new slice.constructor(slice.$array);s.$offset=slice.$offset+low;s.$length=slice.$length-low;s.$capacity=slice.$capacity-low;if(high!==undefined){s.$length=high-low;}if(max!==undefined){s.$capacity=max-low;}return s;};var $sliceToArray=function(slice){if(slice.$length===0){return[];}if(slice.$array.constructor!==Array){return slice.$array.subarray(slice.$offset,slice.$offset+slice.$length);}return slice.$array.slice(slice.$offset,slice.$offset+slice.$length);};var $decodeRune=function(str,pos){var c0=str.charCodeAt(pos);if(c0<0x80){return[c0,1];}if(c0!==c0||c0<0xC0){return[0xFFFD,1];}var c1=str.charCodeAt(pos+1);if(c1!==c1||c1<0x80||0xC0<=c1){return[0xFFFD,1];}if(c0<0xE0){var r=(c0&0x1F)<<6|(c1&0x3F);if(r<=0x7F){return[0xFFFD,1];}return[r,2];}var c2=str.charCodeAt(pos+2);if(c2!==c2||c2<0x80||0xC0<=c2){return[0xFFFD,1];}if(c0<0xF0){var r=(c0&0x0F)<<12|(c1&0x3F)<<6|(c2&0x3F);if(r<=0x7FF){return[0xFFFD,1];}if(0xD800<=r&&r<=0xDFFF){return[0xFFFD,1];}return[r,3];}var c3=str.charCodeAt(pos+3);if(c3!==c3||c3<0x80||0xC0<=c3){return[0xFFFD,1];}if(c0<0xF8){var r=(c0&0x07)<<18|(c1&0x3F)<<12|(c2&0x3F)<<6|(c3&0x3F);if(r<=0xFFFF||0x10FFFF<r){return[0xFFFD,1];}return[r,4];}return[0xFFFD,1];};var $encodeRune=function(r){if(r<0||r>0x10FFFF||(0xD800<=r&&r<=0xDFFF)){r=0xFFFD;}if(r<=0x7F){return String.fromCharCode(r);}if(r<=0x7FF){return String.fromCharCode(0xC0|r>>6,0x80|(r&0x3F));}if(r<=0xFFFF){return String.fromCharCode(0xE0|r>>12,0x80|(r>>6&0x3F),0x80|(r&0x3F));}return String.fromCharCode(0xF0|r>>18,0x80|(r>>12&0x3F),0x80|(r>>6&0x3F),0x80|(r&0x3F));};var $stringToBytes=function(str){var array=new Uint8Array(str.length),i;for(i=0;i<str.length;i++){array[i]=str.charCodeAt(i);}return array;};var $bytesToString=function(slice){if(slice.$length===0){return"";}var str="",i;for(i=0;i<slice.$length;i+=10000){str+=String.fromCharCode.apply(null,slice.$array.subarray(slice.$offset+i,slice.$offset+Math.min(slice.$length,i+10000)));}return str;};var $stringToRunes=function(str){var array=new Int32Array(str.length);var rune,i,j=0;for(i=0;i<str.length;i+=rune[1],j++){rune=$decodeRune(str,i);array[j]=rune[0];}return array.subarray(0,j);};var $runesToString=function(slice){if(slice.$length===0){return"";}var str="",i;for(i=0;i<slice.$length;i++){str+=$encodeRune(slice.$array[slice.$offset+i]);}return str;};var $copyString=function(dst,src){var n=Math.min(src.length,dst.$length),i;for(i=0;i<n;i++){dst.$array[dst.$offset+i]=src.charCodeAt(i);}return n;};var $copySlice=function(dst,src){var n=Math.min(src.$length,dst.$length),i;$internalCopy(dst.$array,src.$array,dst.$offset,src.$offset,n,dst.constructor.elem);return n;};var $copy=function(dst,src,type){var i;switch(type.kind){case $kindArray:$internalCopy(dst,src,0,0,src.length,type.elem);return true;case $kindStruct:for(i=0;i<type.fields.length;i++){var field=type.fields[i];var name=field[0];if(!$copy(dst[name],src[name],field[3])){dst[name]=src[name];}}return true;default:return false;}};var $internalCopy=function(dst,src,dstOffset,srcOffset,n,elem){var i;if(n===0){return;}if(src.subarray){dst.set(src.subarray(srcOffset,srcOffset+n),dstOffset);return;}switch(elem.kind){case $kindArray:case $kindStruct:for(i=0;i<n;i++){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}for(i=0;i<n;i++){dst[dstOffset+i]=src[srcOffset+i];}};var $clone=function(src,type){var clone=type.zero();$copy(clone,src,type);return clone;};var $append=function(slice){return $internalAppend(slice,arguments,1,arguments.length-1);};var $appendSlice=function(slice,toAppend){return $internalAppend(slice,toAppend.$array,toAppend.$offset,toAppend.$length);};var $internalAppend=function(slice,array,offset,length){if(length===0){return slice;}var newArray=slice.$array;var newOffset=slice.$offset;var newLength=slice.$length+length;var newCapacity=slice.$capacity;if(newLength>newCapacity){newOffset=0;newCapacity=Math.max(newLength,slice.$capacity<1024?slice.$capacity*2:Math.floor(slice.$capacity*5/4));if(slice.$array.constructor===Array){newArray=slice.$array.slice(slice.$offset,slice.$offset+slice.$length);newArray.length=newCapacity;var zero=slice.constructor.elem.zero,i;for(i=slice.$length;i<newCapacity;i++){newArray[i]=zero();}}else{newArray=new slice.$array.constructor(newCapacity);newArray.set(slice.$array.subarray(slice.$offset,slice.$offset+slice.$length));}}$internalCopy(newArray,array,newOffset+slice.$length,offset,length,slice.constructor.elem);var newSlice=new slice.constructor(newArray);newSlice.$offset=newOffset;newSlice.$length=newLength;newSlice.$capacity=newCapacity;return newSlice;};var $equal=function(a,b,type){if(a===b){return true;}var i;switch(type.kind){case $kindFloat32:return $float32IsEqual(a,b);case $kindComplex64:return $float32IsEqual(a.$real,b.$real)&&$float32IsEqual(a.$imag,b.$imag);case $kindComplex128:return a.$real===b.$real&&a.$imag===b.$imag;case $kindInt64:case $kindUint64:return a.$high===b.$high&&a.$low===b.$low;case $kindPtr:if(a.constructor.Struct){return false;}return $pointerIsEqual(a,b);case $kindArray:if(a.length!=b.length){return false;}var i;for(i=0;i<a.length;i++){if(!$equal(a[i],b[i],type.elem)){return false;}}return true;case $kindStruct:for(i=0;i<type.fields.length;i++){var field=type.fields[i];var name=field[0];if(!$equal(a[name],b[name],field[3])){return false;}}return true;default:return false;}};var $interfaceIsEqual=function(a,b){if(a===null||b===null||a===undefined||b===undefined||a.constructor!==b.constructor){return a===b;}switch(a.constructor.kind){case $kindFunc:case $kindMap:case $kindSlice:case $kindStruct:$throwRuntimeError("comparing uncomparable type "+a.constructor.string);case undefined:return a===b;default:return $equal(a.$val,b.$val,a.constructor);}};var $float32IsEqual=function(a,b){if(a===b){return true;}if(a===1/0||b===1/0||a===-1/0||b===-1/0||a!==a||b!==b){return false;}var math=$packages["math"];return math!==undefined&&math.Float32bits(a)===math.Float32bits(b);};var $pointerIsEqual=function(a,b){if(a===b){return true;}if(a.$get===$throwNilPointerError||b.$get===$throwNilPointerError){return a.$get===$throwNilPointerError&&b.$get===$throwNilPointerError;}var va=a.$get();var vb=b.$get();if(va!==vb){return false;}var dummy=va+1;a.$set(dummy);var equal=b.$get()===dummy;a.$set(va);return equal;};var $kindBool=1;var $kindInt=2;var $kindInt8=3;var $kindInt16=4;var $kindInt32=5;var $kindInt64=6;var $kindUint=7;var $kindUint8=8;var $kindUint16=9;var $kindUint32=10;var $kindUint64=11;var $kindUintptr=12;var $kindFloat32=13;var $kindFloat64=14;var $kindComplex64=15;var $kindComplex128=16;var $kindArray=17;var $kindChan=18;var $kindFunc=19;var $kindInterface=20;var $kindMap=21;var $kindPtr=22;var $kindSlice=23;var $kindString=24;var $kindStruct=25;var $kindUnsafePointer=26;var $newType=function(size,kind,string,name,pkgPath,constructor){var typ;switch(kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindString:case $kindUnsafePointer:typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+this.$val;};break;case $kindFloat32:case $kindFloat64:typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+$floatKey(this.$val);};break;case $kindInt64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case $kindUint64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case $kindComplex64:case $kindComplex128:typ=function(real,imag){this.$real=real;this.$imag=imag;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$real+"$"+this.$imag;};break;case $kindArray:typ=function(v){this.$val=v;};typ.Ptr=$newType(4,$kindPtr,"*"+string,"","",function(array){this.$get=function(){return array;};this.$set=function(v){$copy(this,v,typ);};this.$val=array;});typ.init=function(elem,len){typ.elem=elem;typ.len=len;typ.prototype.$key=function(){return string+"$"+Array.prototype.join.call($mapArray(this.$val,function(e){var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}),"$");};typ.extendReflectType=function(rt){rt.arrayType=new $reflect.arrayType.Ptr(rt,elem.reflectType(),undefined,len);};typ.Ptr.init(typ);Object.defineProperty(typ.Ptr.nil,"nilCheck",{get:$throwNilPointerError});};break;case $kindChan:typ=function(capacity){this.$val=this;this.$capacity=capacity;this.$buffer=[];this.$sendQueue=[];this.$recvQueue=[];this.$closed=false;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem,sendOnly,recvOnly){typ.elem=elem;typ.sendOnly=sendOnly;typ.recvOnly=recvOnly;typ.nil=new typ(0);typ.nil.$sendQueue=typ.nil.$recvQueue={length:0,push:function(){},shift:function(){return undefined;},indexOf:function(){return-1;}};typ.extendReflectType=function(rt){rt.chanType=new $reflect.chanType.Ptr(rt,elem.reflectType(),sendOnly?$reflect.SendDir:(recvOnly?$reflect.RecvDir:$reflect.BothDir));};};break;case $kindFunc:typ=function(v){this.$val=v;};typ.init=function(params,results,variadic){typ.params=params;typ.results=results;typ.variadic=variadic;typ.extendReflectType=function(rt){var typeSlice=($sliceType($ptrType($reflect.rtype.Ptr)));rt.funcType=new $reflect.funcType.Ptr(rt,variadic,new typeSlice($mapArray(params,function(p){return p.reflectType();})),new typeSlice($mapArray(results,function(p){return p.reflectType();})));};};break;case $kindInterface:typ={implementedBy:{},missingMethodFor:{}};typ.init=function(methods){typ.methods=methods;typ.extendReflectType=function(rt){var imethods=$mapArray(methods,function(m){return new $reflect.imethod.Ptr($newStringPtr(m[1]),$newStringPtr(m[2]),m[3].reflectType());});var methodSlice=($sliceType($ptrType($reflect.imethod.Ptr)));rt.interfaceType=new $reflect.interfaceType.Ptr(rt,new methodSlice(imethods));};};break;case $kindMap:typ=function(v){this.$val=v;};typ.init=function(key,elem){typ.key=key;typ.elem=elem;typ.extendReflectType=function(rt){rt.mapType=new $reflect.mapType.Ptr(rt,key.reflectType(),elem.reflectType(),undefined,undefined);};};break;case $kindPtr:typ=constructor||function(getter,setter,target){this.$get=getter;this.$set=setter;this.$target=target;this.$val=this;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem){typ.nil=new typ($throwNilPointerError,$throwNilPointerError);typ.extendReflectType=function(rt){rt.ptrType=new $reflect.ptrType.Ptr(rt,elem.reflectType());};};break;case $kindSlice:var nativeArray;typ=function(array){if(array.constructor!==nativeArray){array=new nativeArray(array);}this.$array=array;this.$offset=0;this.$length=array.length;this.$capacity=array.length;this.$val=this;};typ.make=function(length,capacity){capacity=capacity||length;var array=new nativeArray(capacity),i;if(nativeArray===Array){for(i=0;i<capacity;i++){array[i]=typ.elem.zero();}}var slice=new typ(array);slice.$length=length;return slice;};typ.init=function(elem){typ.elem=elem;nativeArray=$nativeArray(elem.kind);typ.nil=new typ([]);typ.extendReflectType=function(rt){rt.sliceType=new $reflect.sliceType.Ptr(rt,elem.reflectType());};};break;case $kindStruct:typ=function(v){this.$val=v;};typ.Ptr=$newType(4,$kindPtr,"*"+string,"","",constructor);typ.Ptr.Struct=typ;typ.Ptr.prototype.$get=function(){return this;};typ.Ptr.prototype.$set=function(v){$copy(this,v,typ);};typ.init=function(fields){var i;typ.fields=fields;typ.prototype.$key=function(){var val=this.$val;return string+"$"+$mapArray(fields,function(field){var e=val[field[0]];var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}).join("$");};typ.Ptr.extendReflectType=function(rt){rt.ptrType=new $reflect.ptrType.Ptr(rt,typ.reflectType());};typ.Ptr.nil=Object.create(constructor.prototype);typ.Ptr.nil.$val=typ.Ptr.nil;for(i=0;i<fields.length;i++){var field=fields[i];Object.defineProperty(typ.Ptr.nil,field[0],{get:$throwNilPointerError,set:$throwNilPointerError});}for(i=0;i<typ.methods.length;i++){var m=typ.methods[i];if(m[4]!=-1){(function(field,methodName){typ.prototype[methodName]=function(){var v=this.$val[field[0]];return v[methodName].apply(v,arguments);};})(fields[m[4]],m[0]);}}for(i=0;i<typ.Ptr.methods.length;i++){var m=typ.Ptr.methods[i];if(m[4]!=-1){(function(field,methodName){typ.Ptr.prototype[methodName]=function(){var v=this[field[0]];if(v.$val===undefined){v=new field[3](v);}return v[methodName].apply(v,arguments);};})(fields[m[4]],m[0]);}}typ.extendReflectType=function(rt){var reflectFields=new Array(fields.length),i;for(i=0;i<fields.length;i++){var field=fields[i];reflectFields[i]=new $reflect.structField.Ptr($newStringPtr(field[1]),$newStringPtr(field[2]),field[3].reflectType(),$newStringPtr(field[4]),i);}rt.structType=new $reflect.structType.Ptr(rt,new($sliceType($reflect.structField.Ptr))(reflectFields));};};break;default:$panic(new $String("invalid kind: "+kind));}switch(kind){case $kindBool:case $kindMap:typ.zero=function(){return false;};break;case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindUnsafePointer:case $kindFloat32:case $kindFloat64:typ.zero=function(){return 0;};break;case $kindString:typ.zero=function(){return"";};break;case $kindInt64:case $kindUint64:case $kindComplex64:case $kindComplex128:var zero=new typ(0,0);typ.zero=function(){return zero;};break;case $kindChan:case $kindPtr:case $kindSlice:typ.zero=function(){return typ.nil;};break;case $kindFunc:typ.zero=function(){return $throwNilPointerError;};break;case $kindInterface:typ.zero=function(){return $ifaceNil;};break;case $kindArray:typ.zero=function(){var arrayClass=$nativeArray(typ.elem.kind);if(arrayClass!==Array){return new arrayClass(typ.len);}var array=new Array(typ.len),i;for(i=0;i<typ.len;i++){array[i]=typ.elem.zero();}return array;};break;case $kindStruct:typ.zero=function(){return new typ.Ptr();};break;default:$panic(new $String("invalid kind: "+kind));}typ.kind=kind;typ.string=string;typ.typeName=name;typ.pkgPath=pkgPath;typ.methods=[];var rt=null;typ.reflectType=function(){if(rt===null){rt=new $reflect.rtype.Ptr(size,0,0,0,0,kind,undefined,undefined,$newStringPtr(string),undefined,undefined);rt.jsType=typ;var methods=[];if(typ.methods!==undefined){var i;for(i=0;i<typ.methods.length;i++){var m=typ.methods[i];var t=m[3];methods.push(new $reflect.method.Ptr($newStringPtr(m[1]),$newStringPtr(m[2]),t.reflectType(),$funcType([typ].concat(t.params),t.results,t.variadic).reflectType(),undefined,undefined));}}if(name!==""||methods.length!==0){var methodSlice=($sliceType($ptrType($reflect.method.Ptr)));rt.uncommonType=new $reflect.uncommonType.Ptr($newStringPtr(name),$newStringPtr(pkgPath),new methodSlice(methods));rt.uncommonType.jsType=typ;}if(typ.extendReflectType!==undefined){typ.extendReflectType(rt);}}return rt;};return typ;};var $Bool=$newType(1,$kindBool,"bool","bool","",null);var $Int=$newType(4,$kindInt,"int","int","",null);var $Int8=$newType(1,$kindInt8,"int8","int8","",null);var $Int16=$newType(2,$kindInt16,"int16","int16","",null);var $Int32=$newType(4,$kindInt32,"int32","int32","",null);var $Int64=$newType(8,$kindInt64,"int64","int64","",null);var $Uint=$newType(4,$kindUint,"uint","uint","",null);var $Uint8=$newType(1,$kindUint8,"uint8","uint8","",null);var $Uint16=$newType(2,$kindUint16,"uint16","uint16","",null);var $Uint32=$newType(4,$kindUint32,"uint32","uint32","",null);var $Uint64=$newType(8,$kindUint64,"uint64","uint64","",null);var $Uintptr=$newType(4,$kindUintptr,"uintptr","uintptr","",null);var $Float32=$newType(4,$kindFloat32,"float32","float32","",null);var $Float64=$newType(8,$kindFloat64,"float64","float64","",null);var $Complex64=$newType(8,$kindComplex64,"complex64","complex64","",null);var $Complex128=$newType(16,$kindComplex128,"complex128","complex128","",null);var $String=$newType(8,$kindString,"string","string","",null);var $UnsafePointer=$newType(4,$kindUnsafePointer,"unsafe.Pointer","Pointer","",null);var $nativeArray=function(elemKind){switch(elemKind){case $kindInt:return Int32Array;case $kindInt8:return Int8Array;case $kindInt16:return Int16Array;case $kindInt32:return Int32Array;case $kindUint:return Uint32Array;case $kindUint8:return Uint8Array;case $kindUint16:return Uint16Array;case $kindUint32:return Uint32Array;case $kindUintptr:return Uint32Array;case $kindFloat32:return Float32Array;case $kindFloat64:return Float64Array;default:return Array;}};var $toNativeArray=function(elemKind,array){var nativeArray=$nativeArray(elemKind);if(nativeArray===Array){return array;}return new nativeArray(array);};var $arrayTypes={};var $arrayType=function(elem,len){var string="["+len+"]"+elem.string;var typ=$arrayTypes[string];if(typ===undefined){typ=$newType(12,$kindArray,string,"","",null);typ.init(elem,len);$arrayTypes[string]=typ;}return typ;};var $chanType=function(elem,sendOnly,recvOnly){var string=(recvOnly?"<-":"")+"chan"+(sendOnly?"<- ":" ")+elem.string;var field=sendOnly?"SendChan":(recvOnly?"RecvChan":"Chan");var typ=elem[field];if(typ===undefined){typ=$newType(4,$kindChan,string,"","",null);typ.init(elem,sendOnly,recvOnly);elem[field]=typ;}return typ;};var $funcTypes={};var $funcType=function(params,results,variadic){var paramTypes=$mapArray(params,function(p){return p.string;});if(variadic){paramTypes[paramTypes.length-1]="..."+paramTypes[paramTypes.length-1].substr(2);}var string="func("+paramTypes.join(", ")+")";if(results.length===1){string+=" "+results[0].string;}else if(results.length>1){string+=" ("+$mapArray(results,function(r){return r.string;}).join(", ")+")";}var typ=$funcTypes[string];if(typ===undefined){typ=$newType(4,$kindFunc,string,"","",null);typ.init(params,results,variadic);$funcTypes[string]=typ;}return typ;};var $interfaceTypes={};var $interfaceType=function(methods){var string="interface {}";if(methods.length!==0){string="interface { "+$mapArray(methods,function(m){return(m[2]!==""?m[2]+".":"")+m[1]+m[3].string.substr(4);}).join("; ")+" }";}var typ=$interfaceTypes[string];if(typ===undefined){typ=$newType(8,$kindInterface,string,"","",null);typ.init(methods);$interfaceTypes[string]=typ;}return typ;};var $emptyInterface=$interfaceType([]);var $ifaceNil={$key:function(){return"nil";}};var $error=$newType(8,$kindInterface,"error","error","",null);$error.init([["Error","Error","",$funcType([],[$String],false)]]);var $Map=function(){};(function(){var names=Object.getOwnPropertyNames(Object.prototype),i;for(i=0;i<names.length;i++){$Map.prototype[names[i]]=undefined;}})();var $mapTypes={};var $mapType=function(key,elem){var string="map["+key.string+"]"+elem.string;var typ=$mapTypes[string];if(typ===undefined){typ=$newType(4,$kindMap,string,"","",null);typ.init(key,elem);$mapTypes[string]=typ;}return typ;};var $throwNilPointerError=function(){$throwRuntimeError("invalid memory address or nil pointer dereference");};var $ptrType=function(elem){var typ=elem.Ptr;if(typ===undefined){typ=$newType(4,$kindPtr,"*"+elem.string,"","",null);typ.init(elem);elem.Ptr=typ;}return typ;};var $stringPtrMap=new $Map();var $newStringPtr=function(str){if(str===undefined||str===""){return $ptrType($String).nil;}var ptr=$stringPtrMap[str];if(ptr===undefined){ptr=new($ptrType($String))(function(){return str;},function(v){str=v;});$stringPtrMap[str]=ptr;}return ptr;};var $newDataPointer=function(data,constructor){if(constructor.Struct){return data;}return new constructor(function(){return data;},function(v){data=v;});};var $sliceType=function(elem){var typ=elem.Slice;if(typ===undefined){typ=$newType(12,$kindSlice,"[]"+elem.string,"","",null);typ.init(elem);elem.Slice=typ;}return typ;};var $structTypes={};var $structType=function(fields){var string="struct { "+$mapArray(fields,function(f){return f[1]+" "+f[3].string+(f[4]!==""?(" \""+f[4].replace(/\\/g,"\\\\").replace(/"/g, "\\\"")+"\""):"");}).join("; ")+" }";if(fields.length===0){string="struct {}";}var typ=$structTypes[string];if(typ===undefined){typ=$newType(0,$kindStruct,string,"","",function(){this.$val=this;var i;for(i=0;i<fields.length;i++){var field=fields[i];var arg=arguments[i];this[field[0]]=arg!==undefined?arg:field[3].zero();}});var i,j;for(i=0;i<fields.length;i++){var field=fields[i];if(field[1]===""){var methods=field[3].methods;for(j=0;j<methods.length;j++){var m=methods[j].slice(0,6).concat([i]);typ.methods.push(m);typ.Ptr.methods.push(m);}if(field[3].kind===$kindStruct){var methods=field[3].Ptr.methods;for(j=0;j<methods.length;j++){typ.Ptr.methods.push(methods[j].slice(0,6).concat([i]));}}}}typ.init(fields);$structTypes[string]=typ;}return typ;};var $assertType=function(value,type,returnTuple){var isInterface=(type.kind===$kindInterface),ok,missingMethod="";if(value===$ifaceNil){ok=false;}else if(!isInterface){ok=value.constructor===type;}else if(type.string==="js.Object"){ok=true;}else{var valueTypeString=value.constructor.string;ok=type.implementedBy[valueTypeString];if(ok===undefined){ok=true;var valueMethods=value.constructor.methods;var typeMethods=type.methods;for(var i=0;i<typeMethods.length;i++){var tm=typeMethods[i];var found=false;for(var j=0;j<valueMethods.length;j++){var vm=valueMethods[j];if(vm[1]===tm[1]&&vm[2]===tm[2]&&vm[3]===tm[3]){found=true;break;}}if(!found){ok=false;type.missingMethodFor[valueTypeString]=tm[1];break;}}type.implementedBy[valueTypeString]=ok;}if(!ok){missingMethod=type.missingMethodFor[valueTypeString];}}if(!ok){if(returnTuple){return[type.zero(),false];}$panic(new $packages["runtime"].TypeAssertionError.Ptr("",(value===$ifaceNil?"":value.constructor.string),type.string,missingMethod));}if(!isInterface){value=value.$val;}return returnTuple?[value,true]:value;};var $coerceFloat32=function(f){var math=$packages["math"];if(math===undefined){return f;}return math.Float32frombits(math.Float32bits(f));};var $floatKey=function(f){if(f!==f){$idCounter++;return"NaN$"+$idCounter;}return String(f);};var $flatten64=function(x){return x.$high*4294967296+x.$low;};var $shiftLeft64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high<<y|x.$low>>>(32-y),(x.$low<<y)>>>0);}if(y<64){return new x.constructor(x.$low<<(y-32),0);}return new x.constructor(0,0);};var $shiftRightInt64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(x.$high>>31,(x.$high>>(y-32))>>>0);}if(x.$high<0){return new x.constructor(-1,4294967295);}return new x.constructor(0,0);};var $shiftRightUint64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(0,x.$high>>>(y-32));}return new x.constructor(0,0);};var $mul64=function(x,y){var high=0,low=0,i;if((y.$low&1)!==0){high=x.$high;low=x.$low;}for(i=1;i<32;i++){if((y.$low&1<<i)!==0){high+=x.$high<<i|x.$low>>>(32-i);low+=(x.$low<<i)>>>0;}}for(i=0;i<32;i++){if((y.$high&1<<i)!==0){high+=x.$low<<i;}}return new x.constructor(high,low);};var $div64=function(x,y,returnRemainder){if(y.$high===0&&y.$low===0){$throwRuntimeError("integer divide by zero");}var s=1;var rs=1;var xHigh=x.$high;var xLow=x.$low;if(xHigh<0){s=-1;rs=-1;xHigh=-xHigh;if(xLow!==0){xHigh--;xLow=4294967296-xLow;}}var yHigh=y.$high;var yLow=y.$low;if(y.$high<0){s*=-1;yHigh=-yHigh;if(yLow!==0){yHigh--;yLow=4294967296-yLow;}}var high=0,low=0,n=0,i;while(yHigh<2147483648&&((xHigh>yHigh)||(xHigh===yHigh&&xLow>yLow))){yHigh=(yHigh<<1|yLow>>>31)>>>0;yLow=(yLow<<1)>>>0;n++;}for(i=0;i<=n;i++){high=high<<1|low>>>31;low=(low<<1)>>>0;if((xHigh>yHigh)||(xHigh===yHigh&&xLow>=yLow)){xHigh=xHigh-yHigh;xLow=xLow-yLow;if(xLow<0){xHigh--;xLow+=4294967296;}low++;if(low===4294967296){high++;low=0;}}yLow=(yLow>>>1|yHigh<<(32-1))>>>0;yHigh=yHigh>>>1;}if(returnRemainder){return new x.constructor(xHigh*rs,xLow*rs);}return new x.constructor(high*s,low*s);};var $divComplex=function(n,d){var ninf=n.$real===1/0||n.$real===-1/0||n.$imag===1/0||n.$imag===-1/0;var dinf=d.$real===1/0||d.$real===-1/0||d.$imag===1/0||d.$imag===-1/0;var nnan=!ninf&&(n.$real!==n.$real||n.$imag!==n.$imag);var dnan=!dinf&&(d.$real!==d.$real||d.$imag!==d.$imag);if(nnan||dnan){return new n.constructor(0/0,0/0);}if(ninf&&!dinf){return new n.constructor(1/0,1/0);}if(!ninf&&dinf){return new n.constructor(0,0);}if(d.$real===0&&d.$imag===0){if(n.$real===0&&n.$imag===0){return new n.constructor(0/0,0/0);}return new n.constructor(1/0,1/0);}var a=Math.abs(d.$real);var b=Math.abs(d.$imag);if(a<=b){var ratio=d.$real/d.$imag;var denom=d.$real*ratio+d.$imag;return new n.constructor((n.$real*ratio+n.$imag)/denom,(n.$imag*ratio-n.$real)/denom);}var ratio=d.$imag/d.$real;var denom=d.$imag*ratio+d.$real;return new n.constructor((n.$imag*ratio+n.$real)/denom,(n.$imag-n.$real*ratio)/denom);};var $stackDepthOffset=0;var $getStackDepth=function(){var err=new Error();if(err.stack===undefined){return undefined;}return $stackDepthOffset+err.stack.split("\n").length;};var $deferFrames=[],$skippedDeferFrames=0,$jumpToDefer=false,$panicStackDepth=null,$panicValue;var $callDeferred=function(deferred,jsErr){if($skippedDeferFrames!==0){$skippedDeferFrames--;throw jsErr;}if($jumpToDefer){$jumpToDefer=false;throw jsErr;}if(jsErr){var newErr=null;try{$deferFrames.push(deferred);$panic(new $packages["github.com/gopherjs/gopherjs/js"].Error.Ptr(jsErr));}catch(err){newErr=err;}$deferFrames.pop();$callDeferred(deferred,newErr);return;}$stackDepthOffset--;var outerPanicStackDepth=$panicStackDepth;var outerPanicValue=$panicValue;var localPanicValue=$curGoroutine.panicStack.pop();if(localPanicValue!==undefined){$panicStackDepth=$getStackDepth();$panicValue=localPanicValue;}var call,localSkippedDeferFrames=0;try{while(true){if(deferred===null){deferred=$deferFrames[$deferFrames.length-1-localSkippedDeferFrames];if(deferred===undefined){var msg;if(localPanicValue.constructor===$String){msg=localPanicValue.$val;}else if(localPanicValue.Error!==undefined){msg=localPanicValue.Error();}else if(localPanicValue.String!==undefined){msg=localPanicValue.String();}else{msg=localPanicValue;}var e=new Error(msg);if(localPanicValue.Stack!==undefined){e.stack=localPanicValue.Stack();e.stack=msg+e.stack.substr(e.stack.indexOf("\n"));}throw e;}}var call=deferred.pop();if(call===undefined){if(localPanicValue!==undefined){localSkippedDeferFrames++;deferred=null;continue;}return;}var r=call[0].apply(undefined,call[1]);if(r&&r.$blocking){deferred.push([r,[]]);}if(localPanicValue!==undefined&&$panicStackDepth===null){throw null;}}}finally{$skippedDeferFrames+=localSkippedDeferFrames;if($curGoroutine.asleep){deferred.push(call);$jumpToDefer=true;}if(localPanicValue!==undefined){if($panicStackDepth!==null){$curGoroutine.panicStack.push(localPanicValue);}$panicStackDepth=outerPanicStackDepth;$panicValue=outerPanicValue;}$stackDepthOffset++;}};var $panic=function(value){$curGoroutine.panicStack.push(value);$callDeferred(null,null);};var $recover=function(){if($panicStackDepth===null||($panicStackDepth!==undefined&&$panicStackDepth!==$getStackDepth()-2)){return $ifaceNil;}$panicStackDepth=null;return $panicValue;};var $nonblockingCall=function(){$panic(new $packages["runtime"].NotSupportedError.Ptr("non-blocking call to blocking function (mark call with \"//gopherjs:blocking\" to fix)"));};var $throw=function(err){throw err;};var $throwRuntimeError;var $dummyGoroutine={asleep:false,exit:false,panicStack:[]};var $curGoroutine=$dummyGoroutine,$totalGoroutines=0,$awakeGoroutines=0,$checkForDeadlock=true;var $go=function(fun,args,direct){$totalGoroutines++;$awakeGoroutines++;args.push(true);var goroutine=function(){var rescheduled=false;try{$curGoroutine=goroutine;$skippedDeferFrames=0;$jumpToDefer=false;var r=fun.apply(undefined,args);if(r&&r.$blocking){fun=r;args=[];$schedule(goroutine,direct);rescheduled=true;return;}goroutine.exit=true;}catch(err){if(!$curGoroutine.asleep){goroutine.exit=true;throw err;}}finally{$curGoroutine=$dummyGoroutine;if(goroutine.exit&&!rescheduled){$totalGoroutines--;goroutine.asleep=true;}if(goroutine.asleep&&!rescheduled){$awakeGoroutines--;if($awakeGoroutines===0&&$totalGoroutines!==0&&$checkForDeadlock){console.error("fatal error: all goroutines are asleep - deadlock!");}}}};goroutine.asleep=false;goroutine.exit=false;goroutine.panicStack=[];$schedule(goroutine,direct);};var $scheduled=[],$schedulerLoopActive=false;var $schedule=function(goroutine,direct){if(goroutine.asleep){goroutine.asleep=false;$awakeGoroutines++;}if(direct){goroutine();return;}$scheduled.push(goroutine);if(!$schedulerLoopActive){$schedulerLoopActive=true;setTimeout(function(){while(true){var r=$scheduled.shift();if(r===undefined){$schedulerLoopActive=false;break;}r();};},0);}};var $send=function(chan,value){if(chan.$closed){$throwRuntimeError("send on closed channel");}var queuedRecv=chan.$recvQueue.shift();if(queuedRecv!==undefined){queuedRecv([value,true]);return;}if(chan.$buffer.length<chan.$capacity){chan.$buffer.push(value);return;}var thisGoroutine=$curGoroutine;chan.$sendQueue.push(function(){$schedule(thisGoroutine);return value;});var blocked=false;var f=function(){if(blocked){if(chan.$closed){$throwRuntimeError("send on closed channel");}return;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $recv=function(chan){var queuedSend=chan.$sendQueue.shift();if(queuedSend!==undefined){chan.$buffer.push(queuedSend());}var bufferedValue=chan.$buffer.shift();if(bufferedValue!==undefined){return[bufferedValue,true];}if(chan.$closed){return[chan.constructor.elem.zero(),false];}var thisGoroutine=$curGoroutine,value;var queueEntry=function(v){value=v;$schedule(thisGoroutine);};chan.$recvQueue.push(queueEntry);var blocked=false;var f=function(){if(blocked){return value;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $close=function(chan){if(chan.$closed){$throwRuntimeError("close of closed channel");}chan.$closed=true;while(true){var queuedSend=chan.$sendQueue.shift();if(queuedSend===undefined){break;}queuedSend();}while(true){var queuedRecv=chan.$recvQueue.shift();if(queuedRecv===undefined){break;}queuedRecv([chan.constructor.elem.zero(),false]);}};var $select=function(comms){var ready=[],i;var selection=-1;for(i=0;i<comms.length;i++){var comm=comms[i];var chan=comm[0];switch(comm.length){case 0:selection=i;break;case 1:if(chan.$sendQueue.length!==0||chan.$buffer.length!==0||chan.$closed){ready.push(i);}break;case 2:if(chan.$closed){$throwRuntimeError("send on closed channel");}if(chan.$recvQueue.length!==0||chan.$buffer.length<chan.$capacity){ready.push(i);}break;}}if(ready.length!==0){selection=ready[Math.floor(Math.random()*ready.length)];}if(selection!==-1){var comm=comms[selection];switch(comm.length){case 0:return[selection];case 1:return[selection,$recv(comm[0])];case 2:$send(comm[0],comm[1]);return[selection];}}var entries=[];var thisGoroutine=$curGoroutine;var removeFromQueues=function(){for(i=0;i<entries.length;i++){var entry=entries[i];var queue=entry[0];var index=queue.indexOf(entry[1]);if(index!==-1){queue.splice(index,1);}}};for(i=0;i<comms.length;i++){(function(i){var comm=comms[i];switch(comm.length){case 1:var queueEntry=function(value){selection=[i,value];removeFromQueues();$schedule(thisGoroutine);};entries.push([comm[0].$recvQueue,queueEntry]);comm[0].$recvQueue.push(queueEntry);break;case 2:var queueEntry=function(){if(comm[0].$closed){$throwRuntimeError("send on closed channel");}selection=[i];removeFromQueues();$schedule(thisGoroutine);return comm[1];};entries.push([comm[0].$sendQueue,queueEntry]);comm[0].$sendQueue.push(queueEntry);break;}})(i);}var blocked=false;var f=function(){if(blocked){return selection;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $needsExternalization=function(t){switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return false;case $kindInterface:return t!==$packages["github.com/gopherjs/gopherjs/js"].Object;default:return true;}};var $externalize=function(v,t){switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return v;case $kindInt64:case $kindUint64:return $flatten64(v);case $kindArray:if($needsExternalization(t.elem)){return $mapArray(v,function(e){return $externalize(e,t.elem);});}return v;case $kindFunc:if(v===$throwNilPointerError){return null;}if(v.$externalizeWrapper===undefined){$checkForDeadlock=false;var convert=false;var i;for(i=0;i<t.params.length;i++){convert=convert||(t.params[i]!==$packages["github.com/gopherjs/gopherjs/js"].Object);}for(i=0;i<t.results.length;i++){convert=convert||$needsExternalization(t.results[i]);}if(!convert){return v;}v.$externalizeWrapper=function(){var args=[],i;for(i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=[],j;for(j=i;j<arguments.length;j++){varargs.push($internalize(arguments[j],vt));}args.push(new(t.params[i])(varargs));break;}args.push($internalize(arguments[i],t.params[i]));}var result=v.apply(this,args);switch(t.results.length){case 0:return;case 1:return $externalize(result,t.results[0]);default:for(i=0;i<t.results.length;i++){result[i]=$externalize(result[i],t.results[i]);}return result;}};}return v.$externalizeWrapper;case $kindInterface:if(v===$ifaceNil){return null;}if(t===$packages["github.com/gopherjs/gopherjs/js"].Object||v.constructor.kind===undefined){return v;}return $externalize(v.$val,v.constructor);case $kindMap:var m={};var keys=$keys(v),i;for(i=0;i<keys.length;i++){var entry=v[keys[i]];m[$externalize(entry.k,t.key)]=$externalize(entry.v,t.elem);}return m;case $kindPtr:var o={},i;for(i=0;i<t.methods.length;i++){var m=t.methods[i];if(m[2]!==""){continue;}(function(m){o[m[1]]=$externalize(function(){return v[m[0]].apply(v,arguments);},m[3]);})(m);}return o;case $kindSlice:if($needsExternalization(t.elem)){return $mapArray($sliceToArray(v),function(e){return $externalize(e,t.elem);});}return $sliceToArray(v);case $kindString:var s="",r,i,j=0;for(i=0;i<v.length;i+=r[1],j++){r=$decodeRune(v,i);s+=String.fromCharCode(r[0]);}return s;case $kindStruct:var timePkg=$packages["time"];if(timePkg&&v.constructor===timePkg.Time.Ptr){var milli=$div64(v.UnixNano(),new $Int64(0,1000000));return new Date($flatten64(milli));}var o={},i;for(i=0;i<t.fields.length;i++){var f=t.fields[i];if(f[2]!==""){continue;}o[f[1]]=$externalize(v[f[0]],f[3]);}return o;}$panic(new $String("cannot externalize "+t.string));};var $internalize=function(v,t,recv){switch(t.kind){case $kindBool:return!!v;case $kindInt:return parseInt(v);case $kindInt8:return parseInt(v)<<24>>24;case $kindInt16:return parseInt(v)<<16>>16;case $kindInt32:return parseInt(v)>>0;case $kindUint:return parseInt(v);case $kindUint8:return parseInt(v)<<24>>>24;case $kindUint16:return parseInt(v)<<16>>>16;case $kindUint32:case $kindUintptr:return parseInt(v)>>>0;case $kindInt64:case $kindUint64:return new t(0,v);case $kindFloat32:case $kindFloat64:return parseFloat(v);case $kindArray:if(v.length!==t.len){$throwRuntimeError("got array with wrong size from JavaScript native");}return $mapArray(v,function(e){return $internalize(e,t.elem);});case $kindFunc:return function(){var args=[],i;for(i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=arguments[i],j;for(j=0;j<varargs.$length;j++){args.push($externalize(varargs.$array[varargs.$offset+j],vt));}break;}args.push($externalize(arguments[i],t.params[i]));}var result=v.apply(recv,args);switch(t.results.length){case 0:return;case 1:return $internalize(result,t.results[0]);default:for(i=0;i<t.results.length;i++){result[i]=$internalize(result[i],t.results[i]);}return result;}};case $kindInterface:if(t===$packages["github.com/gopherjs/gopherjs/js"].Object){return v;}if(v===null){return $ifaceNil;}switch(v.constructor){case Int8Array:return new($sliceType($Int8))(v);case Int16Array:return new($sliceType($Int16))(v);case Int32Array:return new($sliceType($Int))(v);case Uint8Array:return new($sliceType($Uint8))(v);case Uint16Array:return new($sliceType($Uint16))(v);case Uint32Array:return new($sliceType($Uint))(v);case Float32Array:return new($sliceType($Float32))(v);case Float64Array:return new($sliceType($Float64))(v);case Array:return $internalize(v,$sliceType($emptyInterface));case Boolean:return new $Bool(!!v);case Date:var timePkg=$packages["time"];if(timePkg){return new timePkg.Time(timePkg.Unix(new $Int64(0,0),new $Int64(0,v.getTime()*1000000)));}case Function:var funcType=$funcType([$sliceType($emptyInterface)],[$packages["github.com/gopherjs/gopherjs/js"].Object],true);return new funcType($internalize(v,funcType));case Number:return new $Float64(parseFloat(v));case String:return new $String($internalize(v,$String));default:if($global.Node&&v instanceof $global.Node){return v;}var mapType=$mapType($String,$emptyInterface);return new mapType($internalize(v,mapType));}case $kindMap:var m=new $Map();var keys=$keys(v),i;for(i=0;i<keys.length;i++){var key=$internalize(keys[i],t.key);m[key.$key?key.$key():key]={k:key,v:$internalize(v[keys[i]],t.elem)};}return m;case $kindSlice:return new t($mapArray(v,function(e){return $internalize(e,t.elem);}));case $kindString:v=String(v);var s="",i;for(i=0;i<v.length;i++){s+=$encodeRune(v.charCodeAt(i));}return s;default:$panic(new $String("cannot internalize "+t.string));}};
$packages["github.com/gopherjs/gopherjs/js"]=(function(){var $pkg={},A,B,H;A=$pkg.Object=$newType(8,$kindInterface,"js.Object","Object","github.com/gopherjs/gopherjs/js",null);B=$pkg.Error=$newType(0,$kindStruct,"js.Error","Error","github.com/gopherjs/gopherjs/js",function(Object_){this.$val=this;this.Object=Object_!==undefined?Object_:$ifaceNil;});B.Ptr.prototype.Error=function(){var a;a=this;return"JavaScript error: "+$internalize(a.Object.message,$String);};B.prototype.Error=function(){return this.$val.Error();};B.Ptr.prototype.Stack=function(){var a;a=this;return $internalize(a.Object.stack,$String);};B.prototype.Stack=function(){return this.$val.Stack();};H=function(){var a;a=new B.Ptr($ifaceNil);};$pkg.$init=function(){$pkg.$init=function(){};var $r,$s=0;var $f=function(){while(true){switch($s){case 0:A.init([["Bool","Bool","",$funcType([],[$Bool],false)],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true)],["Delete","Delete","",$funcType([$String],[],false)],["Float","Float","",$funcType([],[$Float64],false)],["Get","Get","",$funcType([$String],[A],false)],["Index","Index","",$funcType([$Int],[A],false)],["Int","Int","",$funcType([],[$Int],false)],["Int64","Int64","",$funcType([],[$Int64],false)],["Interface","Interface","",$funcType([],[$emptyInterface],false)],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true)],["IsNull","IsNull","",$funcType([],[$Bool],false)],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false)],["Length","Length","",$funcType([],[$Int],false)],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true)],["Set","Set","",$funcType([$String,$emptyInterface],[],false)],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false)],["Str","Str","",$funcType([],[$String],false)],["Uint64","Uint64","",$funcType([],[$Uint64],false)],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false)]]);B.methods=[["Bool","Bool","",$funcType([],[$Bool],false),0],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true),0],["Delete","Delete","",$funcType([$String],[],false),0],["Float","Float","",$funcType([],[$Float64],false),0],["Get","Get","",$funcType([$String],[A],false),0],["Index","Index","",$funcType([$Int],[A],false),0],["Int","Int","",$funcType([],[$Int],false),0],["Int64","Int64","",$funcType([],[$Int64],false),0],["Interface","Interface","",$funcType([],[$emptyInterface],false),0],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true),0],["IsNull","IsNull","",$funcType([],[$Bool],false),0],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false),0],["Length","Length","",$funcType([],[$Int],false),0],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true),0],["Set","Set","",$funcType([$String,$emptyInterface],[],false),0],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false),0],["Str","Str","",$funcType([],[$String],false),0],["Uint64","Uint64","",$funcType([],[$Uint64],false),0],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false),0]];($ptrType(B)).methods=[["Bool","Bool","",$funcType([],[$Bool],false),0],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true),0],["Delete","Delete","",$funcType([$String],[],false),0],["Error","Error","",$funcType([],[$String],false),-1],["Float","Float","",$funcType([],[$Float64],false),0],["Get","Get","",$funcType([$String],[A],false),0],["Index","Index","",$funcType([$Int],[A],false),0],["Int","Int","",$funcType([],[$Int],false),0],["Int64","Int64","",$funcType([],[$Int64],false),0],["Interface","Interface","",$funcType([],[$emptyInterface],false),0],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true),0],["IsNull","IsNull","",$funcType([],[$Bool],false),0],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false),0],["Length","Length","",$funcType([],[$Int],false),0],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true),0],["Set","Set","",$funcType([$String,$emptyInterface],[],false),0],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false),0],["Stack","Stack","",$funcType([],[$String],false),-1],["Str","Str","",$funcType([],[$String],false),0],["Uint64","Uint64","",$funcType([],[$Uint64],false),0],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false),0]];B.init([["Object","","",A,""]]);H();}return;}};$f.$blocking=true;return $f;};return $pkg;})();
$packages["runtime"]=(function(){var $pkg={},A=$packages["github.com/gopherjs/gopherjs/js"],C,V,X,D;C=$pkg.NotSupportedError=$newType(0,$kindStruct,"runtime.NotSupportedError","NotSupportedError","runtime",function(Feature_){this.$val=this;this.Feature=Feature_!==undefined?Feature_:"";});V=$pkg.TypeAssertionError=$newType(0,$kindStruct,"runtime.TypeAssertionError","TypeAssertionError","runtime",function(interfaceString_,concreteString_,assertedString_,missingMethod_){this.$val=this;this.interfaceString=interfaceString_!==undefined?interfaceString_:"";this.concreteString=concreteString_!==undefined?concreteString_:"";this.assertedString=assertedString_!==undefined?assertedString_:"";this.missingMethod=missingMethod_!==undefined?missingMethod_:"";});X=$pkg.errorString=$newType(8,$kindString,"runtime.errorString","errorString","runtime",null);C.Ptr.prototype.Error=function(){var a;a=this;return"not supported by GopherJS: "+a.Feature;};C.prototype.Error=function(){return this.$val.Error();};D=function(){var a;$throwRuntimeError=(function(a){$panic(new X(a));});a=$ifaceNil;a=new V.Ptr("","","","");a=new C.Ptr("");};V.Ptr.prototype.RuntimeError=function(){};V.prototype.RuntimeError=function(){return this.$val.RuntimeError();};V.Ptr.prototype.Error=function(){var a,b;a=this;b=a.interfaceString;if(b===""){b="interface";}if(a.concreteString===""){return"interface conversion: "+b+" is nil, not "+a.assertedString;}if(a.missingMethod===""){return"interface conversion: "+b+" is "+a.concreteString+", not "+a.assertedString;}return"interface conversion: "+a.concreteString+" is not "+a.assertedString+": missing method "+a.missingMethod;};V.prototype.Error=function(){return this.$val.Error();};X.prototype.RuntimeError=function(){var a;a=this.$val!==undefined?this.$val:this;};$ptrType(X).prototype.RuntimeError=function(){return new X(this.$get()).RuntimeError();};X.prototype.Error=function(){var a;a=this.$val!==undefined?this.$val:this;return"runtime error: "+a;};$ptrType(X).prototype.Error=function(){return new X(this.$get()).Error();};$pkg.$init=function(){$pkg.$init=function(){};var $r,$s=0;var $f=function(){while(true){switch($s){case 0:$r=A.$init(true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}($ptrType(C)).methods=[["Error","Error","",$funcType([],[$String],false),-1]];C.init([["Feature","Feature","",$String,""]]);($ptrType(V)).methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];V.init([["interfaceString","interfaceString","runtime",$String,""],["concreteString","concreteString","runtime",$String,""],["assertedString","assertedString","runtime",$String,""],["missingMethod","missingMethod","runtime",$String,""]]);X.methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];($ptrType(X)).methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];D();}return;}};$f.$blocking=true;return $f;};return $pkg;})();
$packages["errors"]=(function(){var $pkg={},B,A;B=$pkg.errorString=$newType(0,$kindStruct,"errors.errorString","errorString","errors",function(s_){this.$val=this;this.s=s_!==undefined?s_:"";});A=$pkg.New=function(a){return new B.Ptr(a);};B.Ptr.prototype.Error=function(){var a;a=this;return a.s;};B.prototype.Error=function(){return this.$val.Error();};$pkg.$init=function(){$pkg.$init=function(){};var $r,$s=0;var $f=function(){while(true){switch($s){case 0:($ptrType(B)).methods=[["Error","Error","",$funcType([],[$String],false),-1]];B.init([["s","s","errors",$String,""]]);}return;}};$f.$blocking=true;return $f;};return $pkg;})();
$packages["sort"]=(function(){var $pkg={},A;A=$pkg.Search=function(a,b){var c,d,e,f,g,h;c=0;d=a;e=c;f=d;while(e<f){h=e+(g=((f-e>>0))/2,(g===g&&g!==1/0&&g!==-1/0)?g>>0:$throwRuntimeError("integer divide by zero"))>>0;if(!b(h)){e=h+1>>0;}else{f=h;}}return e;};$pkg.$init=function(){$pkg.$init=function(){};var $r,$s=0;var $f=function(){while(true){switch($s){case 0:}return;}};$f.$blocking=true;return $f;};return $pkg;})();
$packages["ninchatclient"]=(function(){var $pkg={},A=$packages["errors"],B=$packages["github.com/gopherjs/gopherjs/js"],C=$packages["sort"],D,L,AL,AO,AP,AR,AS,AU,AX,AJ,AN,BE,E,F,G,H,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Z,AA,AB,AC,AD,AE,AF,AG,AH,AI,AK,AM,AQ,AT,AV,AW,AY,AZ,BA,BB,BC,BD,BF,BG,BH;D=$pkg.Action=$newType(0,$kindStruct,"main.Action","Action","ninchatclient",function(Id_,Header_,Payload_,Deferred_,name_){this.$val=this;this.Id=Id_!==undefined?Id_:new $Uint64(0,0);this.Header=Header_!==undefined?Header_:$ifaceNil;this.Payload=Payload_!==undefined?Payload_:$ifaceNil;this.Deferred=Deferred_!==undefined?Deferred_:($ptrType(AL)).nil;this.name=name_!==undefined?name_:"";});L=$pkg.Backoff=$newType(0,$kindStruct,"main.Backoff","Backoff","ninchatclient",function(lastSlot_){this.$val=this;this.lastSlot=lastSlot_!==undefined?lastSlot_:0;});AL=$pkg.Deferred=$newType(0,$kindStruct,"main.Deferred","Deferred","ninchatclient",function(resolve_,reject_,notify_){this.$val=this;this.resolve=resolve_!==undefined?resolve_:($sliceType(B.Object)).nil;this.reject=reject_!==undefined?reject_:($sliceType(B.Object)).nil;this.notify=notify_!==undefined?notify_:($sliceType(B.Object)).nil;});AO=$pkg.Transport=$newType(4,$kindFunc,"main.Transport","Transport","ninchatclient",null);AP=$pkg.Session=$newType(0,$kindStruct,"main.Session","Session","ninchatclient",function(onSessionEvent_,onEvent_,onConnState_,onConnActive_,onLog_,address_,forceLongPoll_,sessionParams_,sessionId_,latestConnState_,latestConnActive_,lastActionId_,sendNotify_,sendBuffer_,numSent_,sendEventAck_,receivedEventId_,ackedEventId_,closeNotify_,closed_,stopped_){this.$val=this;this.onSessionEvent=onSessionEvent_!==undefined?onSessionEvent_:$ifaceNil;this.onEvent=onEvent_!==undefined?onEvent_:$ifaceNil;this.onConnState=onConnState_!==undefined?onConnState_:$ifaceNil;this.onConnActive=onConnActive_!==undefined?onConnActive_:$ifaceNil;this.onLog=onLog_!==undefined?onLog_:$ifaceNil;this.address=address_!==undefined?address_:"";this.forceLongPoll=forceLongPoll_!==undefined?forceLongPoll_:false;this.sessionParams=sessionParams_!==undefined?sessionParams_:$ifaceNil;this.sessionId=sessionId_!==undefined?sessionId_:$ifaceNil;this.latestConnState=latestConnState_!==undefined?latestConnState_:"";this.latestConnActive=latestConnActive_!==undefined?latestConnActive_:new AR(0,0);this.lastActionId=lastActionId_!==undefined?lastActionId_:new $Uint64(0,0);this.sendNotify=sendNotify_!==undefined?sendNotify_:($chanType($Bool,false,false)).nil;this.sendBuffer=sendBuffer_!==undefined?sendBuffer_:($sliceType(($ptrType(D)))).nil;this.numSent=numSent_!==undefined?numSent_:0;this.sendEventAck=sendEventAck_!==undefined?sendEventAck_:false;this.receivedEventId=receivedEventId_!==undefined?receivedEventId_:new $Uint64(0,0);this.ackedEventId=ackedEventId_!==undefined?ackedEventId_:new $Uint64(0,0);this.closeNotify=closeNotify_!==undefined?closeNotify_:($chanType($Bool,false,false)).nil;this.closed=closed_!==undefined?closed_:false;this.stopped=stopped_!==undefined?stopped_:false;});AR=$pkg.Time=$newType(8,$kindInt64,"main.Time","Time","ninchatclient",null);AS=$pkg.Duration=$newType(8,$kindInt64,"main.Duration","Duration","ninchatclient",null);AU=$pkg.Timer=$newType(0,$kindStruct,"main.Timer","Timer","ninchatclient",function(C_,id_){this.$val=this;this.C=C_!==undefined?C_:($chanType($Bool,false,false)).nil;this.id=id_!==undefined?id_:$ifaceNil;});AX=$pkg.WebSocket=$newType(0,$kindStruct,"main.WebSocket","WebSocket","ninchatclient",function(Notify_,impl_,open_,error_,buffer_){this.$val=this;this.Notify=Notify_!==undefined?Notify_:($chanType($Bool,false,false)).nil;this.impl=impl_!==undefined?impl_:$ifaceNil;this.open=open_!==undefined?open_:false;this.error=error_!==undefined?error_:$ifaceNil;this.buffer=buffer_!==undefined?buffer_:($sliceType(B.Object)).nil;});D.Ptr.prototype.Name=function(){var a;a=this;if(a.name===""){a.name=$internalize(a.Header.action,$String);}return a.name;};D.prototype.Name=function(){return this.$val.Name();};E=$pkg.GetAddress=function(a){if((a===undefined)||(a===null)){return"api.ninchat.com";}else{return $internalize(a,$String);}};F=$pkg.GetEndpointHosts=function(a){var b=($sliceType($String)).nil,c=$ifaceNil,$deferred=[],$err=null,d,e,f,g;try{$deferFrames.push($deferred);$deferred.push([(function(){var d;d=Q($recover());if(!($interfaceIsEqual(d,$ifaceNil))){c=d;}}),[]]);d=Z(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return[b,c];}f=e.hosts;if($parseInt(f.length)===0){c=A.New("endpoint hosts array is empty");return[b,c];}b=($sliceType($String)).make($parseInt(f.length));g=0;while(g<$parseInt(f.length)){(g<0||g>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+g]=$internalize(f[g],$String);g=g+(1)>>0;}return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};G=$pkg.GetSessionEventCredentials=function(a){var b=$ifaceNil,c=$ifaceNil,d=$ifaceNil,e=new $Uint64(0,0),f=false,g=$ifaceNil,$deferred=[],$err=null,h;try{$deferFrames.push($deferred);$deferred.push([(function(){var h;h=Q($recover());if(!($interfaceIsEqual(h,$ifaceNil))){g=h;}}),[]]);if(!($internalize(a.event,$String)==="session_created")){return[b,c,d,e,f,g];}b=a.user_id;h=a.user_auth;if(!(h===undefined)){c=h;}d=a.session_id;e=$internalize(a.event_id,$Uint64);f=true;return[b,c,d,e,f,g];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d,e,f,g];}};H=$pkg.GetEventFrames=function(a){var b=0,c=$ifaceNil,$deferred=[],$err=null,d;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);d=a.frames;if(!(d===undefined)){b=$parseInt(d)>>0;if(b<0){b=0;}}return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};I=$pkg.GetEventAndActionId=function(a){var b=new $Uint64(0,0),c=new $Uint64(0,0),d=$ifaceNil,$deferred=[],$err=null,e,f;try{$deferFrames.push($deferred);$deferred.push([(function(){d=Q($recover());}),[]]);e=a.event_id;if(!(e===undefined)){b=$internalize(e,$Uint64);}f=a.action_id;if(!(f===undefined)){c=$internalize(f,$Uint64);}return[b,c,d];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d];}};J=$pkg.IsEventLastReply=function(a,b){var c=false,d=$ifaceNil,$deferred=[],$err=null,e,f,g;try{$deferFrames.push($deferred);$deferred.push([(function(){d=Q($recover());}),[]]);c=true;e=a.history_length;if(!(e===undefined)){if(($parseInt(e)>>0)>0){c=false;}}if(b.name==="search"){f=a.users;g=a.channels;if(!(f===undefined)||!(g===undefined)){c=false;}}return[c,d];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[c,d];}};K=$pkg.GetEventError=function(a){var b="",c="",d=false,e=$ifaceNil,$deferred=[],$err=null,f,g;try{$deferFrames.push($deferred);$deferred.push([(function(){var f;f=Q($recover());if(!($interfaceIsEqual(f,$ifaceNil))){e=f;}}),[]]);if(!($internalize(a.event,$String)==="error")){return[b,c,d,e];}b=$internalize(a.error_type,$String);f=a.error_reason;if(!(f===undefined)){c=$internalize(f,$String);}g=b;if(g==="session_not_found"){d=true;if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}else if(g==="connection_superseded"||g==="message_has_too_many_parts"||g==="message_part_too_long"||g==="message_too_long"||g==="request_malformed"){if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}return[b,c,d,e];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d,e];}};L.Ptr.prototype.Success=function(){var a;a=this;a.lastSlot=0;};L.prototype.Success=function(){return this.$val.Success();};L.Ptr.prototype.Failure=function(a){var b=new AS(0,0),c;c=this;if(c.lastSlot>0){b=new AS(0,N($flatten64(a)*c.lastSlot/1024,-0.5));}if(c.lastSlot<1023){c.lastSlot=((((c.lastSlot+1>>0))<<1>>0))-1>>0;}return b;};L.prototype.Failure=function(a){return this.$val.Failure(a);};M=$pkg.Call=function(a,b,c){var d=$ifaceNil,e,f,g;e="https://"+E(c)+"/v2/call";f=AM();g=f[0];d=new($mapType($String,$emptyInterface))(f[1]);$go((function($b){var $this=this,$args=arguments,$r,$s=0,h,i,j,k,l,m,n,o,p,q;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:h=BH(e,a,O(new AS(0,11000),0.1));i=h[0];j=h[1];if(!($interfaceIsEqual(j,$ifaceNil))){AE("NinchatClient.call onLog callback",b,new($sliceType($emptyInterface))([new $String("call:"),j]));g.Reject(new($sliceType($emptyInterface))([]));return;}l=$recv(i,true);$s=1;case 1:if(l&&l.$blocking){l=l();}k=l;m=k[0];n=k[1];if(m===""){if(n){AE("NinchatClient.call onLog callback",b,new($sliceType($emptyInterface))([new $String("call error")]));}else{AE("NinchatClient.call onLog callback",b,new($sliceType($emptyInterface))([new $String("call timeout")]));}g.Reject(new($sliceType($emptyInterface))([]));return;}o=Z(m);p=o[0];j=o[1];if(!($interfaceIsEqual(j,$ifaceNil))){AE("NinchatClient.call onLog callback",b,new($sliceType($emptyInterface))([new $String("call response:"),j]));g.Reject(new($sliceType($emptyInterface))([]));return;}q=U();q.push(p);g.Resolve(new($sliceType($emptyInterface))([q]));case-1:}return;}};$f.$blocking=true;return $f;}),[]);return d;};N=$pkg.Jitter=function(a,b){return a+a*b*AB();};O=$pkg.JitterDuration=function(a,b){return new AS(0,N($flatten64(a),b));};P=$pkg.JitterUint64=function(a,b){return new $Uint64(0,N($flatten64(a),b));};Q=function(a){var b=$ifaceNil,c,d,e,f;if($interfaceIsEqual(a,$ifaceNil)){return b;}c=$assertType(a,($ptrType(B.Error)),true);d=c[0];e=c[1];if(e){f=$internalize(d.Object.message,$String);if(f===""){f="error";}b=A.New(f);return b;}b=$assertType(a,$error);return b;};R=function(a,b,c){var d=false,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){var e;e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){console.log(a+" invocation error: "+e.Error());}}),[]]);b.apply(undefined,$externalize(c,($sliceType($emptyInterface))));d=true;return d;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return d;}};S=$pkg.Atob=function(a){var b=$ifaceNil,c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=$global.atob(a);return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};T=$pkg.ParseDataURI=function(a){var b=$ifaceNil,c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=a.split($externalize(",",$String))[1];return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};U=$pkg.NewArray=function(){return new($global.Array)();};V=$pkg.NewArrayBuffer=function(a){return new($global.ArrayBuffer)(a);};W=$pkg.NewUint8Array=function(a){return new($global.Uint8Array)(a);};X=$pkg.NewObject=function(){return new($global.Object)();};Z=$pkg.ParseJSON=function(a){var b=$ifaceNil,c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=$global.JSON.parse($externalize(a,$String));return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};AA=$pkg.StringifyJSON=function(a){var b="",c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=$internalize($global.JSON.stringify($externalize(a,$emptyInterface)),$String);return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};AB=$pkg.Random=function(){return $parseFloat($global.Math.random());};AC=$pkg.SetTimeout=function(a,b){var c=$ifaceNil;c=$global.setTimeout($externalize(a,($funcType([],[],false))),$externalize(b,AS));return c;};AD=$pkg.ClearTimeout=function(a){$global.clearTimeout(a);};AE=$pkg.Log=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(b===$ifaceNil||(b===undefined)||(b===null)){return;}d="";e=c;f=0;while(f<e.$length){g=((f<0||f>=e.$length)?$throwRuntimeError("index out of range"):e.$array[e.$offset+f]);h="?";i=$assertType(g,$String,true);j=i[0];k=i[1];if(k){h=j;}else{l=$assertType(g,$error,true);m=l[0];n=l[1];if(n){h=m.Error();}}if(d.length>0){d=d+(" ");}d=d+(h);f++;}while(d.length>0&&(d.charCodeAt((d.length-1>>0))===32)){d=d.substring(0,(d.length-1>>0));}R(a,b,new($sliceType($emptyInterface))([new $String(d)]));};AF=$pkg.LongPollTransport=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);s:while(true){switch($s){case 0:$deferred.push([(function(){var e;e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll:"),e]));}}),[true]]);e="https://"+b+"/v2/poll";if(a.sessionId===$ifaceNil){}else{$s=1;continue;}a.log(new($sliceType($emptyInterface))([new $String("session creation")]));f=a.makeCreateSessionAction();g=BH(e,f,O(new AS(0,13000),0.2));h=g[0];i=g[1];if(!($interfaceIsEqual(i,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));return[c,d];}k=$select([[h],[a.closeNotify]],true);$s=3;case 3:if(k&&k.$blocking){k=k();}j=k;if(j[0]===0){l=j[1];m=l[0];n=l[1];if(!n){a.log(new($sliceType($emptyInterface))([new $String("session creation timeout")]));return[c,d];}else if(m===""){a.log(new($sliceType($emptyInterface))([new $String("session creation error")]));return[c,d];}o=Z(m);p=o[0];q=o[1];if(!($interfaceIsEqual(q,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session creation response:"),q]));return[c,d];}r=p[0];if(!a.handleSessionEvent(r)){return[c,d];}}else if(j[0]===1){AI(a,e);return[c,d];}c=true;d=true;a.connState("connected");a.connActive();$s=2;continue;case 1:a.log(new($sliceType($emptyInterface))([new $String("session resumption")]));s=AH(a,e);if(!($interfaceIsEqual(s,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session resumption:"),s]));return[c,d];}case 2:$r=AG(a,e,new($ptrType($Bool))(function(){return c;},function($v){c=$v;}),new($ptrType($Bool))(function(){return d;},function($v){d=$v;}),true);$s=4;case 4:if($r&&$r.$blocking){$r=$r();}return[c,d];case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[c,d];}};$f.$blocking=true;return $f;};AG=function(a,b,c,d,$b){var $this=this,$args=arguments,$r,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:e=($chanType($String,false,true)).nil;f=($chanType($String,false,true)).nil;g=new $Uint64(0,0);h=0;a.numSent=0;case 1:if(!(h<2)){$s=2;continue;}if(e===($chanType($String,false,true)).nil){i=$ifaceNil;j=a.makeResumeSessionAction(true);k=BH(b,j,O(new AS(0,64000),0.2));e=k[0];i=k[1];if(!($interfaceIsEqual(i,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll:"),i]));return;}}if(f===($chanType($String,false,true)).nil&&a.numSent<a.sendBuffer.$length){n=(l=a.sendBuffer,m=a.numSent,((m<0||m>=l.$length)?$throwRuntimeError("index out of range"):l.$array[l.$offset+m]));if(!(n.Payload===$ifaceNil)){o=$ifaceNil;p=$ifaceNil;q=n.Payload[0];if($internalize(n.Header.action,$String)==="update_user"){r=T(q);s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),t]));return;}o=U();o.push(s);}else{u=Z($internalize(q,$String));o=u[0];p=u[1];if(!($interfaceIsEqual(p,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),p]));return;}}n.Header.payload=o;}n.Header.session_id=a.sessionId;v=AA(n.Header);w=v[0];x=v[1];delete n.Header[$externalize("session_id",$String)];delete n.Header[$externalize("payload",$String)];if(!($interfaceIsEqual(x,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),x]));return;}y=BG(b,w,O(new AS(0,7000),0.2));z=y[0];x=y[1];if(!($interfaceIsEqual(x,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),x]));return;}if((aa=n.Id,(aa.$high===0&&aa.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{f=z;g=n.Id;}}ab="";ac=false;ae=$select([[e],[f],[a.sendNotify],[a.closeNotify]],true);$s=3;case 3:if(ae&&ae.$blocking){ae=ae();}ad=ae;if(ad[0]===0){af=ad[1];ab=af[0];ac=af[1];if(!ac){a.log(new($sliceType($emptyInterface))([new $String("poll timeout")]));}else if(ab===""){a.log(new($sliceType($emptyInterface))([new $String("poll error")]));}e=($chanType($String,false,true)).nil;a.connActive();}else if(ad[0]===1){ag=ad[1];ab=ag[0];ac=ag[1];if(!ac){a.log(new($sliceType($emptyInterface))([new $String("send timeout")]));}else if(ab===""){a.log(new($sliceType($emptyInterface))([new $String("send error")]));}else if((g.$high>0||(g.$high===0&&g.$low>0))){a.numSent=a.numSent+(1)>>0;}f=($chanType($String,false,true)).nil;g=new $Uint64(0,0);}else if(ad[0]===2){ah=ad[1][0];if(!ah){AI(a,b);return;}$s=1;continue;}else if(ad[0]===3){AI(a,b);return;}ai=$ifaceNil;if(!(ab==="")){aj=$ifaceNil;ak=Z(ab);ai=ak[0];aj=ak[1];if(!($interfaceIsEqual(aj,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("response:"),aj]));}}if(ai===$ifaceNil){h=h+(1)>>0;a.numSent=0;$s=1;continue;}h=0;c.$set(true);al=0;while(al<$parseInt(ai.length)){am=ai[al];an=U();ao=am.payload;if(!(ao===undefined)){ap=AA(ao);aq=ap[0];ar=ap[1];if(!($interfaceIsEqual(ar,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll payload:"),ar]));return;}an.push($externalize(aq,$String));}as=a.handleEvent(am,an);at=as[0];au=as[1];av=as[3];if((g.$high>0||(g.$high===0&&g.$low>0))&&(g.$high<at.$high||(g.$high===at.$high&&g.$low<=at.$low))){g=new $Uint64(0,0);a.numSent=a.numSent+(1)>>0;}if(!av){if(au){d.$set(true);}return;}if(!d.$get()){d.$set(true);a.connState("connected");}al=al+(1)>>0;}$s=1;continue;case 2:return;case-1:}return;}};$f.$blocking=true;return $f;};AH=function(a,b){var c=$ifaceNil,d,e,f,g;d=(e=new $Map(),f="action",e[f]={k:f,v:new $String("ping")},f="session_id",e[f]={k:f,v:a.sessionId},e);g=BH(b,new($mapType($String,$emptyInterface))(d),O(new AS(0,7000),0.9));c=g[1];return c;};AI=function(a,b){var c,d,e,f,g;c=(d=new $Map(),e="action",d[e]={k:e,v:new $String("close_session")},e="session_id",d[e]={k:e,v:a.sessionId},d);f=BH(b,new($mapType($String,$emptyInterface))(c),O(new AS(0,7000),0.9));g=f[1];if(!($interfaceIsEqual(g,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),g]));}};AK=function(){AJ.call=$externalize(M,($funcType([B.Object,B.Object,B.Object],[$emptyInterface],false)));AJ.newSession=$externalize(AQ,($funcType([],[($mapType($String,$emptyInterface))],false)));AJ.stringifyFrame=$externalize(AZ,($funcType([B.Object],[$String],false)));$global.NinchatClient=AJ;};AM=$pkg.Defer=function(){var a=($ptrType(AL)).nil,b=false,c,d;a=new AL.Ptr(($sliceType(B.Object)).nil,($sliceType(B.Object)).nil,($sliceType(B.Object)).nil);b=(c=new $Map(),d="then",c[d]={k:d,v:new($funcType([B.Object,B.Object,B.Object],[],false))($methodVal(a,"then"))},c);return[a,b];};AL.Ptr.prototype.then=function(a,b,c){var d;d=this;if(!(a===undefined)&&!(a===null)){d.resolve=$append(d.resolve,a);}if(!(b===undefined)&&!(b===null)){d.reject=$append(d.reject,b);}if(!(c===undefined)&&!(c===null)){d.notify=$append(d.notify,c);}};AL.prototype.then=function(a,b,c){return this.$val.then(a,b,c);};AL.Ptr.prototype.Resolve=function(a){var b,c,d,e;b=this;c=b.resolve;d=0;while(d<c.$length){e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);R("NinchatClient promise resolve callback",e,a);d++;}};AL.prototype.Resolve=function(a){return this.$val.Resolve(a);};AL.Ptr.prototype.Reject=function(a){var b,c,d,e;b=this;c=b.reject;d=0;while(d<c.$length){e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);R("NinchatClient promise reject callback",e,a);d++;}};AL.prototype.Reject=function(a){return this.$val.Reject(a);};AL.Ptr.prototype.Notify=function(a){var b,c,d,e;b=this;c=b.notify;d=0;while(d<c.$length){e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);R("NinchatClient promise notify callback",e,a);d++;}};AL.prototype.Notify=function(a){return this.$val.Notify(a);};AQ=$pkg.NewSession=function(){var a,b,c;a=new AP.Ptr($ifaceNil,$ifaceNil,$ifaceNil,$ifaceNil,$ifaceNil,"api.ninchat.com",false,$ifaceNil,$ifaceNil,"",new AR(0,0),new $Uint64(0,0),($chanType($Bool,false,false)).nil,($sliceType(($ptrType(D)))).nil,0,false,new $Uint64(0,0),new $Uint64(0,0),($chanType($Bool,false,false)).nil,false,true);return(b=new $Map(),c="onSessionEvent",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnSessionEvent"))},c="onEvent",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnEvent"))},c="onConnState",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnConnState"))},c="onConnActive",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnConnActive"))},c="onLog",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnLog"))},c="setParams",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetParams"))},c="setTransport",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetTransport"))},c="setAddress",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetAddress"))},c="open",b[c]={k:c,v:new($funcType([],[],false))($methodVal(a,"Open"))},c="close",b[c]={k:c,v:new($funcType([],[],false))($methodVal(a,"Close"))},c="send",b[c]={k:c,v:new($funcType([B.Object,B.Object],[$emptyInterface],false))($methodVal(a,"Send"))},b);};AP.Ptr.prototype.OnSessionEvent=function(a){var b;b=this;b.onSessionEvent=a;};AP.prototype.OnSessionEvent=function(a){return this.$val.OnSessionEvent(a);};AP.Ptr.prototype.OnEvent=function(a){var b;b=this;b.onEvent=a;};AP.prototype.OnEvent=function(a){return this.$val.OnEvent(a);};AP.Ptr.prototype.OnConnState=function(a){var b;b=this;if(a===null){a=$ifaceNil;}b.onConnState=a;if(!(b.onConnState===$ifaceNil)&&!(b.latestConnState==="")){R("NinchatClient.Session onConnState callback",b.onConnState,new($sliceType($emptyInterface))([new $String(b.latestConnState)]));}};AP.prototype.OnConnState=function(a){return this.$val.OnConnState(a);};AP.Ptr.prototype.OnConnActive=function(a){var b,c;b=this;if(a===null){a=$ifaceNil;}b.onConnActive=a;if(!(b.onConnActive===$ifaceNil)&&(c=b.latestConnActive,(c.$high>0||(c.$high===0&&c.$low>0)))){R("NinchatClient.Session onConnActive callback",b.onConnActive,new($sliceType($emptyInterface))([b.latestConnActive]));}};AP.prototype.OnConnActive=function(a){return this.$val.OnConnActive(a);};AP.Ptr.prototype.OnLog=function(a){var b;b=this;if(a===null){a=$ifaceNil;}b.onLog=a;};AP.prototype.OnLog=function(a){return this.$val.OnLog(a);};AP.Ptr.prototype.SetParams=function(a){var b,c;b=this;if(a.message_types===undefined){$panic(new $String("message_types parameter not defined"));}c=a.session_id;if(!(c===undefined)&&!(c===null)){b.sessionId=c;}delete a[$externalize("session_id",$String)];b.sessionParams=a;if(!(b.sendNotify===($chanType($Bool,false,false)).nil)&&b.stopped){$go($methodVal(b,"discover"),[]);}};AP.prototype.SetParams=function(a){return this.$val.SetParams(a);};AP.Ptr.prototype.SetTransport=function(a){var b,c,d;b=this;if(a===null){b.forceLongPoll=false;return;}c=$internalize(a,$String);d=c;if(d==="websocket"){$panic(new $String("websocket transport cannot be forced"));}else if(d==="longpoll"){b.forceLongPoll=true;}else{$panic(new $String("unknown transport: "+c));}};AP.prototype.SetTransport=function(a){return this.$val.SetTransport(a);};AP.Ptr.prototype.SetAddress=function(a){var b;b=this;b.address=E(a);};AP.prototype.SetAddress=function(a){return this.$val.SetAddress(a);};AP.Ptr.prototype.Open=function(){var a;a=this;if(a.closed){$panic(new $String("session already closed"));}if(!(a.sendNotify===($chanType($Bool,false,false)).nil)){$panic(new $String("session already initialized"));}if(a.onSessionEvent===$ifaceNil){$panic(new $String("onSessionEvent callback not defined"));}if(a.onEvent===$ifaceNil){$panic(new $String("onEvent callback not defined"));}if(a.sessionParams===$ifaceNil){$panic(new $String("session parameters not defined"));}a.sendNotify=new($chanType($Bool,false,false))(1);a.closeNotify=new($chanType($Bool,false,false))(1);a.stopped=false;$go($methodVal(a,"discover"),[]);};AP.prototype.Open=function(){return this.$val.Open();};AP.Ptr.prototype.Close=function(){var a,b,c,d;a=this;if(a.closed){return;}b=a.sendBuffer;c=0;while(c<b.$length){d=((c<0||c>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+c]);if(!(d.Deferred===($ptrType(AL)).nil)){d.Deferred.Reject(new($sliceType($emptyInterface))([]));}c++;}a.sendBuffer=($sliceType(($ptrType(D)))).nil;a.numSent=0;a.closed=true;a.stopped=true;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(a.closeNotify,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}$close(a.sendNotify);case-1:}return;}};$f.$blocking=true;return $f;}),[]);};AP.prototype.Close=function(){return this.$val.Close();};AP.Ptr.prototype.Send=function(a,b){var c=$ifaceNil,d,e,f,g,h;d=this;if(d.sendNotify===($chanType($Bool,false,false)).nil){$panic(new $String("session not initialized"));}if(d.closed){$panic(new $String("session already closed"));}if((b===undefined)||(b===null)||($parseInt(b.length)===0)){b=$ifaceNil;}e=new D.Ptr(new $Uint64(0,0),a,b,($ptrType(AL)).nil,"");if(a.action_id===null){delete a[$externalize("action_id",$String)];}else{d.lastActionId=(f=d.lastActionId,g=new $Uint64(0,1),new $Uint64(f.$high+g.$high,f.$low+g.$low));e.Id=d.lastActionId;a.action_id=$externalize(e.Id,$Uint64);h=AM();e.Deferred=h[0];c=new($mapType($String,$emptyInterface))(h[1]);}d.send(e);return c;};AP.prototype.Send=function(a,b){return this.$val.Send(a,b);};AP.Ptr.prototype.send=function(a){var b;b=this;b.sendBuffer=$append(b.sendBuffer,a);$go((function(){var c;c=$select([[b.sendNotify,true],[]]);}),[]);return;};AP.prototype.send=function(a){return this.$val.send(a);};AP.Ptr.prototype.sendAck=function(){var a;a=this;a.sendEventAck=true;$go((function(){var b;b=$select([[a.sendNotify,true],[]]);}),[]);};AP.prototype.sendAck=function(){return this.$val.sendAck();};AP.Ptr.prototype.discover=function($b){var $this=this,$args=arguments,$r,$deferred=[],$err=null,$s=0,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);s:while(true){switch($s){case 0:a=$this;a.log(new($sliceType($emptyInterface))([new $String("opening")]));$deferred.push([$methodVal(a,"log"),[new($sliceType($emptyInterface))([new $String("closed")]),true]]);$deferred.push([$methodVal(a,"connState"),["disconnected",true]]);b=new L.Ptr();$copy(b,new L.Ptr(),L);case 1:if(!(!a.stopped)){$s=2;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery")]));a.connState("connecting");c="https://"+a.address+"/v2/endpoint";d=BG(c,"",O(new AS(0,7000),0.1));e=d[0];f=d[1];if(!($interfaceIsEqual(f,$ifaceNil))){}else{$s=3;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery:"),f]));$s=4;continue;case 3:h=$select([[e],[a.closeNotify]],true);$s=5;case 5:if(h&&h.$blocking){h=h();}g=h;if(g[0]===0){}else if(g[0]===1){$s=6;continue;}else{$s=7;continue;}i=g[1];j=i[0];k=i[1];if(!k){}else if(j===""){$s=8;continue;}else{$s=9;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery timeout")]));$s=10;continue;case 8:a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery error")]));$s=10;continue;case 9:l=F(j);m=l[0];n=l[1];if(!($interfaceIsEqual(n,$ifaceNil))){}else{$s=11;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery:"),n]));$s=12;continue;case 11:a.log(new($sliceType($emptyInterface))([new $String("endpoint discovered")]));if($pkg.WebSocketSupported&&!a.forceLongPoll){}else{$s=13;continue;}o=a.connect(BA,m,b,true);$s=14;case 14:if(o&&o.$blocking){o=o();}if(o){}else{$s=15;continue;}$s=1;continue;case 15:case 13:p=a.connect(AF,m,b,true);$s=16;case 16:if(p&&p.$blocking){p=p();}p;case 12:case 10:$s=7;continue;case 6:return;case 7:case 4:q=b.Failure(new AS(0,60000));if((q.$high>0||(q.$high===0&&q.$low>0))){}else{$s=17;continue;}a.log(new($sliceType($emptyInterface))([new $String("sleeping")]));a.connState("disconnected");$r=AW(q,true);$s=18;case 18:if($r&&$r.$blocking){$r=$r();}case 17:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);}};$f.$blocking=true;return $f;};AP.prototype.discover=function($b){return this.$val.discover($b);};AP.Ptr.prototype.connect=function(a,b,c,$b){var $this=this,$args=arguments,d=false,$r,$s=0,e,f,g,h,i,j,k,l,m,n;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:e=$this;f=0;case 1:if(!(f<2)){$s=2;continue;}g=b;h=0;case 3:if(!(h<g.$length)){$s=4;continue;}i=((h<0||h>=g.$length)?$throwRuntimeError("index out of range"):g.$array[g.$offset+h]);e.connState("connecting");k=a(e,i,true);$s=5;case 5:if(k&&k.$blocking){k=k();}j=k;l=j[0];m=j[1];if(l){d=true;}if(m){c.Success();return d;}if(e.stopped){return d;}n=c.Failure(new AS(0,60000));if((n.$high>0||(n.$high===0&&n.$low>0))){}else{$s=6;continue;}e.log(new($sliceType($emptyInterface))([new $String("sleeping")]));e.connState("disconnected");$r=AW(n,true);$s=7;case 7:if($r&&$r.$blocking){$r=$r();}case 6:h++;$s=3;continue;case 4:f=f+(1)>>0;$s=1;continue;case 2:return d;case-1:}return;}};$f.$blocking=true;return $f;};AP.prototype.connect=function(a,b,c,$b){return this.$val.connect(a,b,c,$b);};AP.Ptr.prototype.canLogin=function(){var a,b,c,d,e,f,g,h,i,j,k;a=this;b=a.sessionParams.access_key;if(!(b===undefined)&&!(b===null)){return true;}c=a.sessionParams.user_id;if(!(c===undefined)&&!(c===null)){d=new($sliceType($String))(["user_auth","master_sign"]);e=0;while(e<d.$length){f=((e<0||e>=d.$length)?$throwRuntimeError("index out of range"):d.$array[d.$offset+e]);g=a.sessionParams[$externalize(f,$String)];if(!(g===undefined)&&!(g===null)){return true;}e++;}return false;}h=new($sliceType($String))(["identity_type","identity_name","identity_auth"]);i=0;while(i<h.$length){j=((i<0||i>=h.$length)?$throwRuntimeError("index out of range"):h.$array[h.$offset+i]);k=a.sessionParams[$externalize(j,$String)];if((k===undefined)||(k===null)){return false;}i++;}return true;};AP.prototype.canLogin=function(){return this.$val.canLogin();};AP.Ptr.prototype.makeCreateSessionAction=function(){var a=$ifaceNil,b;b=this;a=b.sessionParams;a.action=$externalize("create_session",$String);return a;};AP.prototype.makeCreateSessionAction=function(){return this.$val.makeCreateSessionAction();};AP.Ptr.prototype.makeResumeSessionAction=function(a){var b=$ifaceNil,c;c=this;b=X();b.action=$externalize("resume_session",$String);b.event_id=$externalize(c.receivedEventId,$Uint64);if(a){b.session_id=c.sessionId;}c.sendEventAck=false;c.ackedEventId=c.receivedEventId;return b;};AP.prototype.makeResumeSessionAction=function(a){return this.$val.makeResumeSessionAction(a);};AP.Ptr.prototype.handleSessionEvent=function(a){var b=false,c,d,e,f,g,h,i,j,k,l,m;c=this;d=G(a);e=d[0];f=d[1];g=d[2];h=d[3];b=d[4];i=d[5];if(!($interfaceIsEqual(i,$ifaceNil))){c.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));}if(!R("NinchatClient.Session onSessionEvent callback",c.onSessionEvent,new($sliceType($emptyInterface))([a]))){b=false;}if(!b){c.sessionId=$ifaceNil;c.stopped=true;return b;}c.sessionParams.user_id=e;if(!(f===$ifaceNil)){c.sessionParams.user_auth=f;}j=new($sliceType($String))(["identity_type","identity_name","identity_auth"]);k=0;while(k<j.$length){l=((k<0||k>=j.$length)?$throwRuntimeError("index out of range"):j.$array[j.$offset+k]);m=c.sessionParams[$externalize(l+"_new",$String)];if(!(m===undefined)){c.sessionParams[$externalize(l,$String)]=m;}k++;}delete c.sessionParams[$externalize("access_key",$String)];delete c.sessionParams[$externalize("master_sign",$String)];c.sessionId=g;if(c.sendBuffer.$length===0){c.lastActionId=new $Uint64(0,0);}c.sendEventAck=false;c.receivedEventId=h;c.ackedEventId=new $Uint64(0,0);c.log(new($sliceType($emptyInterface))([new $String("session created")]));b=true;return b;};AP.prototype.handleSessionEvent=function(a){return this.$val.handleSessionEvent(a);};AP.Ptr.prototype.handleEvent=function(a,b){var c=new $Uint64(0,0),d=false,e=false,f=false,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;g=this;h=I(a);i=h[0];c=h[1];j=h[2];if(!($interfaceIsEqual(j,$ifaceNil))){g.log(new($sliceType($emptyInterface))([new $String("event:"),j]));return[c,d,e,f];}if((i.$high>0||(i.$high===0&&i.$low>0))){g.receivedEventId=i;if(!g.sendEventAck){if((k=(l=g.receivedEventId,m=g.ackedEventId,new $Uint64(l.$high-m.$high,l.$low-m.$low)),(k.$high>AN.$high||(k.$high===AN.$high&&k.$low>=AN.$low)))){g.sendAck();}else{e=true;}}}if((c.$high>0||(c.$high===0&&c.$low>0))){n=C.Search(g.numSent,(function(n){var o,p,q;p=(o=g.sendBuffer,((n<0||n>=o.$length)?$throwRuntimeError("index out of range"):o.$array[o.$offset+n]));return(q=p.Id,(q.$high>c.$high||(q.$high===c.$high&&q.$low>=c.$low)));}));if(n<g.numSent){p=(o=g.sendBuffer,((n<0||n>=o.$length)?$throwRuntimeError("index out of range"):o.$array[o.$offset+n]));if((q=p.Id,(q.$high===c.$high&&q.$low===c.$low))){r=J(a,p);s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){g.log(new($sliceType($emptyInterface))([new $String("event:"),t]));return[c,d,e,f];}if(!(p.Deferred===($ptrType(AL)).nil)){if(s){p.Deferred.Resolve(new($sliceType($emptyInterface))([a,b]));}else{p.Deferred.Notify(new($sliceType($emptyInterface))([a,b]));}}if(s){g.sendBuffer=$appendSlice($subslice(g.sendBuffer,0,n),$subslice(g.sendBuffer,(n+1>>0)));g.numSent=g.numSent-(1)>>0;}}}}u=K(a);v=u[0];w=u[1];d=u[2];j=u[3];if(!($interfaceIsEqual(j,$ifaceNil))){g.log(new($sliceType($emptyInterface))([new $String("event:"),j]));if(d){g.sessionId=$ifaceNil;if(!g.canLogin()){R("NinchatClient.Session onSessionEvent callback",g.onSessionEvent,new($sliceType($emptyInterface))([a]));g.stopped=true;}}return[c,d,e,f];}if(v==="deprecated"){g.log(new($sliceType($emptyInterface))([new $String("deprecated:"),new $String(w)]));}if(!R("NinchatClient.Session onEvent callback",g.onEvent,new($sliceType($emptyInterface))([a,b]))){return[c,d,e,f];}f=true;return[c,d,e,f];};AP.prototype.handleEvent=function(a,b){return this.$val.handleEvent(a,b);};AP.Ptr.prototype.connState=function(a){var b;b=this;if(!(b.latestConnState===a)){b.latestConnState=a;if(!(b.onConnState===$ifaceNil)){R("NinchatClient.Session onConnState callback",b.onConnState,new($sliceType($emptyInterface))([new $String(b.latestConnState)]));}}};AP.prototype.connState=function(a){return this.$val.connState(a);};AP.Ptr.prototype.connActive=function(){var a;a=this;a.latestConnActive=AT();if(!(a.onConnActive===$ifaceNil)){R("NinchatClient.Session onConnActive callback",a.onConnActive,new($sliceType($emptyInterface))([a.latestConnActive]));}};AP.prototype.connActive=function(){return this.$val.connActive();};AP.Ptr.prototype.log=function(a){var b;b=this;AE("NinchatClient.Session onLog callback",b.onLog,a);};AP.prototype.log=function(a){return this.$val.log(a);};AT=$pkg.Now=function(){var a;return(a=$internalize(new($global.Date)().getTime(),$Int64),new AR(a.$high,a.$low));};AV=$pkg.NewTimer=function(a){var b=($ptrType(AU)).nil;b=new AU.Ptr(new($chanType($Bool,false,false))(0),$ifaceNil);if((a.$high>0||(a.$high===0&&a.$low>=0))){b.Reset(a);}return b;};AU.Ptr.prototype.Active=function(){var a;a=this;return!(a.id===$ifaceNil);};AU.prototype.Active=function(){return this.$val.Active();};AU.Ptr.prototype.Reset=function(a){var b;b=this;b.Stop();b.id=AC((function(){b.id=$ifaceNil;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(b.C,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),a);};AU.prototype.Reset=function(a){return this.$val.Reset(a);};AU.Ptr.prototype.Stop=function(){var a;a=this;if(!(a.id===$ifaceNil)){AD(a.id);a.id=$ifaceNil;}};AU.prototype.Stop=function(){return this.$val.Stop();};AW=$pkg.Sleep=function(a,$b){var $this=this,$args=arguments,$r,$s=0,b;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:b=$recv(AV(a).C,true);$s=1;case 1:if(b&&b.$blocking){b=b();}b[0];case-1:}return;}};$f.$blocking=true;return $f;};AY=$pkg.NewWebSocket=function(a){var b=($ptrType(AX)).nil;b=new AX.Ptr(new($chanType($Bool,false,false))(1),new($global.WebSocket)($externalize(a,$String)),false,$ifaceNil,($sliceType(B.Object)).nil);b.impl.binaryType=$externalize("arraybuffer",$String);b.impl.onopen=$externalize((function(c){b.open=true;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(b.Notify,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),($funcType([B.Object],[],false)));b.impl.onmessage=$externalize((function(c){b.buffer=$append(b.buffer,c.data);$go((function(){var d;d=$select([[b.Notify,true],[]]);}),[]);}),($funcType([B.Object],[],false)));b.impl.onclose=$externalize((function(c){b.open=false;$go((function(){$close(b.Notify);}),[]);}),($funcType([B.Object],[],false)));b.impl.onerror=$externalize((function(c){b.error=A.New("WebSocket error event");}),($funcType([B.Object],[],false)));return b;};AX.Ptr.prototype.Send=function(a){var b=$ifaceNil,$deferred=[],$err=null,c;try{$deferFrames.push($deferred);c=this;$deferred.push([(function(){b=Q($recover());}),[]]);b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return b;}c.impl.send($externalize(a,$emptyInterface));return b;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return b;}};AX.prototype.Send=function(a){return this.$val.Send(a);};AX.Ptr.prototype.SendJSON=function(a){var b=$ifaceNil,c,d,e;c=this;d=AA(a);e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))){return b;}b=c.Send(new $String(e));return b;};AX.prototype.SendJSON=function(a){return this.$val.SendJSON(a);};AX.Ptr.prototype.Receive=function(){var a=$ifaceNil,b=$ifaceNil,c,d;c=this;b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return[a,b];}if(!c.open){return[a,b];}if(c.buffer.$length>0){a=(d=c.buffer,((0<0||0>=d.$length)?$throwRuntimeError("index out of range"):d.$array[d.$offset+0]));c.buffer=$subslice(c.buffer,1);}return[a,b];};AX.prototype.Receive=function(){return this.$val.Receive();};AX.Ptr.prototype.ReceiveJSON=function(){var a=$ifaceNil,b=$ifaceNil,c,d,e,f;c=this;d=c.Receive();e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))||e===$ifaceNil){return[a,b];}f=Z(AZ(e));a=f[0];b=f[1];return[a,b];};AX.prototype.ReceiveJSON=function(){return this.$val.ReceiveJSON();};AX.Ptr.prototype.Close=function(){var a=$ifaceNil,$deferred=[],$err=null,b;try{$deferFrames.push($deferred);b=this;$deferred.push([(function(){a=Q($recover());}),[]]);b.impl.close();a=b.error;return a;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return a;}};AX.prototype.Close=function(){return this.$val.Close();};AZ=$pkg.StringifyFrame=function(a){var b="",c,d,e,f;c=$assertType($internalize(a,$emptyInterface),$String,true);b=c[0];d=c[1];if(d){return b;}e=W(a);f=$assertType($internalize(e,$emptyInterface),($sliceType($Uint8)));b=$bytesToString(f);return b;};BA=$pkg.WebSocketTransport=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);s:while(true){switch($s){case 0:e=($ptrType(AX)).nil;$deferred.push([(function(){if(!(e===($ptrType(AX)).nil)){e.Close();}}),[true]]);f=AV(new AS(-1,4294967295));$deferred.push([$methodVal(f,"Stop"),[true]]);case 1:if(!(true)){$s=2;continue;}d=false;g=false;a.log(new($sliceType($emptyInterface))([new $String("connecting to"),new $String(b)]));e=AY("wss://"+b+"/v2/socket");f.Reset(O(new AS(0,9000),0.1));i=$select([[e.Notify],[f.C],[a.closeNotify]],true);$s=3;case 3:if(i&&i.$blocking){i=i();}h=i;if(h[0]===0){}else if(h[0]===1){$s=4;continue;}else if(h[0]===2){$s=5;continue;}else{$s=6;continue;}j=h[1][0];f.Stop();if(j){}else{$s=7;continue;}a.log(new($sliceType($emptyInterface))([new $String("connected")]));a.connState("connected");c=true;l=BB(a,e,true);$s=9;case 9:if(l&&l.$blocking){l=l();}k=l;d=k[0];g=k[1];$s=8;continue;case 7:a.log(new($sliceType($emptyInterface))([new $String("connection failed")]));case 8:$s=6;continue;case 4:a.log(new($sliceType($emptyInterface))([new $String("connection timeout")]));$s=6;continue;case 5:f.Stop();case 6:e.Close();e=($ptrType(AX)).nil;a.log(new($sliceType($emptyInterface))([new $String("disconnected")]));if(!d||!g||a.stopped){return[c,d];}$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[c,d];}};$f.$blocking=true;return $f;};BB=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:e=$ifaceNil;if(a.sessionId===$ifaceNil){a.log(new($sliceType($emptyInterface))([new $String("session creation")]));e=a.makeCreateSessionAction();}else{a.log(new($sliceType($emptyInterface))([new $String("session resumption")]));e=a.makeResumeSessionAction(true);}f=b.SendJSON(e);if(!($interfaceIsEqual(f,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),f]));}if(a.sessionId===$ifaceNil){}else{$s=1;continue;}g=$ifaceNil;h=AV(O(new AS(0,13000),0.2));case 2:if(!(true)){$s=3;continue;}i=$ifaceNil;j=b.ReceiveJSON();g=j[0];i=j[1];if(!($interfaceIsEqual(i,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));return[c,d];}if(!(g===$ifaceNil)){h.Stop();$s=3;continue;}l=$select([[b.Notify],[h.C]],true);$s=4;case 4:if(l&&l.$blocking){l=l();}k=l;if(k[0]===0){m=k[1][0];if(!m){a.log(new($sliceType($emptyInterface))([new $String("disconnected during session creation")]));h.Stop();return[c,d];}}else if(k[0]===1){a.log(new($sliceType($emptyInterface))([new $String("session creation timeout")]));return[c,d];}$s=2;continue;case 3:if(!a.handleSessionEvent(g)){return[c,d];}c=true;d=true;a.connActive();case 1:n=new($chanType($Bool,false,false))(1);o=new($chanType($Bool,false,false))(0);$go(BC,[a,b,n,o]);q=BD(a,b,n,true);$s=5;case 5:if(q&&q.$blocking){q=q();}p=q;r=p[0];d=p[1];if(r){c=true;}s=$recv(o,true);$s=6;case 6:if(s&&s.$blocking){s=s();}s[0];return[c,d];case-1:}return;}};$f.$blocking=true;return $f;};BC=function(a,b,c,d,$b){var $this=this,$args=arguments,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);s:while(true){switch($s){case 0:$deferred.push([(function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(d,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[true]]);e=AV(O(new AS(0,56000),-0.3));$deferred.push([$methodVal(e,"Stop"),[true]]);a.numSent=0;case 1:if(!(true)){$s=2;continue;}case 3:if(!(a.numSent<a.sendBuffer.$length)){$s=4;continue;}h=(f=a.sendBuffer,g=a.numSent,((g<0||g>=f.$length)?$throwRuntimeError("index out of range"):f.$array[f.$offset+g]));if(!(h.Payload===$ifaceNil)){h.Header.frames=$parseInt(h.Payload.length);}if(!((i=a.receivedEventId,j=a.ackedEventId,(i.$high===j.$high&&i.$low===j.$low)))){h.Header.event_id=$externalize(a.receivedEventId,$Uint64);a.sendEventAck=false;a.ackedEventId=a.receivedEventId;}k=b.SendJSON(h.Header);delete h.Header[$externalize("frames",$String)];delete h.Header[$externalize("event_id",$String)];if(!($interfaceIsEqual(k,$ifaceNil))){}else{$s=5;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),k]));$r=$send(c,true,true);$s=6;case 6:if($r&&$r.$blocking){$r=$r();}return;case 5:if(!(h.Payload===$ifaceNil)){}else{$s=7;continue;}l=0;case 8:if(!(l<$parseInt(h.Payload.length))){$s=9;continue;}m=h.Payload[l];if($internalize(h.Header.action,$String)==="update_user"){}else{$s=10;continue;}n=$assertType($internalize(m,$emptyInterface),$String,true);o=n[1];if(o){}else{$s=11;continue;}p=T(m);q=p[0];r=p[1];if(!($interfaceIsEqual(r,$ifaceNil))){}else{$s=12;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),r]));$r=$send(c,true,true);$s=13;case 13:if($r&&$r.$blocking){$r=$r();}return;case 12:s=S(q);t=s[0];r=s[1];if(!($interfaceIsEqual(r,$ifaceNil))){}else{$s=14;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),r]));$r=$send(c,true,true);$s=15;case 15:if($r&&$r.$blocking){$r=$r();}return;case 14:u=$parseInt(t.length);v=V(u);w=W(v);x=0;while(x<u){w[x]=t.charCodeAt(x);x=x+(1)>>0;}m=v;case 11:case 10:y=b.Send(m);if(!($interfaceIsEqual(y,$ifaceNil))){}else{$s=16;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),y]));$r=$send(c,true,true);$s=17;case 17:if($r&&$r.$blocking){$r=$r();}return;case 16:l=l+(1)>>0;$s=8;continue;case 9:case 7:if((z=h.Id,(z.$high===0&&z.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{a.numSent=a.numSent+(1)>>0;}e.Reset(O(new AS(0,56000),-0.3));$s=3;continue;case 4:if(a.sendEventAck&&!((aa=a.receivedEventId,ab=a.ackedEventId,(aa.$high===ab.$high&&aa.$low===ab.$low)))){}else{$s=18;continue;}ac=a.makeResumeSessionAction(false);ad=b.SendJSON(ac);if(!($interfaceIsEqual(ad,$ifaceNil))){}else{$s=19;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),ad]));$r=$send(c,true,true);$s=20;case 20:if($r&&$r.$blocking){$r=$r();}return;case 19:case 18:af=$select([[a.sendNotify],[e.C],[c]],true);$s=21;case 21:if(af&&af.$blocking){af=af();}ae=af;if(ae[0]===0){}else if(ae[0]===1){$s=22;continue;}else if(ae[0]===2){$s=23;continue;}else{$s=24;continue;}ag=ae[1][0];if(!ag){ah=(ai=new $Map(),aj="action",ai[aj]={k:aj,v:new $String("close_session")},ai);ak=b.SendJSON(new($mapType($String,$emptyInterface))(ah));if(!($interfaceIsEqual(ak,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),ak]));}return;}$s=24;continue;case 22:al=b.Send(new($sliceType($Uint8))([]));if(!($interfaceIsEqual(al,$ifaceNil))){}else{$s=25;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),al]));$r=$send(c,true,true);$s=26;case 26:if($r&&$r.$blocking){$r=$r();}return;case 25:e.Reset(O(new AS(0,56000),-0.3));$s=24;continue;case 23:return;case 24:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);}};$f.$blocking=true;return $f;};BD=function(a,b,c,$b){var $this=this,$args=arguments,d=false,e=false,$r,$deferred=[],$err=null,$s=0,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ab,ac,ad;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);s:while(true){switch($s){case 0:f=$ifaceNil;g=$ifaceNil;h=0;i=AV(O(new AS(0,64000),0.3));$deferred.push([$methodVal(i,"Stop"),[true]]);j=AV(new AS(-1,4294967295));$deferred.push([$methodVal(j,"Stop"),[true]]);case 1:if(!(true)){$s=2;continue;}k=false;case 3:if(!(true)){$s=4;continue;}if(f===$ifaceNil){}else{$s=5;continue;}l=$ifaceNil;m=b.Receive();n=m[0];l=m[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=7;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=8;case 8:if($r&&$r.$blocking){$r=$r();}return[d,e];case 7:if(n===$ifaceNil){$s=4;continue;}i.Reset(O(new AS(0,64000),0.7));a.connActive();o=AZ(n);if(o.length===0){$s=3;continue;}p=Z(o);f=p[0];l=p[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=9;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=10;case 10:if($r&&$r.$blocking){$r=$r();}return[d,e];case 9:g=U();q=H(f);h=q[0];l=q[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=11;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=12;case 12:if($r&&$r.$blocking){$r=$r();}return[d,e];case 11:$s=6;continue;case 5:r=b.Receive();s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){}else{$s=13;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),t]));e=false;$r=$send(c,true,true);$s=14;case 14:if($r&&$r.$blocking){$r=$r();}return[d,e];case 13:if(s===$ifaceNil){$s=4;continue;}g.push(s);h=h-(1)>>0;case 6:if(h===0){}else{$s=15;continue;}u=a.handleEvent(f,g);v=u[1];w=u[2];x=u[3];if(!x){}else{$s=16;continue;}if(v){d=true;}else{e=false;}$r=$send(c,true,true);$s=17;case 17:if($r&&$r.$blocking){$r=$r();}return[d,e];case 16:if(w){k=true;}f=$ifaceNil;g=$ifaceNil;h=0;d=true;e=true;case 15:y=$select([[a.closeNotify],[c],[]]);if(y[0]===0){return[d,e];}else if(y[0]===1){return[d,e];}$s=3;continue;case 4:if(k&&!j.Active()){j.Reset(O(new AS(0,7000),-0.3));}aa=$select([[b.Notify],[i.C],[j.C],[a.closeNotify],[c]],true);$s=18;case 18:if(aa&&aa.$blocking){aa=aa();}z=aa;if(z[0]===0){}else if(z[0]===1){$s=19;continue;}else if(z[0]===2){$s=20;continue;}else if(z[0]===3){$s=21;continue;}else if(z[0]===4){$s=22;continue;}else{$s=23;continue;}ab=z[1][0];if(!ab){}else{$s=24;continue;}$r=$send(c,true,true);$s=25;case 25:if($r&&$r.$blocking){$r=$r();}return[d,e];case 24:$s=23;continue;case 19:a.log(new($sliceType($emptyInterface))([new $String("receive timeout")]));$r=$send(c,true,true);$s=26;case 26:if($r&&$r.$blocking){$r=$r();}return[d,e];$s=23;continue;case 20:if(!a.sendEventAck&&!((ac=a.ackedEventId,ad=a.receivedEventId,(ac.$high===ad.$high&&ac.$low===ad.$low)))){a.sendAck();}$s=23;continue;case 21:return[d,e];$s=23;continue;case 22:return[d,e];case 23:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[d,e];}};$f.$blocking=true;return $f;};BF=function(){BE=$global.XDomainRequest;if(BE===undefined){BE=$global.XMLHttpRequest;}};BG=$pkg.XHR=function(a,b,c){var d=($chanType($String,false,false)).nil,e=$ifaceNil,$deferred=[],$err=null,f,g;try{$deferFrames.push($deferred);$deferred.push([(function(){e=Q($recover());}),[]]);f="";if(b===""){f="GET";}else{f="POST";}d=new($chanType($String,false,false))(1);g=new(BE)();g.timeout=$externalize(c,AS);g.onload=$externalize((function(){var h,i;h="";i=g.responseText;if(!(i===undefined)&&!(i===null)){h=$internalize(i,$String);}$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(d,h,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),($funcType([],[],false)));g.onprogress=$externalize((function(){}),($funcType([],[],false)));g.ontimeout=$externalize((function(){$go((function(){$close(d);}),[]);}),($funcType([],[],false)));g.onerror=$externalize((function(){$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){s:while(true){switch($s){case 0:$r=$send(d,"",true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),($funcType([],[],false)));g.open($externalize(f,$String),$externalize(a,$String));g.send($externalize(b,$String));return[d,e];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[d,e];}};BH=$pkg.XHR_JSON=function(a,b,c){var d=($chanType($String,false,false)).nil,e=$ifaceNil,f,g,h;f=AA(b);g=f[0];e=f[1];if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}h=BG(a,g,c);d=h[0];e=h[1];return[d,e];};$pkg.$init=function(){$pkg.$init=function(){};var $r,$s=0;var $f=function(){while(true){switch($s){case 0:$r=A.$init(true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}$r=B.$init(true);$s=2;case 2:if($r&&$r.$blocking){$r=$r();}$r=C.$init(true);$s=3;case 3:if($r&&$r.$blocking){$r=$r();}($ptrType(D)).methods=[["Name","Name","",$funcType([],[$String],false),-1]];D.init([["Id","Id","",$Uint64,""],["Header","Header","",B.Object,""],["Payload","Payload","",B.Object,""],["Deferred","Deferred","",($ptrType(AL)),""],["name","name","ninchatclient",$String,""]]);($ptrType(L)).methods=[["Failure","Failure","",$funcType([AS],[AS],false),-1],["Success","Success","",$funcType([],[],false),-1]];L.init([["lastSlot","lastSlot","ninchatclient",$Int,""]]);($ptrType(AL)).methods=[["Notify","Notify","",$funcType([($sliceType($emptyInterface))],[],true),-1],["Reject","Reject","",$funcType([($sliceType($emptyInterface))],[],true),-1],["Resolve","Resolve","",$funcType([($sliceType($emptyInterface))],[],true),-1],["then","then","ninchatclient",$funcType([B.Object,B.Object,B.Object],[],false),-1]];AL.init([["resolve","resolve","ninchatclient",($sliceType(B.Object)),""],["reject","reject","ninchatclient",($sliceType(B.Object)),""],["notify","notify","ninchatclient",($sliceType(B.Object)),""]]);AO.init([($ptrType(AP)),$String],[$Bool,$Bool],false);($ptrType(AP)).methods=[["Close","Close","",$funcType([],[],false),-1],["OnConnActive","OnConnActive","",$funcType([B.Object],[],false),-1],["OnConnState","OnConnState","",$funcType([B.Object],[],false),-1],["OnEvent","OnEvent","",$funcType([B.Object],[],false),-1],["OnLog","OnLog","",$funcType([B.Object],[],false),-1],["OnSessionEvent","OnSessionEvent","",$funcType([B.Object],[],false),-1],["Open","Open","",$funcType([],[],false),-1],["Send","Send","",$funcType([B.Object,B.Object],[$emptyInterface],false),-1],["SetAddress","SetAddress","",$funcType([B.Object],[],false),-1],["SetParams","SetParams","",$funcType([B.Object],[],false),-1],["SetTransport","SetTransport","",$funcType([B.Object],[],false),-1],["canLogin","canLogin","ninchatclient",$funcType([],[$Bool],false),-1],["connActive","connActive","ninchatclient",$funcType([],[],false),-1],["connState","connState","ninchatclient",$funcType([$String],[],false),-1],["connect","connect","ninchatclient",$funcType([AO,($sliceType($String)),($ptrType(L))],[$Bool],false),-1],["discover","discover","ninchatclient",$funcType([],[],false),-1],["handleEvent","handleEvent","ninchatclient",$funcType([B.Object,B.Object],[$Uint64,$Bool,$Bool,$Bool],false),-1],["handleSessionEvent","handleSessionEvent","ninchatclient",$funcType([B.Object],[$Bool],false),-1],["log","log","ninchatclient",$funcType([($sliceType($emptyInterface))],[],true),-1],["makeCreateSessionAction","makeCreateSessionAction","ninchatclient",$funcType([],[B.Object],false),-1],["makeResumeSessionAction","makeResumeSessionAction","ninchatclient",$funcType([$Bool],[B.Object],false),-1],["send","send","ninchatclient",$funcType([($ptrType(D))],[],false),-1],["sendAck","sendAck","ninchatclient",$funcType([],[],false),-1]];AP.init([["onSessionEvent","onSessionEvent","ninchatclient",B.Object,""],["onEvent","onEvent","ninchatclient",B.Object,""],["onConnState","onConnState","ninchatclient",B.Object,""],["onConnActive","onConnActive","ninchatclient",B.Object,""],["onLog","onLog","ninchatclient",B.Object,""],["address","address","ninchatclient",$String,""],["forceLongPoll","forceLongPoll","ninchatclient",$Bool,""],["sessionParams","sessionParams","ninchatclient",B.Object,""],["sessionId","sessionId","ninchatclient",B.Object,""],["latestConnState","latestConnState","ninchatclient",$String,""],["latestConnActive","latestConnActive","ninchatclient",AR,""],["lastActionId","lastActionId","ninchatclient",$Uint64,""],["sendNotify","sendNotify","ninchatclient",($chanType($Bool,false,false)),""],["sendBuffer","sendBuffer","ninchatclient",($sliceType(($ptrType(D)))),""],["numSent","numSent","ninchatclient",$Int,""],["sendEventAck","sendEventAck","ninchatclient",$Bool,""],["receivedEventId","receivedEventId","ninchatclient",$Uint64,""],["ackedEventId","ackedEventId","ninchatclient",$Uint64,""],["closeNotify","closeNotify","ninchatclient",($chanType($Bool,false,false)),""],["closed","closed","ninchatclient",$Bool,""],["stopped","stopped","ninchatclient",$Bool,""]]);($ptrType(AU)).methods=[["Active","Active","",$funcType([],[$Bool],false),-1],["Reset","Reset","",$funcType([AS],[],false),-1],["Stop","Stop","",$funcType([],[],false),-1]];AU.init([["C","C","",($chanType($Bool,false,false)),""],["id","id","ninchatclient",B.Object,""]]);($ptrType(AX)).methods=[["Close","Close","",$funcType([],[$error],false),-1],["Receive","Receive","",$funcType([],[B.Object,$error],false),-1],["ReceiveJSON","ReceiveJSON","",$funcType([],[B.Object,$error],false),-1],["Send","Send","",$funcType([$emptyInterface],[$error],false),-1],["SendJSON","SendJSON","",$funcType([$emptyInterface],[$error],false),-1]];AX.init([["Notify","Notify","",($chanType($Bool,false,false)),""],["impl","impl","ninchatclient",B.Object,""],["open","open","ninchatclient",$Bool,""],["error","error","ninchatclient",$error,""],["buffer","buffer","ninchatclient",($sliceType(B.Object)),""]]);BE=$ifaceNil;AJ=X();AN=P(new $Uint64(0,4096),-0.25);$pkg.WebSocketSupported=!($global.WebSocket===undefined);BF();AK();}return;}};$f.$blocking=true;return $f;};return $pkg;})();
$go($packages["ninchatclient"].$init, [], true);
$flushConsole();

})();
//# sourceMappingURL=ninchatclient.min.js.map
