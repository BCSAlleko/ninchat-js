"use strict";
(function() {

Error.stackTraceLimit=Infinity;var $global,$module;if(typeof window!=="undefined"){$global=window;}else if(typeof self!=="undefined"){$global=self;}else if(typeof global!=="undefined"){$global=global;$global.require=require;}else{$global=this;}if($global===undefined||$global.Array===undefined){throw new Error("no global object found");}if(typeof module!=="undefined"){$module=module;}var $packages={},$idCounter=0;var $keys=function(m){return m?Object.keys(m):[];};var $min=Math.min;var $mod=function(x,y){return x%y;};var $parseInt=parseInt;var $parseFloat=function(f){if(f!==undefined&&f!==null&&f.constructor===Number){return f;}return parseFloat(f);};var $flushConsole=function(){};var $throwRuntimeError;var $throwNilPointerError=function(){$throwRuntimeError("invalid memory address or nil pointer dereference");};var $call=function(fn,rcvr,args){return fn.apply(rcvr,args);};var $makeFunc=function(fn){return function(){return fn(new($sliceType($jsObjectPtr))($global.Array.prototype.slice.call(arguments,[])));}};var $froundBuf=new Float32Array(1);var $fround=Math.fround||function(f){$froundBuf[0]=f;return $froundBuf[0];};var $mapArray=function(array,f){var newArray=new array.constructor(array.length);for(var i=0;i<array.length;i++){newArray[i]=f(array[i]);}return newArray;};var $methodVal=function(recv,name){var vals=recv.$methodVals||{};recv.$methodVals=vals;var f=vals[name];if(f!==undefined){return f;}var method=recv[name];f=function(){$stackDepthOffset--;try{return method.apply(recv,arguments);}finally{$stackDepthOffset++;}};vals[name]=f;return f;};var $methodExpr=function(typ,name){var method=typ.prototype[name];if(method.$expr===undefined){method.$expr=function(){$stackDepthOffset--;try{if(typ.wrapped){arguments[0]=new typ(arguments[0]);}return Function.call.apply(method,arguments);}finally{$stackDepthOffset++;}};}return method.$expr;};var $subslice=function(slice,low,high,max){if(low<0||high<low||max<high||high>slice.$capacity||max>slice.$capacity){$throwRuntimeError("slice bounds out of range");}var s=new slice.constructor(slice.$array);s.$offset=slice.$offset+low;s.$length=slice.$length-low;s.$capacity=slice.$capacity-low;if(high!==undefined){s.$length=high-low;}if(max!==undefined){s.$capacity=max-low;}return s;};var $sliceToArray=function(slice){if(slice.$length===0){return[];}if(slice.$array.constructor!==Array){return slice.$array.subarray(slice.$offset,slice.$offset+slice.$length);}return slice.$array.slice(slice.$offset,slice.$offset+slice.$length);};var $decodeRune=function(str,pos){var c0=str.charCodeAt(pos);if(c0<0x80){return[c0,1];}if(c0!==c0||c0<0xC0){return[0xFFFD,1];}var c1=str.charCodeAt(pos+1);if(c1!==c1||c1<0x80||0xC0<=c1){return[0xFFFD,1];}if(c0<0xE0){var r=(c0&0x1F)<<6|(c1&0x3F);if(r<=0x7F){return[0xFFFD,1];}return[r,2];}var c2=str.charCodeAt(pos+2);if(c2!==c2||c2<0x80||0xC0<=c2){return[0xFFFD,1];}if(c0<0xF0){var r=(c0&0x0F)<<12|(c1&0x3F)<<6|(c2&0x3F);if(r<=0x7FF){return[0xFFFD,1];}if(0xD800<=r&&r<=0xDFFF){return[0xFFFD,1];}return[r,3];}var c3=str.charCodeAt(pos+3);if(c3!==c3||c3<0x80||0xC0<=c3){return[0xFFFD,1];}if(c0<0xF8){var r=(c0&0x07)<<18|(c1&0x3F)<<12|(c2&0x3F)<<6|(c3&0x3F);if(r<=0xFFFF||0x10FFFF<r){return[0xFFFD,1];}return[r,4];}return[0xFFFD,1];};var $encodeRune=function(r){if(r<0||r>0x10FFFF||(0xD800<=r&&r<=0xDFFF)){r=0xFFFD;}if(r<=0x7F){return String.fromCharCode(r);}if(r<=0x7FF){return String.fromCharCode(0xC0|r>>6,0x80|(r&0x3F));}if(r<=0xFFFF){return String.fromCharCode(0xE0|r>>12,0x80|(r>>6&0x3F),0x80|(r&0x3F));}return String.fromCharCode(0xF0|r>>18,0x80|(r>>12&0x3F),0x80|(r>>6&0x3F),0x80|(r&0x3F));};var $stringToBytes=function(str){var array=new Uint8Array(str.length);for(var i=0;i<str.length;i++){array[i]=str.charCodeAt(i);}return array;};var $bytesToString=function(slice){if(slice.$length===0){return"";}var str="";for(var i=0;i<slice.$length;i+=10000){str+=String.fromCharCode.apply(undefined,slice.$array.subarray(slice.$offset+i,slice.$offset+Math.min(slice.$length,i+10000)));}return str;};var $stringToRunes=function(str){var array=new Int32Array(str.length);var rune,j=0;for(var i=0;i<str.length;i+=rune[1],j++){rune=$decodeRune(str,i);array[j]=rune[0];}return array.subarray(0,j);};var $runesToString=function(slice){if(slice.$length===0){return"";}var str="";for(var i=0;i<slice.$length;i++){str+=$encodeRune(slice.$array[slice.$offset+i]);}return str;};var $copyString=function(dst,src){var n=Math.min(src.length,dst.$length);for(var i=0;i<n;i++){dst.$array[dst.$offset+i]=src.charCodeAt(i);}return n;};var $copySlice=function(dst,src){var n=Math.min(src.$length,dst.$length);$copyArray(dst.$array,src.$array,dst.$offset,src.$offset,n,dst.constructor.elem);return n;};var $copy=function(dst,src,typ){switch(typ.kind){case $kindArray:$copyArray(dst,src,0,0,src.length,typ.elem);break;case $kindStruct:for(var i=0;i<typ.fields.length;i++){var f=typ.fields[i];switch(f.typ.kind){case $kindArray:case $kindStruct:$copy(dst[f.prop],src[f.prop],f.typ);continue;default:dst[f.prop]=src[f.prop];continue;}}break;}};var $copyArray=function(dst,src,dstOffset,srcOffset,n,elem){if(n===0||(dst===src&&dstOffset===srcOffset)){return;}if(src.subarray){dst.set(src.subarray(srcOffset,srcOffset+n),dstOffset);return;}switch(elem.kind){case $kindArray:case $kindStruct:if(dst===src&&dstOffset>srcOffset){for(var i=n-1;i>=0;i--){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}for(var i=0;i<n;i++){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}if(dst===src&&dstOffset>srcOffset){for(var i=n-1;i>=0;i--){dst[dstOffset+i]=src[srcOffset+i];}return;}for(var i=0;i<n;i++){dst[dstOffset+i]=src[srcOffset+i];}};var $clone=function(src,type){var clone=type.zero();$copy(clone,src,type);return clone;};var $pointerOfStructConversion=function(obj,type){if(obj.$proxies===undefined){obj.$proxies={};obj.$proxies[obj.constructor.string]=obj;}var proxy=obj.$proxies[type.string];if(proxy===undefined){var properties={};for(var i=0;i<type.elem.fields.length;i++){(function(fieldProp){properties[fieldProp]={get:function(){return obj[fieldProp];},set:function(value){obj[fieldProp]=value;},};})(type.elem.fields[i].prop);}proxy=Object.create(type.prototype,properties);proxy.$val=proxy;obj.$proxies[type.string]=proxy;proxy.$proxies=obj.$proxies;}return proxy;};var $append=function(slice){return $internalAppend(slice,arguments,1,arguments.length-1);};var $appendSlice=function(slice,toAppend){if(toAppend.constructor===String){var bytes=$stringToBytes(toAppend);return $internalAppend(slice,bytes,0,bytes.length);}return $internalAppend(slice,toAppend.$array,toAppend.$offset,toAppend.$length);};var $internalAppend=function(slice,array,offset,length){if(length===0){return slice;}var newArray=slice.$array;var newOffset=slice.$offset;var newLength=slice.$length+length;var newCapacity=slice.$capacity;if(newLength>newCapacity){newOffset=0;newCapacity=Math.max(newLength,slice.$capacity<1024?slice.$capacity*2:Math.floor(slice.$capacity*5/4));if(slice.$array.constructor===Array){newArray=slice.$array.slice(slice.$offset,slice.$offset+slice.$length);newArray.length=newCapacity;var zero=slice.constructor.elem.zero;for(var i=slice.$length;i<newCapacity;i++){newArray[i]=zero();}}else{newArray=new slice.$array.constructor(newCapacity);newArray.set(slice.$array.subarray(slice.$offset,slice.$offset+slice.$length));}}$copyArray(newArray,array,newOffset+slice.$length,offset,length,slice.constructor.elem);var newSlice=new slice.constructor(newArray);newSlice.$offset=newOffset;newSlice.$length=newLength;newSlice.$capacity=newCapacity;return newSlice;};var $equal=function(a,b,type){if(type===$jsObjectPtr){return a===b;}switch(type.kind){case $kindComplex64:case $kindComplex128:return a.$real===b.$real&&a.$imag===b.$imag;case $kindInt64:case $kindUint64:return a.$high===b.$high&&a.$low===b.$low;case $kindArray:if(a.length!==b.length){return false;}for(var i=0;i<a.length;i++){if(!$equal(a[i],b[i],type.elem)){return false;}}return true;case $kindStruct:for(var i=0;i<type.fields.length;i++){var f=type.fields[i];if(!$equal(a[f.prop],b[f.prop],f.typ)){return false;}}return true;case $kindInterface:return $interfaceIsEqual(a,b);default:return a===b;}};var $interfaceIsEqual=function(a,b){if(a===$ifaceNil||b===$ifaceNil){return a===b;}if(a.constructor!==b.constructor){return false;}if(a.constructor===$jsObjectPtr){return a.object===b.object;}if(!a.constructor.comparable){$throwRuntimeError("comparing uncomparable type "+a.constructor.string);}return $equal(a.$val,b.$val,a.constructor);};var $kindBool=1;var $kindInt=2;var $kindInt8=3;var $kindInt16=4;var $kindInt32=5;var $kindInt64=6;var $kindUint=7;var $kindUint8=8;var $kindUint16=9;var $kindUint32=10;var $kindUint64=11;var $kindUintptr=12;var $kindFloat32=13;var $kindFloat64=14;var $kindComplex64=15;var $kindComplex128=16;var $kindArray=17;var $kindChan=18;var $kindFunc=19;var $kindInterface=20;var $kindMap=21;var $kindPtr=22;var $kindSlice=23;var $kindString=24;var $kindStruct=25;var $kindUnsafePointer=26;var $methodSynthesizers=[];var $addMethodSynthesizer=function(f){if($methodSynthesizers===null){f();return;}$methodSynthesizers.push(f);};var $synthesizeMethods=function(){$methodSynthesizers.forEach(function(f){f();});$methodSynthesizers=null;};var $ifaceKeyFor=function(x){if(x===$ifaceNil){return'nil';}var c=x.constructor;return c.string+'$'+c.keyFor(x.$val);};var $identity=function(x){return x;};var $typeIDCounter=0;var $newType=function(size,kind,string,name,pkg,constructor){var typ;switch(kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindString:case $kindUnsafePointer:typ=function(v){this.$val=v;};typ.wrapped=true;break;case $kindFloat32:case $kindFloat64:typ=function(v){this.$val=v;};typ.wrapped=true;typ.keyFor=function(x){return $floatKey(x);};break;case $kindInt64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>0;this.$low=low>>>0;this.$val=this;};typ.keyFor=function(x){return x.$high+"$"+x.$low;};break;case $kindUint64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>>0;this.$low=low>>>0;this.$val=this;};typ.keyFor=function(x){return x.$high+"$"+x.$low;};break;case $kindComplex64:typ=function(real,imag){this.$real=$fround(real);this.$imag=$fround(imag);this.$val=this;};typ.keyFor=function(x){return x.$real+"$"+x.$imag;};break;case $kindComplex128:typ=function(real,imag){this.$real=real;this.$imag=imag;this.$val=this;};typ.keyFor=function(x){return x.$real+"$"+x.$imag;};break;case $kindArray:typ=function(v){this.$val=v;};typ.wrapped=true;typ.ptr=$newType(4,$kindPtr,"*"+string,"","",function(array){this.$get=function(){return array;};this.$set=function(v){$copy(this,v,typ);};this.$val=array;});typ.init=function(elem,len){typ.elem=elem;typ.len=len;typ.comparable=elem.comparable;typ.keyFor=function(x){return Array.prototype.join.call($mapArray(x,function(e){return String(elem.keyFor(e)).replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}),"$");};typ.ptr.init(typ);Object.defineProperty(typ.ptr.nil,"nilCheck",{get:$throwNilPointerError});};break;case $kindChan:typ=function(capacity){this.$val=this;this.$capacity=capacity;this.$buffer=[];this.$sendQueue=[];this.$recvQueue=[];this.$closed=false;};typ.keyFor=function(x){if(x.$id===undefined){$idCounter++;x.$id=$idCounter;}return String(x.$id);};typ.init=function(elem,sendOnly,recvOnly){typ.elem=elem;typ.sendOnly=sendOnly;typ.recvOnly=recvOnly;typ.nil=new typ(0);typ.nil.$sendQueue=typ.nil.$recvQueue={length:0,push:function(){},shift:function(){return undefined;},indexOf:function(){return-1;}};};break;case $kindFunc:typ=function(v){this.$val=v;};typ.wrapped=true;typ.init=function(params,results,variadic){typ.params=params;typ.results=results;typ.variadic=variadic;typ.comparable=false;};break;case $kindInterface:typ={implementedBy:{},missingMethodFor:{}};typ.keyFor=$ifaceKeyFor;typ.init=function(methods){typ.methods=methods;methods.forEach(function(m){$ifaceNil[m.prop]=$throwNilPointerError;});};break;case $kindMap:typ=function(v){this.$val=v;};typ.wrapped=true;typ.init=function(key,elem){typ.key=key;typ.elem=elem;typ.comparable=false;};break;case $kindPtr:typ=constructor||function(getter,setter,target){this.$get=getter;this.$set=setter;this.$target=target;this.$val=this;};typ.keyFor=function(x){if(x.$id===undefined){$idCounter++;x.$id=$idCounter;}return String(x.$id);};typ.init=function(elem){typ.elem=elem;typ.wrapped=(elem.kind===$kindArray);typ.nil=new typ($throwNilPointerError,$throwNilPointerError);};break;case $kindSlice:typ=function(array){if(array.constructor!==typ.nativeArray){array=new typ.nativeArray(array);}this.$array=array;this.$offset=0;this.$length=array.length;this.$capacity=array.length;this.$val=this;};typ.init=function(elem){typ.elem=elem;typ.comparable=false;typ.nativeArray=$nativeArray(elem.kind);typ.nil=new typ([]);};break;case $kindStruct:typ=function(v){this.$val=v;};typ.wrapped=true;typ.ptr=$newType(4,$kindPtr,"*"+string,"","",constructor);typ.ptr.elem=typ;typ.ptr.prototype.$get=function(){return this;};typ.ptr.prototype.$set=function(v){$copy(this,v,typ);};typ.init=function(fields){typ.fields=fields;fields.forEach(function(f){if(!f.typ.comparable){typ.comparable=false;}});typ.keyFor=function(x){var val=x.$val;return $mapArray(fields,function(f){return String(f.typ.keyFor(val[f.prop])).replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}).join("$");};var properties={};fields.forEach(function(f){properties[f.prop]={get:$throwNilPointerError,set:$throwNilPointerError};});typ.ptr.nil=Object.create(constructor.prototype,properties);typ.ptr.nil.$val=typ.ptr.nil;$addMethodSynthesizer(function(){var synthesizeMethod=function(target,m,f){if(target.prototype[m.prop]!==undefined){return;}target.prototype[m.prop]=function(){var v=this.$val[f.prop];if(f.typ===$jsObjectPtr){v=new $jsObjectPtr(v);}if(v.$val===undefined){v=new f.typ(v);}return v[m.prop].apply(v,arguments);};};fields.forEach(function(f){if(f.name===""){$methodSet(f.typ).forEach(function(m){synthesizeMethod(typ,m,f);synthesizeMethod(typ.ptr,m,f);});$methodSet($ptrType(f.typ)).forEach(function(m){synthesizeMethod(typ.ptr,m,f);});}});});};break;default:$panic(new $String("invalid kind: "+kind));}switch(kind){case $kindBool:case $kindMap:typ.zero=function(){return false;};break;case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindUnsafePointer:case $kindFloat32:case $kindFloat64:typ.zero=function(){return 0;};break;case $kindString:typ.zero=function(){return"";};break;case $kindInt64:case $kindUint64:case $kindComplex64:case $kindComplex128:var zero=new typ(0,0);typ.zero=function(){return zero;};break;case $kindChan:case $kindPtr:case $kindSlice:typ.zero=function(){return typ.nil;};break;case $kindFunc:typ.zero=function(){return $throwNilPointerError;};break;case $kindInterface:typ.zero=function(){return $ifaceNil;};break;case $kindArray:typ.zero=function(){var arrayClass=$nativeArray(typ.elem.kind);if(arrayClass!==Array){return new arrayClass(typ.len);}var array=new Array(typ.len);for(var i=0;i<typ.len;i++){array[i]=typ.elem.zero();}return array;};break;case $kindStruct:typ.zero=function(){return new typ.ptr();};break;default:$panic(new $String("invalid kind: "+kind));}typ.id=$typeIDCounter;$typeIDCounter++;typ.size=size;typ.kind=kind;typ.string=string;typ.typeName=name;typ.pkg=pkg;typ.methods=[];typ.methodSetCache=null;typ.comparable=true;typ.keyFor=typ.keyFor||$identity;return typ;};var $methodSet=function(typ){if(typ.methodSetCache!==null){return typ.methodSetCache;}var base={};var isPtr=(typ.kind===$kindPtr);if(isPtr&&typ.elem.kind===$kindInterface){typ.methodSetCache=[];return[];}var current=[{typ:isPtr?typ.elem:typ,indirect:isPtr}];var seen={};while(current.length>0){var next=[];var mset=[];current.forEach(function(e){if(seen[e.typ.string]){return;}seen[e.typ.string]=true;if(e.typ.typeName!==""){mset=mset.concat(e.typ.methods);if(e.indirect){mset=mset.concat($ptrType(e.typ).methods);}}switch(e.typ.kind){case $kindStruct:e.typ.fields.forEach(function(f){if(f.name===""){var fTyp=f.typ;var fIsPtr=(fTyp.kind===$kindPtr);next.push({typ:fIsPtr?fTyp.elem:fTyp,indirect:e.indirect||fIsPtr});}});break;case $kindInterface:mset=mset.concat(e.typ.methods);break;}});mset.forEach(function(m){if(base[m.name]===undefined){base[m.name]=m;}});current=next;}typ.methodSetCache=[];Object.keys(base).sort().forEach(function(name){typ.methodSetCache.push(base[name]);});return typ.methodSetCache;};var $Bool=$newType(1,$kindBool,"bool","bool","",null);var $Int=$newType(4,$kindInt,"int","int","",null);var $Int8=$newType(1,$kindInt8,"int8","int8","",null);var $Int16=$newType(2,$kindInt16,"int16","int16","",null);var $Int32=$newType(4,$kindInt32,"int32","int32","",null);var $Int64=$newType(8,$kindInt64,"int64","int64","",null);var $Uint=$newType(4,$kindUint,"uint","uint","",null);var $Uint8=$newType(1,$kindUint8,"uint8","uint8","",null);var $Uint16=$newType(2,$kindUint16,"uint16","uint16","",null);var $Uint32=$newType(4,$kindUint32,"uint32","uint32","",null);var $Uint64=$newType(8,$kindUint64,"uint64","uint64","",null);var $Uintptr=$newType(4,$kindUintptr,"uintptr","uintptr","",null);var $Float32=$newType(4,$kindFloat32,"float32","float32","",null);var $Float64=$newType(8,$kindFloat64,"float64","float64","",null);var $Complex64=$newType(8,$kindComplex64,"complex64","complex64","",null);var $Complex128=$newType(16,$kindComplex128,"complex128","complex128","",null);var $String=$newType(8,$kindString,"string","string","",null);var $UnsafePointer=$newType(4,$kindUnsafePointer,"unsafe.Pointer","Pointer","",null);var $nativeArray=function(elemKind){switch(elemKind){case $kindInt:return Int32Array;case $kindInt8:return Int8Array;case $kindInt16:return Int16Array;case $kindInt32:return Int32Array;case $kindUint:return Uint32Array;case $kindUint8:return Uint8Array;case $kindUint16:return Uint16Array;case $kindUint32:return Uint32Array;case $kindUintptr:return Uint32Array;case $kindFloat32:return Float32Array;case $kindFloat64:return Float64Array;default:return Array;}};var $toNativeArray=function(elemKind,array){var nativeArray=$nativeArray(elemKind);if(nativeArray===Array){return array;}return new nativeArray(array);};var $arrayTypes={};var $arrayType=function(elem,len){var typeKey=elem.id+"$"+len;var typ=$arrayTypes[typeKey];if(typ===undefined){typ=$newType(12,$kindArray,"["+len+"]"+elem.string,"","",null);$arrayTypes[typeKey]=typ;typ.init(elem,len);}return typ;};var $chanType=function(elem,sendOnly,recvOnly){var string=(recvOnly?"<-":"")+"chan"+(sendOnly?"<- ":" ")+elem.string;var field=sendOnly?"SendChan":(recvOnly?"RecvChan":"Chan");var typ=elem[field];if(typ===undefined){typ=$newType(4,$kindChan,string,"","",null);elem[field]=typ;typ.init(elem,sendOnly,recvOnly);}return typ;};var $funcTypes={};var $funcType=function(params,results,variadic){var typeKey=$mapArray(params,function(p){return p.id;}).join(",")+"$"+$mapArray(results,function(r){return r.id;}).join(",")+"$"+variadic;var typ=$funcTypes[typeKey];if(typ===undefined){var paramTypes=$mapArray(params,function(p){return p.string;});if(variadic){paramTypes[paramTypes.length-1]="..."+paramTypes[paramTypes.length-1].substr(2);}var string="func("+paramTypes.join(", ")+")";if(results.length===1){string+=" "+results[0].string;}else if(results.length>1){string+=" ("+$mapArray(results,function(r){return r.string;}).join(", ")+")";}typ=$newType(4,$kindFunc,string,"","",null);$funcTypes[typeKey]=typ;typ.init(params,results,variadic);}return typ;};var $interfaceTypes={};var $interfaceType=function(methods){var typeKey=$mapArray(methods,function(m){return m.pkg+","+m.name+","+m.typ.id;}).join("$");var typ=$interfaceTypes[typeKey];if(typ===undefined){var string="interface {}";if(methods.length!==0){string="interface { "+$mapArray(methods,function(m){return(m.pkg!==""?m.pkg+".":"")+m.name+m.typ.string.substr(4);}).join("; ")+" }";}typ=$newType(8,$kindInterface,string,"","",null);$interfaceTypes[typeKey]=typ;typ.init(methods);}return typ;};var $emptyInterface=$interfaceType([]);var $ifaceNil={};var $error=$newType(8,$kindInterface,"error","error","",null);$error.init([{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}]);var $Map=function(){};(function(){var names=Object.getOwnPropertyNames(Object.prototype);for(var i=0;i<names.length;i++){$Map.prototype[names[i]]=undefined;}})();var $mapTypes={};var $mapType=function(key,elem){var typeKey=key.id+"$"+elem.id;var typ=$mapTypes[typeKey];if(typ===undefined){typ=$newType(4,$kindMap,"map["+key.string+"]"+elem.string,"","",null);$mapTypes[typeKey]=typ;typ.init(key,elem);}return typ;};var $makeMap=function(keyForFunc,entries){var m=new $Map();for(var i=0;i<entries.length;i++){var e=entries[i];m[keyForFunc(e.k)]=e;}return m;};var $ptrType=function(elem){var typ=elem.ptr;if(typ===undefined){typ=$newType(4,$kindPtr,"*"+elem.string,"","",null);elem.ptr=typ;typ.init(elem);}return typ;};var $newDataPointer=function(data,constructor){if(constructor.elem.kind===$kindStruct){return data;}return new constructor(function(){return data;},function(v){data=v;});};var $indexPtr=function(array,index,constructor){array.$ptr=array.$ptr||{};return array.$ptr[index]||(array.$ptr[index]=new constructor(function(){return array[index];},function(v){array[index]=v;}));};var $sliceType=function(elem){var typ=elem.slice;if(typ===undefined){typ=$newType(12,$kindSlice,"[]"+elem.string,"","",null);elem.slice=typ;typ.init(elem);}return typ;};var $makeSlice=function(typ,length,capacity){capacity=capacity||length;var array=new typ.nativeArray(capacity);if(typ.nativeArray===Array){for(var i=0;i<capacity;i++){array[i]=typ.elem.zero();}}var slice=new typ(array);slice.$length=length;return slice;};var $structTypes={};var $structType=function(fields){var typeKey=$mapArray(fields,function(f){return f.name+","+f.typ.id+","+f.tag;}).join("$");var typ=$structTypes[typeKey];if(typ===undefined){var string="struct { "+$mapArray(fields,function(f){return f.name+" "+f.typ.string+(f.tag!==""?(" \""+f.tag.replace(/\\/g,"\\\\").replace(/"/g, "\\\"")+"\""):"");}).join("; ")+" }";if(fields.length===0){string="struct {}";}typ=$newType(0,$kindStruct,string,"","",function(){this.$val=this;for(var i=0;i<fields.length;i++){var f=fields[i];var arg=arguments[i];this[f.prop]=arg!==undefined?arg:f.typ.zero();}});$structTypes[typeKey]=typ;typ.init(fields);}return typ;};var $assertType=function(value,type,returnTuple){var isInterface=(type.kind===$kindInterface),ok,missingMethod="";if(value===$ifaceNil){ok=false;}else if(!isInterface){ok=value.constructor===type;}else{var valueTypeString=value.constructor.string;ok=type.implementedBy[valueTypeString];if(ok===undefined){ok=true;var valueMethodSet=$methodSet(value.constructor);var interfaceMethods=type.methods;for(var i=0;i<interfaceMethods.length;i++){var tm=interfaceMethods[i];var found=false;for(var j=0;j<valueMethodSet.length;j++){var vm=valueMethodSet[j];if(vm.name===tm.name&&vm.pkg===tm.pkg&&vm.typ===tm.typ){found=true;break;}}if(!found){ok=false;type.missingMethodFor[valueTypeString]=tm.name;break;}}type.implementedBy[valueTypeString]=ok;}if(!ok){missingMethod=type.missingMethodFor[valueTypeString];}}if(!ok){if(returnTuple){return[type.zero(),false];}$panic(new $packages["runtime"].TypeAssertionError.ptr("",(value===$ifaceNil?"":value.constructor.string),type.string,missingMethod));}if(!isInterface){value=value.$val;}if(type===$jsObjectPtr){value=value.object;}return returnTuple?[value,true]:value;};var $floatKey=function(f){if(f!==f){$idCounter++;return"NaN$"+$idCounter;}return String(f);};var $flatten64=function(x){return x.$high*4294967296+x.$low;};var $shiftLeft64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high<<y|x.$low>>>(32-y),(x.$low<<y)>>>0);}if(y<64){return new x.constructor(x.$low<<(y-32),0);}return new x.constructor(0,0);};var $shiftRightInt64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(x.$high>>31,(x.$high>>(y-32))>>>0);}if(x.$high<0){return new x.constructor(-1,4294967295);}return new x.constructor(0,0);};var $shiftRightUint64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(0,x.$high>>>(y-32));}return new x.constructor(0,0);};var $mul64=function(x,y){var high=0,low=0;if((y.$low&1)!==0){high=x.$high;low=x.$low;}for(var i=1;i<32;i++){if((y.$low&1<<i)!==0){high+=x.$high<<i|x.$low>>>(32-i);low+=(x.$low<<i)>>>0;}}for(var i=0;i<32;i++){if((y.$high&1<<i)!==0){high+=x.$low<<i;}}return new x.constructor(high,low);};var $div64=function(x,y,returnRemainder){if(y.$high===0&&y.$low===0){$throwRuntimeError("integer divide by zero");}var s=1;var rs=1;var xHigh=x.$high;var xLow=x.$low;if(xHigh<0){s=-1;rs=-1;xHigh=-xHigh;if(xLow!==0){xHigh--;xLow=4294967296-xLow;}}var yHigh=y.$high;var yLow=y.$low;if(y.$high<0){s*=-1;yHigh=-yHigh;if(yLow!==0){yHigh--;yLow=4294967296-yLow;}}var high=0,low=0,n=0;while(yHigh<2147483648&&((xHigh>yHigh)||(xHigh===yHigh&&xLow>yLow))){yHigh=(yHigh<<1|yLow>>>31)>>>0;yLow=(yLow<<1)>>>0;n++;}for(var i=0;i<=n;i++){high=high<<1|low>>>31;low=(low<<1)>>>0;if((xHigh>yHigh)||(xHigh===yHigh&&xLow>=yLow)){xHigh=xHigh-yHigh;xLow=xLow-yLow;if(xLow<0){xHigh--;xLow+=4294967296;}low++;if(low===4294967296){high++;low=0;}}yLow=(yLow>>>1|yHigh<<(32-1))>>>0;yHigh=yHigh>>>1;}if(returnRemainder){return new x.constructor(xHigh*rs,xLow*rs);}return new x.constructor(high*s,low*s);};var $divComplex=function(n,d){var ninf=n.$real===1/0||n.$real===-1/0||n.$imag===1/0||n.$imag===-1/0;var dinf=d.$real===1/0||d.$real===-1/0||d.$imag===1/0||d.$imag===-1/0;var nnan=!ninf&&(n.$real!==n.$real||n.$imag!==n.$imag);var dnan=!dinf&&(d.$real!==d.$real||d.$imag!==d.$imag);if(nnan||dnan){return new n.constructor(0/0,0/0);}if(ninf&&!dinf){return new n.constructor(1/0,1/0);}if(!ninf&&dinf){return new n.constructor(0,0);}if(d.$real===0&&d.$imag===0){if(n.$real===0&&n.$imag===0){return new n.constructor(0/0,0/0);}return new n.constructor(1/0,1/0);}var a=Math.abs(d.$real);var b=Math.abs(d.$imag);if(a<=b){var ratio=d.$real/d.$imag;var denom=d.$real*ratio+d.$imag;return new n.constructor((n.$real*ratio+n.$imag)/denom,(n.$imag*ratio-n.$real)/denom);}var ratio=d.$imag/d.$real;var denom=d.$imag*ratio+d.$real;return new n.constructor((n.$imag*ratio+n.$real)/denom,(n.$imag-n.$real*ratio)/denom);};var $stackDepthOffset=0;var $getStackDepth=function(){var err=new Error();if(err.stack===undefined){return undefined;}return $stackDepthOffset+err.stack.split("\n").length;};var $panicStackDepth=null,$panicValue;var $callDeferred=function(deferred,jsErr,fromPanic){if(!fromPanic&&deferred!==null&&deferred.index>=$curGoroutine.deferStack.length){throw jsErr;}if(jsErr!==null){var newErr=null;try{$curGoroutine.deferStack.push(deferred);$panic(new $jsErrorPtr(jsErr));}catch(err){newErr=err;}$curGoroutine.deferStack.pop();$callDeferred(deferred,newErr);return;}if($curGoroutine.asleep){return;}$stackDepthOffset--;var outerPanicStackDepth=$panicStackDepth;var outerPanicValue=$panicValue;var localPanicValue=$curGoroutine.panicStack.pop();if(localPanicValue!==undefined){$panicStackDepth=$getStackDepth();$panicValue=localPanicValue;}try{while(true){if(deferred===null){deferred=$curGoroutine.deferStack[$curGoroutine.deferStack.length-1];if(deferred===undefined){$panicStackDepth=null;if(localPanicValue.Object instanceof Error){throw localPanicValue.Object;}var msg;if(localPanicValue.constructor===$String){msg=localPanicValue.$val;}else if(localPanicValue.Error!==undefined){msg=localPanicValue.Error();}else if(localPanicValue.String!==undefined){msg=localPanicValue.String();}else{msg=localPanicValue;}throw new Error(msg);}}var call=deferred.pop();if(call===undefined){$curGoroutine.deferStack.pop();if(localPanicValue!==undefined){deferred=null;continue;}return;}var r=call[0].apply(call[2],call[1]);if(r&&r.$blk!==undefined){deferred.push([r.$blk,[],r]);if(fromPanic){throw null;}return;}if(localPanicValue!==undefined&&$panicStackDepth===null){throw null;}}}finally{if(localPanicValue!==undefined){if($panicStackDepth!==null){$curGoroutine.panicStack.push(localPanicValue);}$panicStackDepth=outerPanicStackDepth;$panicValue=outerPanicValue;}$stackDepthOffset++;}};var $panic=function(value){$curGoroutine.panicStack.push(value);$callDeferred(null,null,true);};var $recover=function(){if($panicStackDepth===null||($panicStackDepth!==undefined&&$panicStackDepth!==$getStackDepth()-2)){return $ifaceNil;}$panicStackDepth=null;return $panicValue;};var $throw=function(err){throw err;};var $dummyGoroutine={asleep:false,exit:false,deferStack:[],panicStack:[],canBlock:false};var $curGoroutine=$dummyGoroutine,$totalGoroutines=0,$awakeGoroutines=0,$checkForDeadlock=true;var $go=function(fun,args,direct){$totalGoroutines++;$awakeGoroutines++;var $goroutine=function(){var rescheduled=false;try{$curGoroutine=$goroutine;var r=fun.apply(undefined,args);if(r&&r.$blk!==undefined){fun=function(){return r.$blk();};args=[];rescheduled=true;return;}$goroutine.exit=true;}catch(err){$goroutine.exit=true;throw err;}finally{$curGoroutine=$dummyGoroutine;if($goroutine.exit&&!rescheduled){$totalGoroutines--;$goroutine.asleep=true;}if($goroutine.asleep&&!rescheduled){$awakeGoroutines--;if($awakeGoroutines===0&&$totalGoroutines!==0&&$checkForDeadlock){console.error("fatal error: all goroutines are asleep - deadlock!");}}}};$goroutine.asleep=false;$goroutine.exit=false;$goroutine.deferStack=[];$goroutine.panicStack=[];$goroutine.canBlock=true;$schedule($goroutine,direct);};var $scheduled=[],$schedulerActive=false;var $runScheduled=function(){try{var r;while((r=$scheduled.shift())!==undefined){r();}$schedulerActive=false;}finally{if($schedulerActive){setTimeout($runScheduled,0);}}};var $schedule=function(goroutine,direct){if(goroutine.asleep){goroutine.asleep=false;$awakeGoroutines++;}if(direct){goroutine();return;}$scheduled.push(goroutine);if(!$schedulerActive){$schedulerActive=true;setTimeout($runScheduled,0);}};var $block=function(){if(!$curGoroutine.canBlock){$throwRuntimeError("cannot block in JavaScript callback, fix by wrapping code in goroutine");}$curGoroutine.asleep=true;};var $send=function(chan,value){if(chan.$closed){$throwRuntimeError("send on closed channel");}var queuedRecv=chan.$recvQueue.shift();if(queuedRecv!==undefined){queuedRecv([value,true]);return;}if(chan.$buffer.length<chan.$capacity){chan.$buffer.push(value);return;}var thisGoroutine=$curGoroutine;chan.$sendQueue.push(function(){$schedule(thisGoroutine);return value;});$block();return{$blk:function(){if(chan.$closed){$throwRuntimeError("send on closed channel");}},};};var $recv=function(chan){var queuedSend=chan.$sendQueue.shift();if(queuedSend!==undefined){chan.$buffer.push(queuedSend());}var bufferedValue=chan.$buffer.shift();if(bufferedValue!==undefined){return[bufferedValue,true];}if(chan.$closed){return[chan.constructor.elem.zero(),false];}var thisGoroutine=$curGoroutine;var f={$blk:function(){return this.value;}};var queueEntry=function(v){f.value=v;$schedule(thisGoroutine);};chan.$recvQueue.push(queueEntry);$block();return f;};var $close=function(chan){if(chan.$closed){$throwRuntimeError("close of closed channel");}chan.$closed=true;while(true){var queuedSend=chan.$sendQueue.shift();if(queuedSend===undefined){break;}queuedSend();}while(true){var queuedRecv=chan.$recvQueue.shift();if(queuedRecv===undefined){break;}queuedRecv([chan.constructor.elem.zero(),false]);}};var $select=function(comms){var ready=[];var selection=-1;for(var i=0;i<comms.length;i++){var comm=comms[i];var chan=comm[0];switch(comm.length){case 0:selection=i;break;case 1:if(chan.$sendQueue.length!==0||chan.$buffer.length!==0||chan.$closed){ready.push(i);}break;case 2:if(chan.$closed){$throwRuntimeError("send on closed channel");}if(chan.$recvQueue.length!==0||chan.$buffer.length<chan.$capacity){ready.push(i);}break;}}if(ready.length!==0){selection=ready[Math.floor(Math.random()*ready.length)];}if(selection!==-1){var comm=comms[selection];switch(comm.length){case 0:return[selection];case 1:return[selection,$recv(comm[0])];case 2:$send(comm[0],comm[1]);return[selection];}}var entries=[];var thisGoroutine=$curGoroutine;var f={$blk:function(){return this.selection;}};var removeFromQueues=function(){for(var i=0;i<entries.length;i++){var entry=entries[i];var queue=entry[0];var index=queue.indexOf(entry[1]);if(index!==-1){queue.splice(index,1);}}};for(var i=0;i<comms.length;i++){(function(i){var comm=comms[i];switch(comm.length){case 1:var queueEntry=function(value){f.selection=[i,value];removeFromQueues();$schedule(thisGoroutine);};entries.push([comm[0].$recvQueue,queueEntry]);comm[0].$recvQueue.push(queueEntry);break;case 2:var queueEntry=function(){if(comm[0].$closed){$throwRuntimeError("send on closed channel");}f.selection=[i];removeFromQueues();$schedule(thisGoroutine);return comm[1];};entries.push([comm[0].$sendQueue,queueEntry]);comm[0].$sendQueue.push(queueEntry);break;}})(i);}$block();return f;};var $jsObjectPtr,$jsErrorPtr;var $needsExternalization=function(t){switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return false;default:return t!==$jsObjectPtr;}};var $externalize=function(v,t){if(t===$jsObjectPtr){return v;}switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return v;case $kindInt64:case $kindUint64:return $flatten64(v);case $kindArray:if($needsExternalization(t.elem)){return $mapArray(v,function(e){return $externalize(e,t.elem);});}return v;case $kindFunc:return $externalizeFunction(v,t,false);case $kindInterface:if(v===$ifaceNil){return null;}if(v.constructor===$jsObjectPtr){return v.$val.object;}return $externalize(v.$val,v.constructor);case $kindMap:var m={};var keys=$keys(v);for(var i=0;i<keys.length;i++){var entry=v[keys[i]];m[$externalize(entry.k,t.key)]=$externalize(entry.v,t.elem);}return m;case $kindPtr:if(v===t.nil){return null;}return $externalize(v.$get(),t.elem);case $kindSlice:if($needsExternalization(t.elem)){return $mapArray($sliceToArray(v),function(e){return $externalize(e,t.elem);});}return $sliceToArray(v);case $kindString:if(v.search(/^[\x00-\x7F]*$/)!==-1){return v;}var s="",r;for(var i=0;i<v.length;i+=r[1]){r=$decodeRune(v,i);s+=String.fromCharCode(r[0]);}return s;case $kindStruct:var timePkg=$packages["time"];if(timePkg!==undefined&&v.constructor===timePkg.Time.ptr){var milli=$div64(v.UnixNano(),new $Int64(0,1000000));return new Date($flatten64(milli));}var noJsObject={};var searchJsObject=function(v,t){if(t===$jsObjectPtr){return v;}switch(t.kind){case $kindPtr:if(v===t.nil){return noJsObject;}return searchJsObject(v.$get(),t.elem);case $kindStruct:var f=t.fields[0];return searchJsObject(v[f.prop],f.typ);case $kindInterface:return searchJsObject(v.$val,v.constructor);default:return noJsObject;}};var o=searchJsObject(v,t);if(o!==noJsObject){return o;}o={};for(var i=0;i<t.fields.length;i++){var f=t.fields[i];if(f.pkg!==""){continue;}o[f.name]=$externalize(v[f.prop],f.typ);}return o;}$panic(new $String("cannot externalize "+t.string));};var $externalizeFunction=function(v,t,passThis){if(v===$throwNilPointerError){return null;}if(v.$externalizeWrapper===undefined){$checkForDeadlock=false;v.$externalizeWrapper=function(){var args=[];for(var i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=[];for(var j=i;j<arguments.length;j++){varargs.push($internalize(arguments[j],vt));}args.push(new(t.params[i])(varargs));break;}args.push($internalize(arguments[i],t.params[i]));}var canBlock=$curGoroutine.canBlock;$curGoroutine.canBlock=false;try{var result=v.apply(passThis?this:undefined,args);}finally{$curGoroutine.canBlock=canBlock;}switch(t.results.length){case 0:return;case 1:return $externalize(result,t.results[0]);default:for(var i=0;i<t.results.length;i++){result[i]=$externalize(result[i],t.results[i]);}return result;}};}return v.$externalizeWrapper;};var $internalize=function(v,t,recv){if(t===$jsObjectPtr){return v;}if(t===$jsObjectPtr.elem){$panic(new $String("cannot internalize js.Object, use *js.Object instead"));}var timePkg=$packages["time"];if(timePkg!==undefined&&t===timePkg.Time){if(!(v!==null&&v!==undefined&&v.constructor===Date)){$panic(new $String("cannot internalize time.Time from "+typeof v+", must be Date"));}return timePkg.Unix(new $Int64(0,0),new $Int64(0,v.getTime()*1000000));}switch(t.kind){case $kindBool:return!!v;case $kindInt:return parseInt(v);case $kindInt8:return parseInt(v)<<24>>24;case $kindInt16:return parseInt(v)<<16>>16;case $kindInt32:return parseInt(v)>>0;case $kindUint:return parseInt(v);case $kindUint8:return parseInt(v)<<24>>>24;case $kindUint16:return parseInt(v)<<16>>>16;case $kindUint32:case $kindUintptr:return parseInt(v)>>>0;case $kindInt64:case $kindUint64:return new t(0,v);case $kindFloat32:case $kindFloat64:return parseFloat(v);case $kindArray:if(v.length!==t.len){$throwRuntimeError("got array with wrong size from JavaScript native");}return $mapArray(v,function(e){return $internalize(e,t.elem);});case $kindFunc:return function(){var args=[];for(var i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=arguments[i];for(var j=0;j<varargs.$length;j++){args.push($externalize(varargs.$array[varargs.$offset+j],vt));}break;}args.push($externalize(arguments[i],t.params[i]));}var result=v.apply(recv,args);switch(t.results.length){case 0:return;case 1:return $internalize(result,t.results[0]);default:for(var i=0;i<t.results.length;i++){result[i]=$internalize(result[i],t.results[i]);}return result;}};case $kindInterface:if(t.methods.length!==0){$panic(new $String("cannot internalize "+t.string));}if(v===null){return $ifaceNil;}if(v===undefined){return new $jsObjectPtr(undefined);}switch(v.constructor){case Int8Array:return new($sliceType($Int8))(v);case Int16Array:return new($sliceType($Int16))(v);case Int32Array:return new($sliceType($Int))(v);case Uint8Array:return new($sliceType($Uint8))(v);case Uint16Array:return new($sliceType($Uint16))(v);case Uint32Array:return new($sliceType($Uint))(v);case Float32Array:return new($sliceType($Float32))(v);case Float64Array:return new($sliceType($Float64))(v);case Array:return $internalize(v,$sliceType($emptyInterface));case Boolean:return new $Bool(!!v);case Date:if(timePkg===undefined){return new $jsObjectPtr(v);}return new timePkg.Time($internalize(v,timePkg.Time));case Function:var funcType=$funcType([$sliceType($emptyInterface)],[$jsObjectPtr],true);return new funcType($internalize(v,funcType));case Number:return new $Float64(parseFloat(v));case String:return new $String($internalize(v,$String));default:if($global.Node&&v instanceof $global.Node){return new $jsObjectPtr(v);}var mapType=$mapType($String,$emptyInterface);return new mapType($internalize(v,mapType));}case $kindMap:var m=new $Map();var keys=$keys(v);for(var i=0;i<keys.length;i++){var k=$internalize(keys[i],t.key);m[t.key.keyFor(k)]={k:k,v:$internalize(v[keys[i]],t.elem)};}return m;case $kindPtr:if(t.elem.kind===$kindStruct){return $internalize(v,t.elem);}case $kindSlice:return new t($mapArray(v,function(e){return $internalize(e,t.elem);}));case $kindString:v=String(v);if(v.search(/^[\x00-\x7F]*$/)!==-1){return v;}var s="";for(var i=0;i<v.length;i++){s+=$encodeRune(v.charCodeAt(i));}return s;case $kindStruct:var noJsObject={};var searchJsObject=function(t){if(t===$jsObjectPtr){return v;}if(t===$jsObjectPtr.elem){$panic(new $String("cannot internalize js.Object, use *js.Object instead"));}switch(t.kind){case $kindPtr:return searchJsObject(t.elem);case $kindStruct:var f=t.fields[0];var o=searchJsObject(f.typ);if(o!==noJsObject){var n=new t.ptr();n[f.prop]=o;return n;}return noJsObject;default:return noJsObject;}};var o=searchJsObject(t);if(o!==noJsObject){return o;}}$panic(new $String("cannot internalize "+t.string));};
$packages["github.com/gopherjs/gopherjs/js"]=(function(){var $pkg={},$init,A,B,L,N,Q,K;A=$pkg.Object=$newType(0,$kindStruct,"js.Object","Object","github.com/gopherjs/gopherjs/js",function(object_){this.$val=this;if(arguments.length===0){this.object=null;return;}this.object=object_;});B=$pkg.Error=$newType(0,$kindStruct,"js.Error","Error","github.com/gopherjs/gopherjs/js",function(Object_){this.$val=this;if(arguments.length===0){this.Object=null;return;}this.Object=Object_;});L=$sliceType($emptyInterface);N=$ptrType(A);Q=$ptrType(B);A.ptr.prototype.Get=function(a){var $ptr,a,b;b=this;return b.object[$externalize(a,$String)];};A.prototype.Get=function(a){return this.$val.Get(a);};A.ptr.prototype.Set=function(a,b){var $ptr,a,b,c;c=this;c.object[$externalize(a,$String)]=$externalize(b,$emptyInterface);};A.prototype.Set=function(a,b){return this.$val.Set(a,b);};A.ptr.prototype.Delete=function(a){var $ptr,a,b;b=this;delete b.object[$externalize(a,$String)];};A.prototype.Delete=function(a){return this.$val.Delete(a);};A.ptr.prototype.Length=function(){var $ptr,a;a=this;return $parseInt(a.object.length);};A.prototype.Length=function(){return this.$val.Length();};A.ptr.prototype.Index=function(a){var $ptr,a,b;b=this;return b.object[a];};A.prototype.Index=function(a){return this.$val.Index(a);};A.ptr.prototype.SetIndex=function(a,b){var $ptr,a,b,c;c=this;c.object[a]=$externalize(b,$emptyInterface);};A.prototype.SetIndex=function(a,b){return this.$val.SetIndex(a,b);};A.ptr.prototype.Call=function(a,b){var $ptr,a,b,c,d;c=this;return(d=c.object,d[$externalize(a,$String)].apply(d,$externalize(b,L)));};A.prototype.Call=function(a,b){return this.$val.Call(a,b);};A.ptr.prototype.Invoke=function(a){var $ptr,a,b;b=this;return b.object.apply(undefined,$externalize(a,L));};A.prototype.Invoke=function(a){return this.$val.Invoke(a);};A.ptr.prototype.New=function(a){var $ptr,a,b;b=this;return new($global.Function.prototype.bind.apply(b.object,[undefined].concat($externalize(a,L))));};A.prototype.New=function(a){return this.$val.New(a);};A.ptr.prototype.Bool=function(){var $ptr,a;a=this;return!!(a.object);};A.prototype.Bool=function(){return this.$val.Bool();};A.ptr.prototype.String=function(){var $ptr,a;a=this;return $internalize(a.object,$String);};A.prototype.String=function(){return this.$val.String();};A.ptr.prototype.Int=function(){var $ptr,a;a=this;return $parseInt(a.object)>>0;};A.prototype.Int=function(){return this.$val.Int();};A.ptr.prototype.Int64=function(){var $ptr,a;a=this;return $internalize(a.object,$Int64);};A.prototype.Int64=function(){return this.$val.Int64();};A.ptr.prototype.Uint64=function(){var $ptr,a;a=this;return $internalize(a.object,$Uint64);};A.prototype.Uint64=function(){return this.$val.Uint64();};A.ptr.prototype.Float=function(){var $ptr,a;a=this;return $parseFloat(a.object);};A.prototype.Float=function(){return this.$val.Float();};A.ptr.prototype.Interface=function(){var $ptr,a;a=this;return $internalize(a.object,$emptyInterface);};A.prototype.Interface=function(){return this.$val.Interface();};A.ptr.prototype.Unsafe=function(){var $ptr,a;a=this;return a.object;};A.prototype.Unsafe=function(){return this.$val.Unsafe();};B.ptr.prototype.Error=function(){var $ptr,a;a=this;return"JavaScript error: "+$internalize(a.Object.message,$String);};B.prototype.Error=function(){return this.$val.Error();};B.ptr.prototype.Stack=function(){var $ptr,a;a=this;return $internalize(a.Object.stack,$String);};B.prototype.Stack=function(){return this.$val.Stack();};K=function(){var $ptr,a;a=new B.ptr(null);};N.methods=[{prop:"Get",name:"Get",pkg:"",typ:$funcType([$String],[N],false)},{prop:"Set",name:"Set",pkg:"",typ:$funcType([$String,$emptyInterface],[],false)},{prop:"Delete",name:"Delete",pkg:"",typ:$funcType([$String],[],false)},{prop:"Length",name:"Length",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Index",name:"Index",pkg:"",typ:$funcType([$Int],[N],false)},{prop:"SetIndex",name:"SetIndex",pkg:"",typ:$funcType([$Int,$emptyInterface],[],false)},{prop:"Call",name:"Call",pkg:"",typ:$funcType([$String,L],[N],true)},{prop:"Invoke",name:"Invoke",pkg:"",typ:$funcType([L],[N],true)},{prop:"New",name:"New",pkg:"",typ:$funcType([L],[N],true)},{prop:"Bool",name:"Bool",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)},{prop:"Int",name:"Int",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Int64",name:"Int64",pkg:"",typ:$funcType([],[$Int64],false)},{prop:"Uint64",name:"Uint64",pkg:"",typ:$funcType([],[$Uint64],false)},{prop:"Float",name:"Float",pkg:"",typ:$funcType([],[$Float64],false)},{prop:"Interface",name:"Interface",pkg:"",typ:$funcType([],[$emptyInterface],false)},{prop:"Unsafe",name:"Unsafe",pkg:"",typ:$funcType([],[$Uintptr],false)}];Q.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)},{prop:"Stack",name:"Stack",pkg:"",typ:$funcType([],[$String],false)}];A.init([{prop:"object",name:"object",pkg:"github.com/gopherjs/gopherjs/js",typ:N,tag:""}]);B.init([{prop:"Object",name:"",pkg:"",typ:N,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:K();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["runtime"]=(function(){var $pkg={},$init,A,AB,AC,AU,C;A=$packages["github.com/gopherjs/gopherjs/js"];AB=$pkg.TypeAssertionError=$newType(0,$kindStruct,"runtime.TypeAssertionError","TypeAssertionError","runtime",function(interfaceString_,concreteString_,assertedString_,missingMethod_){this.$val=this;if(arguments.length===0){this.interfaceString="";this.concreteString="";this.assertedString="";this.missingMethod="";return;}this.interfaceString=interfaceString_;this.concreteString=concreteString_;this.assertedString=assertedString_;this.missingMethod=missingMethod_;});AC=$pkg.errorString=$newType(8,$kindString,"runtime.errorString","errorString","runtime",null);AU=$ptrType(AB);C=function(){var $ptr,a,b;a=$packages[$externalize("github.com/gopherjs/gopherjs/js",$String)];$jsObjectPtr=a.Object.ptr;$jsErrorPtr=a.Error.ptr;$throwRuntimeError=(function(b){var $ptr,b;$panic(new AC(b));});b=$ifaceNil;b=new AB.ptr("","","","");};AB.ptr.prototype.RuntimeError=function(){var $ptr;};AB.prototype.RuntimeError=function(){return this.$val.RuntimeError();};AB.ptr.prototype.Error=function(){var $ptr,a,b;a=this;b=a.interfaceString;if(b===""){b="interface";}if(a.concreteString===""){return"interface conversion: "+b+" is nil, not "+a.assertedString;}if(a.missingMethod===""){return"interface conversion: "+b+" is "+a.concreteString+", not "+a.assertedString;}return"interface conversion: "+a.concreteString+" is not "+a.assertedString+": missing method "+a.missingMethod;};AB.prototype.Error=function(){return this.$val.Error();};AC.prototype.RuntimeError=function(){var $ptr,a;a=this.$val;};$ptrType(AC).prototype.RuntimeError=function(){return new AC(this.$get()).RuntimeError();};AC.prototype.Error=function(){var $ptr,a;a=this.$val;return"runtime error: "+a;};$ptrType(AC).prototype.Error=function(){return new AC(this.$get()).Error();};AU.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];AC.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];AB.init([{prop:"interfaceString",name:"interfaceString",pkg:"runtime",typ:$String,tag:""},{prop:"concreteString",name:"concreteString",pkg:"runtime",typ:$String,tag:""},{prop:"assertedString",name:"assertedString",pkg:"runtime",typ:$String,tag:""},{prop:"missingMethod",name:"missingMethod",pkg:"runtime",typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}C();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["errors"]=(function(){var $pkg={},$init,B,C,A;B=$pkg.errorString=$newType(0,$kindStruct,"errors.errorString","errorString","errors",function(s_){this.$val=this;if(arguments.length===0){this.s="";return;}this.s=s_;});C=$ptrType(B);A=function(a){var $ptr,a;return new B.ptr(a);};$pkg.New=A;B.ptr.prototype.Error=function(){var $ptr,a;a=this;return a.s;};B.prototype.Error=function(){return this.$val.Error();};C.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];B.init([{prop:"s",name:"s",pkg:"errors",typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["sort"]=(function(){var $pkg={},$init,A;A=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=0;d=a;e=c;f=d;case 1:if(!(e<f)){$s=2;continue;}h=e+(g=((f-e>>0))/2,(g===g&&g!==1/0&&g!==-1/0)?g>>0:$throwRuntimeError("integer divide by zero"))>>0;i=b(h);$s=6;case 6:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}if(!i){$s=3;continue;}$s=4;continue;case 3:e=h+1>>0;$s=5;continue;case 4:f=h;case 5:$s=1;continue;case 2:return e;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:A};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.$s=$s;$f.$r=$r;return $f;};$pkg.Search=A;$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["github.com/ninchat/ninchat-go"]=(function(){var $pkg={},$init,A,B,C,F,G,H,J,M,Z,AA,AD,AV,AW,AX,AY,BB,BH,BI,BJ,BK,BL,BM,BN,BO,BP,BQ,BR,BS,BT,BU,BV,BW,BX,BY,BZ,CA,CB,CC,CD,CE,CF,CG,CH,CI,CJ,W,X,AU,BA,D,E,I,N,O,P,R,S,T,U,V,Y,AB,AC,AE,AF,AG,AH,AI,AJ,AK,AL,AM,AN,AO,AP,AQ,AR,AS,AT,AZ,BC,BD,BE,BF,BG;A=$packages["errors"];B=$packages["github.com/gopherjs/gopherjs/js"];C=$packages["sort"];F=$pkg.Action=$newType(0,$kindStruct,"ninchat.Action","Action","github.com/ninchat/ninchat-go",function(Params_,Payload_,OnReply_,id_){this.$val=this;if(arguments.length===0){this.Params=false;this.Payload=BK.nil;this.OnReply=$throwNilPointerError;this.id=new $Int64(0,0);return;}this.Params=Params_;this.Payload=Payload_;this.OnReply=OnReply_;this.id=id_;});G=$pkg.Event=$newType(0,$kindStruct,"ninchat.Event","Event","github.com/ninchat/ninchat-go",function(Params_,Payload_,LastReply_){this.$val=this;if(arguments.length===0){this.Params=false;this.Payload=BK.nil;this.LastReply=false;return;}this.Params=Params_;this.Payload=Payload_;this.LastReply=LastReply_;});H=$pkg.Frame=$newType(4,$kindPtr,"ninchat.Frame","Frame","github.com/ninchat/ninchat-go",null);J=$pkg.backoff=$newType(0,$kindStruct,"ninchat.backoff","backoff","github.com/ninchat/ninchat-go",function(lastSlot_){this.$val=this;if(arguments.length===0){this.lastSlot=0;return;}this.lastSlot=lastSlot_;});M=$pkg.Caller=$newType(0,$kindStruct,"ninchat.Caller","Caller","github.com/ninchat/ninchat-go",function(Address_){this.$val=this;if(arguments.length===0){this.Address="";return;}this.Address=Address_;});Z=$pkg.httpHeader=$newType(4,$kindMap,"ninchat.httpHeader","httpHeader","github.com/ninchat/ninchat-go",null);AA=$pkg.httpRequest=$newType(0,$kindStruct,"ninchat.httpRequest","httpRequest","github.com/ninchat/ninchat-go",function(Method_,URL_,Header_,data_){this.$val=this;if(arguments.length===0){this.Method="";this.URL="";this.Header=false;this.data=null;return;}this.Method=Method_;this.URL=URL_;this.Header=Header_;this.data=data_;});AD=$pkg.httpResponse=$newType(0,$kindStruct,"ninchat.httpResponse","httpResponse","github.com/ninchat/ninchat-go",function(data_,err_){this.$val=this;if(arguments.length===0){this.data=null;this.err=$ifaceNil;return;}this.data=data_;this.err=err_;});AV=$pkg.Session=$newType(0,$kindStruct,"ninchat.Session","Session","github.com/ninchat/ninchat-go",function(OnSessionEvent_,OnEvent_,OnClose_,OnConnState_,OnConnActive_,OnLog_,Address_,forceLongPoll_,sessionParams_,sessionId_,latestConnState_,lastActionId_,sendNotify_,sendBuffer_,numSent_,sendEventAck_,receivedEventId_,ackedEventId_,closeNotify_,closed_,running_){this.$val=this;if(arguments.length===0){this.OnSessionEvent=$throwNilPointerError;this.OnEvent=$throwNilPointerError;this.OnClose=$throwNilPointerError;this.OnConnState=$throwNilPointerError;this.OnConnActive=$throwNilPointerError;this.OnLog=$throwNilPointerError;this.Address="";this.forceLongPoll=false;this.sessionParams=false;this.sessionId=$ifaceNil;this.latestConnState="";this.lastActionId=new $Int64(0,0);this.sendNotify=BX.nil;this.sendBuffer=BZ.nil;this.numSent=0;this.sendEventAck=false;this.receivedEventId=new $Int64(0,0);this.ackedEventId=new $Int64(0,0);this.closeNotify=BX.nil;this.closed=false;this.running=false;return;}this.OnSessionEvent=OnSessionEvent_;this.OnEvent=OnEvent_;this.OnClose=OnClose_;this.OnConnState=OnConnState_;this.OnConnActive=OnConnActive_;this.OnLog=OnLog_;this.Address=Address_;this.forceLongPoll=forceLongPoll_;this.sessionParams=sessionParams_;this.sessionId=sessionId_;this.latestConnState=latestConnState_;this.lastActionId=lastActionId_;this.sendNotify=sendNotify_;this.sendBuffer=sendBuffer_;this.numSent=numSent_;this.sendEventAck=sendEventAck_;this.receivedEventId=receivedEventId_;this.ackedEventId=ackedEventId_;this.closeNotify=closeNotify_;this.closed=closed_;this.running=running_;});AW=$pkg.transport=$newType(4,$kindFunc,"ninchat.transport","transport","github.com/ninchat/ninchat-go",null);AX=$pkg.duration=$newType(8,$kindInt64,"ninchat.duration","duration","github.com/ninchat/ninchat-go",null);AY=$pkg.timer=$newType(0,$kindStruct,"ninchat.timer","timer","github.com/ninchat/ninchat-go",function(C_,id_){this.$val=this;if(arguments.length===0){this.C=BX.nil;this.id=null;return;}this.C=C_;this.id=id_;});BB=$pkg.webSocket=$newType(0,$kindStruct,"ninchat.webSocket","webSocket","github.com/ninchat/ninchat-go",function(notify_,goingAway_,err_,impl_,open_,buf_){this.$val=this;if(arguments.length===0){this.notify=BX.nil;this.goingAway=false;this.err=$ifaceNil;this.impl=null;this.open=false;this.buf=CC.nil;return;}this.notify=notify_;this.goingAway=goingAway_;this.err=err_;this.impl=impl_;this.open=open_;this.buf=buf_;});BH=$sliceType($String);BI=$sliceType($emptyInterface);BJ=$mapType($String,$emptyInterface);BK=$sliceType(H);BL=$ptrType(G);BM=$sliceType(BL);BN=$ptrType(BI);BO=$ptrType(BJ);BP=$sliceType($Uint8);BQ=$ptrType(AA);BR=$chanType(AD,false,false);BS=$funcType([],[],false);BT=$ptrType(B.Object);BU=$ptrType($Bool);BV=$chanType(AD,false,true);BW=$structType([]);BX=$chanType(BW,false,false);BY=$ptrType(F);BZ=$sliceType(BY);CA=$ptrType(AY);CB=$ptrType(BB);CC=$sliceType(BT);CD=$funcType([BT],[],false);CE=$funcType([BL],[],false);CF=$ptrType(J);CG=$ptrType(M);CH=$ptrType(AV);CI=$funcType([$String],[],false);CJ=$funcType([BI],[],true);D=function(a){var $ptr,a;if(a===""){return"api.ninchat.com";}else{return a;}};E=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n;b=BH.nil;c=$ifaceNil;e=(d=a[$String.keyFor("hosts")],d!==undefined?d.v:$ifaceNil);if($interfaceIsEqual(e,$ifaceNil)){c=A.New("invalid endpoint document");return[b,c];}f=$assertType(e,BI,true);g=f[0];h=f[1];if(!h){c=A.New("invalid endpoint hosts type");return[b,c];}if(g.$length===0){c=A.New("no endpoint hosts");return[b,c];}i=g;j=0;while(true){if(!(j<i.$length)){break;}k=((j<0||j>=i.$length)?$throwRuntimeError("index out of range"):i.$array[i.$offset+j]);l=$assertType(k,$String,true);m=l[0];n=l[1];if(n){b=$append(b,m);}else{c=A.New("invalid endpoint host value type");}j++;}if(b.$length>0){c=$ifaceNil;}return[b,c];};F.ptr.prototype.String=function(){var $ptr,a,b,c,d,e,f,g;a="";b=this;c=(d=b.Params[$String.keyFor("action")],d!==undefined?[d.v,true]:[$ifaceNil,false]);e=c[0];f=c[1];if(f){g=$assertType(e,$String,true);a=g[0];}return a;};F.prototype.String=function(){return this.$val.String();};G.ptr.prototype.Bool=function(a){var $ptr,a,b,c,d,e,f;b=false;c=this;e=(d=c.Params[$String.keyFor(a)],d!==undefined?d.v:$ifaceNil);if(!($interfaceIsEqual(e,$ifaceNil))){f=$assertType(e,$Bool,true);b=f[0];}return b;};G.prototype.Bool=function(a){return this.$val.Bool(a);};G.ptr.prototype.Int=function(a){var $ptr,a,b,c,d,e,f,g,h;b=0;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=0;h=$assertType(f,$Float64,true);g=h[0];c=h[1];if(c){b=(g>>0);}}return[b,c];};G.prototype.Int=function(a){return this.$val.Int(a);};G.ptr.prototype.Int64=function(a){var $ptr,a,b,c,d,e,f,g,h;b=new $Int64(0,0);c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=0;h=$assertType(f,$Float64,true);g=h[0];c=h[1];if(c){b=new $Int64(0,g);}}return[b,c];};G.prototype.Int64=function(a){return this.$val.Int64(a);};G.ptr.prototype.Float64=function(a){var $ptr,a,b,c,d,e,f,g;b=0;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,$Float64,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Float64=function(a){return this.$val.Float64(a);};G.ptr.prototype.Str=function(a){var $ptr,a,b,c,d,e,f,g;b="";c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,$String,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Str=function(a){return this.$val.Str(a);};G.ptr.prototype.Array=function(a){var $ptr,a,b,c,d,e,f,g;b=BI.nil;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,BI,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Array=function(a){return this.$val.Array(a);};G.ptr.prototype.Map=function(a){var $ptr,a,b,c,d,e,f,g;b=false;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,BJ,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Map=function(a){return this.$val.Map(a);};G.ptr.prototype.String=function(){var $ptr,a,b,c;a="";b=this;c=b.Str("event");a=c[0];return a;};G.prototype.String=function(){return this.$val.String();};G.ptr.prototype.initLastReply=function(a){var $ptr,a,b,c,d,e,f;b=this;c=b.Int("history_length");d=c[0];if(d>0){return;}if(a.String()==="search"){if(!($interfaceIsEqual((e=b.Params[$String.keyFor("users")],e!==undefined?e.v:$ifaceNil),$ifaceNil))||!($interfaceIsEqual((f=b.Params[$String.keyFor("channels")],f!==undefined?f.v:$ifaceNil),$ifaceNil))){return;}}b.LastReply=true;};G.prototype.initLastReply=function(a){return this.$val.initLastReply(a);};G.ptr.prototype.getError=function(){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m;a="";b="";c=false;d=$ifaceNil;e=this;f=(g=e.Params[$String.keyFor("event")],g!==undefined?[g.v,true]:[$ifaceNil,false]);h=f[0];i=f[1];if(!i||!($assertType(h,$String)==="error")){return[a,b,c,d];}a=$assertType((j=e.Params[$String.keyFor("error_type")],j!==undefined?j.v:$ifaceNil),$String);l=(k=e.Params[$String.keyFor("error_reason")],k!==undefined?k.v:$ifaceNil);if(!($interfaceIsEqual(l,$ifaceNil))){b=$assertType(l,$String);}m=a;if(m==="session_not_found"){c=true;if(!(b==="")){d=A.New("error: "+a+" ("+b+")");}else{d=A.New("error: "+a);}}else if(m==="connection_superseded"||m==="message_has_too_many_parts"||m==="message_part_too_long"||m==="message_too_long"||m==="request_malformed"){if(!(b==="")){d=A.New("error: "+a+" ("+b+")");}else{d=A.New("error: "+a);}}return[a,b,c,d];};G.prototype.getError=function(){return this.$val.getError();};I=function(a){var $ptr,a;return new BK([a]);};J.ptr.prototype.success=function(){var $ptr,a;a=this;a.lastSlot=0;};J.prototype.success=function(){return this.$val.success();};J.ptr.prototype.failure=function(a){var $ptr,a,b,c;b=new AX(0,0);c=this;if(c.lastSlot>0){b=new AX(0,AG($flatten64(a)*c.lastSlot/1024,-0.5));}if(c.lastSlot<1023){c.lastSlot=((((c.lastSlot+1>>0))<<1>>0))-1>>0;}return b;};J.prototype.failure=function(a){return this.$val.failure(a);};M.ptr.prototype.Call=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=[b];c=[c];d=BM.nil;e=$ifaceNil;f=this;g="https://"+D(f.Address)+"/v2/call";h=T(g,a.Params);i=h[0];e=h[1];if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}new Z(i.Header).Set("Accept","application/json");new Z(i.Header).Set("Content-Type","application/json");j=AH(new AX(0,11000),0.1);l=AE(i,j);$s=1;case 1:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;m=k[0];e=k[1];if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}b[0]=BI.nil;if(!($interfaceIsEqual(AK(m,(b.$ptr||(b.$ptr=new BN(function(){return this.$target[0];},function($v){this.$target[0]=$v;},b)))),$ifaceNil))){c[0]=false;e=AL(m,(c.$ptr||(c.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}b[0]=new BI([new BJ(c[0])]);}d=$makeSlice(BM,0,b[0].$length);n=b[0];o=0;case 2:if(!(o<n.$length)){$s=3;continue;}p=o;q=((o<0||o>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+o]);r=$assertType(q,BJ,true);s=r[0];t=r[1];if(!t){e=A.New("response event header is not an object");return[d,e];}u=new G.ptr(s,BK.nil,p===(b[0].$length-1>>0));if(!(a.OnReply===$throwNilPointerError)){$s=4;continue;}$s=5;continue;case 4:$r=a.OnReply(u);$s=6;case 6:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 5:d=$append(d,u);o++;$s=2;continue;case 3:return[d,e];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:M.ptr.prototype.Call};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};M.prototype.Call=function(a){return this.$val.Call(a);};N=function(){var $ptr;return new($global.String)();};O=function(a){var $ptr,a;return $parseInt(a.length);};P=function(a){var $ptr,a;return R(a);};R=function(a){var $ptr,a,b,c,d,e,f;b=$assertType($internalize(a,$emptyInterface),$String,true);c=b[1];if(c){return a;}d=new($global.Uint8Array)(a);e=$assertType($internalize(d,$emptyInterface),BP);f=$bytesToString(e);return new($global.String)($externalize(f,$String));};$pkg.StringifyFrame=R;S=function(a){var $ptr,a,b,c,d,e,f;b=$ifaceNil;if(!($interfaceIsEqual(a,$ifaceNil))){c=a;if($assertType(c,$error,true)[1]){d=c;b=d;}else if($assertType(c,$String,true)[1]){e=c.$val;b=A.New(e);}else{f=c;b=A.New("?");}}return b;};T=function(a,b){var $ptr,a,b,c,d,e,f,g;c=BQ.nil;d=$ifaceNil;e=AJ(b);f=e[0];d=e[1];if(!($interfaceIsEqual(d,$ifaceNil))){return[c,d];}g=AC("POST",a,f);c=g[0];d=g[1];return[c,d];};U=function(a,b,c){var $ptr,a,b,c,d,e,f,g,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=new BR(1);e=T(a,b);f=e[0];g=e[1];if($interfaceIsEqual(g,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=AF(f,c,d);$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=3;continue;case 2:$r=$send(d,new AD.ptr(null,g));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:return d;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:U};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.$s=$s;$f.$r=$r;return $f;};V=function(a,b){var $ptr,a,b,c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=new BR(1);$r=AF(a,b,c);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return c;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:V};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.$s=$s;$f.$r=$r;return $f;};Y=function(){var $ptr;W=$global.XDomainRequest;if(W===undefined){W=$global.XMLHttpRequest;X=true;}};Z.prototype.Set=function(a,b){var $ptr,a,b,c,d;c=this.$val;d=a;(c||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(d)]={k:d,v:b};};$ptrType(Z).prototype.Set=function(a,b){return new Z(this.$get()).Set(a,b);};AB=function(a){var $ptr,a,b,c;b=BQ.nil;c=$ifaceNil;b=new AA.ptr("GET",a,new $Map(),null);return[b,c];};AC=function(a,b,c){var $ptr,a,b,c,d,e;d=BQ.nil;e=$ifaceNil;d=new AA.ptr(a,b,new $Map(),c);return[d,e];};AE=function(a,b){var $ptr,a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=V(a,b);$s=1;case 1:if($c){$c=false;c=c.$blk();}if(c&&c.$blk!==undefined){break s;}d=$recv(c);$s=2;case 2:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=$clone(d[0],AD);return[e.data,e.err];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AE};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AF=function(a,b,c){var $ptr,a,b,c,d,e,f,g,h,i,j,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=[d];$deferred.push([(function(c,d){return function $b(){var $ptr,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=S($recover());if(!($interfaceIsEqual(e,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=$send(c[0],new AD.ptr(null,e));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]]);d[0]=new(W)();d[0].onload=$externalize((function(c,d){return function(){var $ptr,e;e=d[0].responseText;$go((function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],new AD.ptr(e,$ifaceNil));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]);};})(c,d),BS);d[0].onprogress=$externalize((function(c,d){return function(){var $ptr;};})(c,d),BS);d[0].ontimeout=$externalize((function(c,d){return function(){var $ptr;$go((function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],new AD.ptr(null,A.New("timeout")));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]);};})(c,d),BS);d[0].onerror=$externalize((function(c,d){return function(){var $ptr;$go((function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],new AD.ptr(null,A.New("error")));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]);};})(c,d),BS);d[0].open($externalize(a.Method,$String),$externalize(a.URL,$String));d[0].timeout=$externalize(b,AX);if(X){e=a.Header;f=0;g=$keys(e);while(true){if(!(f<g.length)){break;}h=e[g[f]];if(h===undefined){f++;continue;}i=h.k;j=h.v;d[0].setRequestHeader($externalize(i,$String),$externalize(j,$String));f++;}}d[0].send(a.data);$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:AF};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};AG=function(a,b){var $ptr,a,b;return a+a*b*AT();};AH=function(a,b){var $ptr,a,b;return new AX(0,AG($flatten64(a),b));};AI=function(a,b){var $ptr,a,b;return new $Int64(0,AG($flatten64(a),b));};AJ=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=S($recover());}),[]]);b=$global.JSON.stringify($externalize(a,BJ));return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};AK=function(a,b){var $ptr,a,b,c,d,e,f,g,h;c=$ifaceNil;d=AM(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return c;}f=$assertType(e,BI,true);g=f[0];h=f[1];if(!h){c=A.New("json: cannot unmarshal value into Go value of type *[]interface{}");return c;}b.$set(g);return c;};AL=function(a,b){var $ptr,a,b,c,d,e,f,g,h;c=$ifaceNil;d=AM(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return c;}f=$assertType(e,BJ,true);g=f[0];h=f[1];if(!h){c=A.New("json: cannot unmarshal value into Go value of type *map[string]interface{}");return c;}b.$set(g);return c;};AM=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=S($recover());}),[]]);b=$internalize($global.JSON.parse(a),$emptyInterface);return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};AN=function(a){var $ptr,a,b,c,d,e,f;b=BI.nil;c=a.Payload;d=0;while(true){if(!(d<c.$length)){break;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);f=$pointerOfStructConversion(e,BT).split($externalize(",",$String))[1];b=$append(b,new $jsObjectPtr(f));d++;}return b;};AO=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=[c];d=[d];e=[e];d[0]=false;e[0]=false;f="https://"+b+"/v2/poll";if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BI([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}g=a.makeCreateSessionAction();h=AH(new AX(0,13000),0.2);i=U(f,g,h);$s=5;case 5:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}k=$select([[i],[a.closeNotify]]);$s=6;case 6:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}j=k;if(j[0]===0){$s=7;continue;}if(j[0]===1){$s=8;continue;}$s=9;continue;case 7:l=$clone(j[1][0],AD);if(!($interfaceIsEqual(l.err,$ifaceNil))){$s=10;continue;}$s=11;continue;case 10:$r=a.log(new BI([new $String("session creation:"),l.err]));$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];case 11:c[0]=BI.nil;m=AK(l.data,(c.$ptr||(c.$ptr=new BN(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if(!($interfaceIsEqual(m,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BI([new $String("session creation response:"),m]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];case 14:if(c[0].$length===0){$s=16;continue;}$s=17;continue;case 16:$r=a.log(new BI([new $String("session creation response JSON array is empty")]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];case 17:n=$assertType((0>=c[0].$length?$throwRuntimeError("index out of range"):c[0].$array[c[0].$offset+0]),BJ,true);o=n[0];p=n[1];if(!p){$s=19;continue;}$s=20;continue;case 19:$r=a.log(new BI([new $String("session creation response header is not a JSON object")]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];case 20:q=a.handleSessionEvent(o);$s=24;case 24:if($c){$c=false;q=q.$blk();}if(q&&q.$blk!==undefined){break s;}if(!q){$s=22;continue;}$s=23;continue;case 22:return[d[0],e[0]];case 23:$s=9;continue;case 8:$r=AR(a,f);$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];case 9:d[0]=true;e[0]=true;$r=a.connState("connected");$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a.connActive();$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=3;continue;case 2:$r=a.log(new BI([new $String("session resumption")]));$s=28;case 28:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=AQ(a,f);$s=29;case 29:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:$r=AP(a,f,(d.$ptr||(d.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},d))),(e.$ptr||(e.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},e))));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],e[0]];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AO};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$r=$r;return $f;};AP=function(a,b,c,d){var $ptr,a,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;af=$f.af;ag=$f.ag;ah=$f.ah;ai=$f.ai;aj=$f.aj;ak=$f.ak;al=$f.al;am=$f.am;an=$f.an;ao=$f.ao;ap=$f.ap;aq=$f.aq;ar=$f.ar;as=$f.as;at=$f.at;au=$f.au;av=$f.av;aw=$f.aw;ax=$f.ax;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=BV.nil;f=BV.nil;g=new $Int64(0,0);h=0;a.numSent=0;case 1:if(!(h<2)){$s=2;continue;}i=[i];j=[j];if(e===BV.nil){$s=3;continue;}$s=4;continue;case 3:k=a.makeResumeSessionAction(true);l=AH(new AX(0,64000),0.2);m=U(b,k,l);$s=5;case 5:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}e=m;case 4:if(f===BV.nil&&a.numSent<a.sendBuffer.$length){$s=6;continue;}$s=7;continue;case 6:p=(n=a.sendBuffer,o=a.numSent,((o<0||o>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+o]));if(!(p.Payload===BK.nil)){$s=8;continue;}$s=9;continue;case 8:if(p.String()==="update_user"){$s=10;continue;}$s=11;continue;case 10:q="payload";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(q)]={k:q,v:AN(p)};$s=12;continue;case 11:j[0]=false;s=AL((r=p.Payload,(0>=r.$length?$throwRuntimeError("index out of range"):r.$array[r.$offset+0])),(j.$ptr||(j.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},j))));if(!($interfaceIsEqual(s,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BI([new $String("send:"),s]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 14:t="payload";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(t)]={k:t,v:new BJ(j[0])};case 12:case 9:u="session_id";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(u)]={k:u,v:a.sessionId};v=AH(new AX(0,7000),0.2);w=U(b,p.Params,v);$s=16;case 16:if($c){$c=false;w=w.$blk();}if(w&&w.$blk!==undefined){break s;}x=w;delete p.Params[$String.keyFor("session_id")];delete p.Params[$String.keyFor("payload")];if((y=p.id,(y.$high===0&&y.$low===0))){$go(AS,[a,x,"send error:"]);a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{f=x;g=p.id;}case 7:z=new AD.ptr(null,$ifaceNil);ab=$select([[e],[f],[a.sendNotify],[a.closeNotify]]);$s=17;case 17:if($c){$c=false;ab=ab.$blk();}if(ab&&ab.$blk!==undefined){break s;}aa=ab;if(aa[0]===0){$s=18;continue;}if(aa[0]===1){$s=19;continue;}if(aa[0]===2){$s=20;continue;}if(aa[0]===3){$s=21;continue;}$s=22;continue;case 18:$copy(z,aa[1][0],AD);if(!($interfaceIsEqual(z.err,$ifaceNil))){$s=23;continue;}$s=24;continue;case 23:$r=a.log(new BI([new $String("poll error:"),z.err]));$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 24:e=BV.nil;$r=a.connActive();$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=22;continue;case 19:$copy(z,aa[1][0],AD);if(!($interfaceIsEqual(z.err,$ifaceNil))){$s=27;continue;}if((g.$high>0||(g.$high===0&&g.$low>0))){$s=28;continue;}$s=29;continue;case 27:$r=a.log(new BI([new $String("send error:"),z.err]));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=29;continue;case 28:a.numSent=a.numSent+(1)>>0;case 29:f=BV.nil;g=new $Int64(0,0);$s=22;continue;case 20:ac=aa[1];ad=ac[1];if(!ad){$s=31;continue;}$s=32;continue;case 31:$r=AR(a,b);$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 32:$s=1;continue;$s=22;continue;case 21:$r=AR(a,b);$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 22:i[0]=BI.nil;ae=z.err;if($interfaceIsEqual(ae,$ifaceNil)){$s=35;continue;}$s=36;continue;case 35:ae=AK(z.data,(i.$ptr||(i.$ptr=new BN(function(){return this.$target[0];},function($v){this.$target[0]=$v;},i))));if(!($interfaceIsEqual(ae,$ifaceNil))){$s=37;continue;}$s=38;continue;case 37:$r=a.log(new BI([new $String("response:"),ae]));$s=39;case 39:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 38:case 36:if(!($interfaceIsEqual(ae,$ifaceNil))){$s=40;continue;}$s=41;continue;case 40:h=h+(1)>>0;a.numSent=0;$s=1;continue;case 41:h=0;c.$set(true);af=i[0];ag=0;case 42:if(!(ag<af.$length)){$s=43;continue;}ah=((ag<0||ag>=af.$length)?$throwRuntimeError("index out of range"):af.$array[af.$offset+ag]);ai=$assertType(ah,BJ,true);aj=ai[0];ak=ai[1];if(!ak){$s=44;continue;}$s=45;continue;case 44:$r=a.log(new BI([new $String("poll event is not an object")]));$s=46;case 46:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 45:al=new G.ptr(aj,BK.nil,false);an=(am=aj[$String.keyFor("payload")],am!==undefined?am.v:$ifaceNil);if(!($interfaceIsEqual(an,$ifaceNil))){$s=47;continue;}$s=48;continue;case 47:ao=$assertType(an,BJ,true);ap=ao[0];aq=ao[1];if(!aq){$s=49;continue;}$s=50;continue;case 49:$r=a.log(new BI([new $String("poll payload is not an object")]));$s=51;case 51:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 50:ar=AJ(ap);as=ar[0];at=ar[1];if(!($interfaceIsEqual(at,$ifaceNil))){$s=52;continue;}$s=53;continue;case 52:$r=a.log(new BI([new $String("poll payload:"),at]));$s=54;case 54:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 53:al.Payload=I(as);case 48:av=a.handleEvent(al);$s=55;case 55:if($c){$c=false;av=av.$blk();}if(av&&av.$blk!==undefined){break s;}au=av;aw=au[0];ax=au[1];ak=au[3];if((g.$high>0||(g.$high===0&&g.$low>0))&&(g.$high<aw.$high||(g.$high===aw.$high&&g.$low<=aw.$low))){g=new $Int64(0,0);a.numSent=a.numSent+(1)>>0;}if(!ak){if(ax){d.$set(true);}return;}if(!d.$get()){$s=56;continue;}$s=57;continue;case 56:d.$set(true);$r=a.connState("connected");$s=58;case 58:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 57:ag++;$s=42;continue;case 43:$s=1;continue;case 2:return;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP};}$f.$ptr=$ptr;$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.af=af;$f.ag=ag;$f.ah=ah;$f.ai=ai;$f.aj=aj;$f.ak=ak;$f.al=al;$f.am=am;$f.an=an;$f.ao=ao;$f.ap=ap;$f.aq=aq;$f.ar=ar;$f.as=as;$f.at=at;$f.au=au;$f.av=av;$f.aw=aw;$f.ax=ax;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$r=$r;return $f;};AQ=function(a,b){var $ptr,a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=$makeMap($String.keyFor,[{k:"action",v:new $String("ping")},{k:"session_id",v:a.sessionId}]);d=U(b,c,AH(new AX(0,7000),0.9));$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;$go(AS,[a,e,"ping error:"]);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AQ};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AR=function(a,b){var $ptr,a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=$makeMap($String.keyFor,[{k:"action",v:new $String("close_session")},{k:"session_id",v:a.sessionId}]);d=U(b,c,AH(new AX(0,7000),0.9));$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;$go(AS,[a,e,"send error:"]);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AR};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AS=function(a,b,c){var $ptr,a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=$recv(b);$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=$clone(d[0],AD);if(!($interfaceIsEqual(e.err,$ifaceNil))){$s=2;continue;}$s=3;continue;case 2:$r=a.log(new BI([new $String(c),e.err]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AS};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AT=function(){var $ptr;return $parseFloat($global.Math.random());};AV.ptr.prototype.SetParams=function(a){var $ptr,a,b,c,d,e,f,g;b=this;if($interfaceIsEqual((c=a[$String.keyFor("message_types")],c!==undefined?c.v:$ifaceNil),$ifaceNil)){$panic(new $String("message_types parameter not defined"));}d=(e=a[$String.keyFor("session_id")],e!==undefined?[e.v,true]:[$ifaceNil,false]);f=d[0];g=d[1];if(!($interfaceIsEqual(f,$ifaceNil))){b.sessionId=f;}else if(g){delete a[$String.keyFor("session_id")];}b.sessionParams=a;if(!(b.sendNotify===BX.nil)&&!b.running){b.running=true;$go($methodVal(b,"discover"),[]);}};AV.prototype.SetParams=function(a){return this.$val.SetParams(a);};AV.ptr.prototype.SetTransport=function(a){var $ptr,a,b,c;b=this;if(a===""){b.forceLongPoll=false;return;}c=a;if(c==="websocket"){$panic(new $String("websocket transport cannot be forced"));}else if(c==="longpoll"){b.forceLongPoll=true;}else{$panic(new $String("unknown transport: "+a));}};AV.prototype.SetTransport=function(a){return this.$val.SetTransport(a);};AV.ptr.prototype.Open=function(){var $ptr,a;a=this;if(a.closed){$panic(new $String("session already closed"));}if(!(a.sendNotify===BX.nil)){$panic(new $String("session already initialized"));}if(a.OnSessionEvent===$throwNilPointerError){$panic(new $String("onSessionEvent callback not defined"));}if(a.OnEvent===$throwNilPointerError){$panic(new $String("onEvent callback not defined"));}if(a.sessionParams===false){$panic(new $String("session parameters not defined"));}a.sendNotify=new BX(1);a.closeNotify=new BX(1);a.running=true;$go($methodVal(a,"discover"),[]);};AV.prototype.Open=function(){return this.$val.Open();};AV.ptr.prototype.Close=function(){var $ptr,a,b,c,d,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=[a];a[0]=this;if(a[0].closed){return;}b=a[0].sendBuffer;c=0;case 1:if(!(c<b.$length)){$s=2;continue;}d=((c<0||c>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+c]);if(!(d.OnReply===$throwNilPointerError)){$s=3;continue;}$s=4;continue;case 3:$r=d.OnReply(BL.nil);$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 4:c++;$s=1;continue;case 2:a[0].sendBuffer=BZ.nil;a[0].numSent=0;a[0].closed=true;a[0].running=false;$go((function(a){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(a[0].closeNotify,new BW.ptr());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$close(a[0].sendNotify);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(a),[]);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.Close};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.Close=function(){return this.$val.Close();};AV.ptr.prototype.Send=function(a){var $ptr,a,b,c,d,e,f,g,h,i;b=this;if(b.sendNotify===BX.nil){$panic(new $String("session not initialized"));}if(b.closed){$panic(new $String("session already closed"));}if(a.Payload.$length===0){a.Payload=BK.nil;}c=(d=a.Params[$String.keyFor("action_id")],d!==undefined?[d.v,true]:[$ifaceNil,false]);e=c[0];f=c[1];if(f&&$interfaceIsEqual(e,$ifaceNil)){delete a.Params[$String.keyFor("action_id")];}else{b.lastActionId=(g=b.lastActionId,h=new $Int64(0,1),new $Int64(g.$high+h.$high,g.$low+h.$low));a.id=b.lastActionId;i="action_id";(a.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(i)]={k:i,v:a.id};}b.send(a);return;};AV.prototype.Send=function(a){return this.$val.Send(a);};AV.ptr.prototype.send=function(a){var $ptr,a,b;b=this;b.sendBuffer=$append(b.sendBuffer,a);$go((function $b(){var $ptr,c,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;$r=$f.$r;}c=$select([[b.sendNotify,new BW.ptr()],[]]);if(c[0]===0){}else if(c[0]===1){}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.$r=$r;return $f;}),[]);return;};AV.prototype.send=function(a){return this.$val.send(a);};AV.ptr.prototype.sendAck=function(){var $ptr,a;a=this;a.sendEventAck=true;$go((function $b(){var $ptr,b,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;b=$f.b;$r=$f.$r;}b=$select([[a.sendNotify,new BW.ptr()],[]]);if(b[0]===0){}else if(b[0]===1){}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.b=b;$f.$r=$r;return $f;}),[]);};AV.prototype.sendAck=function(){return this.$val.sendAck();};AV.ptr.prototype.discover=function(){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];b=[b];a[0]=this;$r=a[0].log(new BI([new $String("opening")]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$deferred.push([$methodVal(a[0],"log"),[new BI([new $String("closed")])]]);$deferred.push([(function(a,b){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(a[0].closed&&!(a[0].OnClose===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=a[0].OnClose();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(a,b),[]]);$deferred.push([$methodVal(a[0],"connState"),["disconnected"]]);b[0]=new J.ptr(0);case 2:if(!(a[0].running)){$s=3;continue;}c=[c];$r=a[0].log(new BI([new $String("endpoint discovery")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a[0].connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d="https://"+D(a[0].Address)+"/v2/endpoint";e=AB(d);f=e[0];g=e[1];if(!($interfaceIsEqual(g,$ifaceNil))){$panic(g);}h=V(f,AH(new AX(0,7000),0.1));$s=6;case 6:if($c){$c=false;h=h.$blk();}if(h&&h.$blk!==undefined){break s;}j=$select([[h],[a[0].closeNotify]]);$s=7;case 7:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}i=j;if(i[0]===0){$s=8;continue;}if(i[0]===1){$s=9;continue;}$s=10;continue;case 8:k=$clone(i[1][0],AD);l=BH.nil;m=k.err;if($interfaceIsEqual(m,$ifaceNil)){c[0]=false;m=AL(k.data,(c.$ptr||(c.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if($interfaceIsEqual(m,$ifaceNil)){n=E(c[0]);l=n[0];m=n[1];}}if($interfaceIsEqual(m,$ifaceNil)){$s=11;continue;}$s=12;continue;case 11:$r=a[0].log(new BI([new $String("endpoint discovered")]));$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(BA&&!a[0].forceLongPoll){$s=15;continue;}$s=16;continue;case 15:o=a[0].connect(BD,l,b[0]);$s=19;case 19:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}if(o){$s=17;continue;}$s=18;continue;case 17:$s=2;continue;case 18:case 16:p=a[0].connect(AO,l,b[0]);$s=20;case 20:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}p;$s=13;continue;case 12:$r=a[0].log(new BI([new $String("endpoint discovery:"),m]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 13:$s=10;continue;case 9:return;case 10:q=a[0].backOff(b[0]);$s=24;case 24:if($c){$c=false;q=q.$blk();}if(q&&q.$blk!==undefined){break s;}if(!q){$s=22;continue;}$s=23;continue;case 22:return;case 23:$s=2;continue;case 3:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:AV.ptr.prototype.discover};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};AV.prototype.discover=function(){return this.$val.discover();};AV.ptr.prototype.connect=function(a,b,c){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=false;e=this;f=0;case 1:if(!(f<2)){$s=2;continue;}g=b;h=0;case 3:if(!(h<g.$length)){$s=4;continue;}i=((h<0||h>=g.$length)?$throwRuntimeError("index out of range"):g.$array[g.$offset+h]);$r=e.connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}j=e.Address;k=0;while(true){if(!(k<j.length)){break;}l=$decodeRune(j,k);m=k;n=l[0];if(n===47){i=i+(e.Address.substring(m));break;}k+=l[1];}p=a(e,i);$s=6;case 6:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}o=p;q=o[0];r=o[1];if(q){d=true;}if(r){c.success();return d;}if(!e.running){return d;}s=e.backOff(c);$s=9;case 9:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}if(!s){$s=7;continue;}$s=8;continue;case 7:return d;case 8:h++;$s=3;continue;case 4:f=f+(1)>>0;$s=1;continue;case 2:return d;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connect};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connect=function(a,b,c){return this.$val.connect(a,b,c);};AV.ptr.prototype.backOff=function(a){var $ptr,a,b,c,d,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=false;c=this;d=a.failure(new AX(0,60000));if((d.$high===0&&d.$low===0)){b=true;return b;}$r=c.log(new BI([new $String("sleeping")]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=c.connState("disconnected");$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}f=$select([[AZ(d).C],[c.closeNotify]]);$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}e=f;if(e[0]===0){b=true;}else if(e[0]===1){}return b;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.backOff};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.backOff=function(a){return this.$val.backOff(a);};AV.ptr.prototype.canLogin=function(){var $ptr,a,b,c,d,e,f,g,h;a=this;if(!($interfaceIsEqual((b=a.sessionParams[$String.keyFor("access_key")],b!==undefined?b.v:$ifaceNil),$ifaceNil))){return true;}if(!($interfaceIsEqual((c=a.sessionParams[$String.keyFor("user_id")],c!==undefined?c.v:$ifaceNil),$ifaceNil))){return!($interfaceIsEqual((d=a.sessionParams[$String.keyFor("user_auth")],d!==undefined?d.v:$ifaceNil),$ifaceNil))||!($interfaceIsEqual((e=a.sessionParams[$String.keyFor("master_sign")],e!==undefined?e.v:$ifaceNil),$ifaceNil));}return!($interfaceIsEqual((f=a.sessionParams[$String.keyFor("identity_type")],f!==undefined?f.v:$ifaceNil),$ifaceNil))&&!($interfaceIsEqual((g=a.sessionParams[$String.keyFor("identity_name")],g!==undefined?g.v:$ifaceNil),$ifaceNil))&&!($interfaceIsEqual((h=a.sessionParams[$String.keyFor("identity_auth")],h!==undefined?h.v:$ifaceNil),$ifaceNil));};AV.prototype.canLogin=function(){return this.$val.canLogin();};AV.ptr.prototype.makeCreateSessionAction=function(){var $ptr,a,aa,ab,ac,ad,ae,af,ag,ah,ai,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;a=false;b=this;a=$makeMap($String.keyFor,[{k:"action",v:new $String("create_session")}]);d=(c=b.sessionParams[$String.keyFor("user_id")],c!==undefined?c.v:$ifaceNil);if($interfaceIsEqual(d,$ifaceNil)){e=b.sessionParams;f=0;g=$keys(e);while(true){if(!(f<g.length)){break;}h=e[g[f]];if(h===undefined){f++;continue;}i=h.k;j=h.v;k=i;(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(k)]={k:k,v:j};f++;}}else{m=(l=b.sessionParams[$String.keyFor("user_auth")],l!==undefined?l.v:$ifaceNil);if(!($interfaceIsEqual(m,$ifaceNil))){n="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(n)]={k:n,v:d};o="user_auth";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(o)]={k:o,v:m};}else{q=(p=b.sessionParams[$String.keyFor("master_sign")],p!==undefined?p.v:$ifaceNil);if(!($interfaceIsEqual(q,$ifaceNil))){r="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(r)]={k:r,v:d};s="master_sign";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(s)]={k:s,v:q};}else{u=(t=b.sessionParams[$String.keyFor("identity_type")],t!==undefined?t.v:$ifaceNil);if(!($interfaceIsEqual(u,$ifaceNil))){v="identity_type";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(v)]={k:v,v:u};w="identity_name";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(w)]={k:w,v:(x=b.sessionParams[$String.keyFor("identity_name")],x!==undefined?x.v:$ifaceNil)};y="identity_auth";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(y)]={k:y,v:(z=b.sessionParams[$String.keyFor("identity_auth")],z!==undefined?z.v:$ifaceNil)};}else{aa="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(aa)]={k:aa,v:d};}}}ab=b.sessionParams;ac=0;ad=$keys(ab);while(true){if(!(ac<ad.length)){break;}ae=ab[ad[ac]];if(ae===undefined){ac++;continue;}af=ae.k;ag=ae.v;ah=af;if(ah==="user_id"||ah==="user_auth"||ah==="identity_type"||ah==="identity_name"||ah==="identity_auth"||ah==="access_key"||ah==="master_sign"){}else{ai=af;(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(ai)]={k:ai,v:ag};}ac++;}}return a;};AV.prototype.makeCreateSessionAction=function(){return this.$val.makeCreateSessionAction();};AV.ptr.prototype.makeResumeSessionAction=function(a){var $ptr,a,b,c,d;b=false;c=this;b=$makeMap($String.keyFor,[{k:"action",v:new $String("resume_session")},{k:"event_id",v:c.receivedEventId}]);if(a){d="session_id";(b||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(d)]={k:d,v:c.sessionId};}c.sendEventAck=false;c.ackedEventId=c.receivedEventId;return b;};AV.prototype.makeResumeSessionAction=function(a){return this.$val.makeResumeSessionAction(a);};AV.ptr.prototype.handleSessionEvent=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=false;c=this;d=new G.ptr(a,BK.nil,false);e=false;if(d.String()==="error"){c.sessionId=$ifaceNil;c.running=false;e=true;}$r=c.OnSessionEvent(d);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(e){return b;}delete c.sessionParams[$String.keyFor("user_attrs")];delete c.sessionParams[$String.keyFor("user_settings")];delete c.sessionParams[$String.keyFor("identity_attrs")];delete c.sessionParams[$String.keyFor("access_key")];delete c.sessionParams[$String.keyFor("master_sign")];f="user_id";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(f)]={k:f,v:(g=d.Params[$String.keyFor("user_id")],g!==undefined?g.v:$ifaceNil)};i=(h=d.Params[$String.keyFor("user_auth")],h!==undefined?h.v:$ifaceNil);if(!($interfaceIsEqual(i,$ifaceNil))){j="user_auth";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(j)]={k:j,v:i};}k=new BH(["identity_type","identity_name","identity_auth"]);l=0;while(true){if(!(l<k.$length)){break;}m=((l<0||l>=k.$length)?$throwRuntimeError("index out of range"):k.$array[k.$offset+l]);o=(n=c.sessionParams[$String.keyFor(m+"_new")],n!==undefined?n.v:$ifaceNil);if(!($interfaceIsEqual(o,$ifaceNil))){delete c.sessionParams[$String.keyFor(m+"_new")];p=m;(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(p)]={k:p,v:o};}l++;}c.sessionId=(q=d.Params[$String.keyFor("session_id")],q!==undefined?q.v:$ifaceNil);if(c.sendBuffer.$length===0){c.lastActionId=new $Int64(0,0);}c.sendEventAck=false;r=d.Int64("event_id");c.receivedEventId=r[0];c.ackedEventId=new $Int64(0,0);$r=c.log(new BI([new $String("session created")]));$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}b=true;return b;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.handleSessionEvent};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.handleSessionEvent=function(a){return this.$val.handleSessionEvent(a);};AV.ptr.prototype.handleEvent=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=[b];c=[c];c[0]=new $Int64(0,0);d=false;e=false;f=false;b[0]=this;g=a.Int64("event_id");h=g[0];if((h.$high>0||(h.$high===0&&h.$low>0))){b[0].receivedEventId=h;if(!b[0].sendEventAck){if((i=(j=b[0].receivedEventId,k=b[0].ackedEventId,new $Int64(j.$high-k.$high,j.$low-k.$low)),(i.$high>AU.$high||(i.$high===AU.$high&&i.$low>=AU.$low)))){b[0].sendAck();}else{e=true;}}}l=a.Int64("action_id");c[0]=l[0];if((c[0].$high>0||(c[0].$high===0&&c[0].$low>0))){$s=1;continue;}$s=2;continue;case 1:m=C.Search(b[0].numSent,(function(b,c){return function(m){var $ptr,m,n,o,p;o=(n=b[0].sendBuffer,((m<0||m>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+m]));return(p=o.id,(p.$high>c[0].$high||(p.$high===c[0].$high&&p.$low>=c[0].$low)));};})(b,c));$s=3;case 3:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}n=m;if(n<b[0].numSent){$s=4;continue;}$s=5;continue;case 4:p=(o=b[0].sendBuffer,((n<0||n>=o.$length)?$throwRuntimeError("index out of range"):o.$array[o.$offset+n]));if((q=p.id,(q.$high===c[0].$high&&q.$low===c[0].$low))){$s=6;continue;}$s=7;continue;case 6:a.initLastReply(p);if(!(p.OnReply===$throwNilPointerError)){$s=8;continue;}$s=9;continue;case 8:$r=p.OnReply(a);$s=10;case 10:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 9:if(a.LastReply){b[0].sendBuffer=$appendSlice($subslice(b[0].sendBuffer,0,n),$subslice(b[0].sendBuffer,(n+1>>0)));b[0].numSent=b[0].numSent-(1)>>0;}case 7:case 5:case 2:r=a.getError();s=r[0];t=r[1];d=r[2];u=r[3];if(!($interfaceIsEqual(u,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=b[0].log(new BI([new $String("event:"),u]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(d){$s=14;continue;}$s=15;continue;case 14:b[0].sessionId=$ifaceNil;if(!b[0].canLogin()){$s=16;continue;}$s=17;continue;case 16:b[0].running=false;$r=b[0].OnSessionEvent(a);$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 17:case 15:return[c[0],d,e,f];case 12:if(s==="deprecated"){$s=19;continue;}$s=20;continue;case 19:$r=b[0].log(new BI([new $String("deprecated:"),new $String(t)]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 20:$r=b[0].OnEvent(a);$s=22;case 22:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}f=true;return[c[0],d,e,f];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.handleEvent};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.handleEvent=function(a){return this.$val.handleEvent(a);};AV.ptr.prototype.connState=function(a){var $ptr,a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(b.latestConnState===a)){$s=1;continue;}$s=2;continue;case 1:b.latestConnState=a;if(!(b.OnConnState===$throwNilPointerError)){$s=3;continue;}$s=4;continue;case 3:$r=b.OnConnState(b.latestConnState);$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 4:case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connState};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connState=function(a){return this.$val.connState(a);};AV.ptr.prototype.connActive=function(){var $ptr,a,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=this;if(!(a.OnConnActive===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=a.OnConnActive();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connActive};}$f.$ptr=$ptr;$f.a=a;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connActive=function(){return this.$val.connActive();};AV.ptr.prototype.log=function(a){var $ptr,a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(b.OnLog===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=b.OnLog(a);$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.log};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.log=function(a){return this.$val.log(a);};AZ=function(a){var $ptr,a,b;b=CA.nil;b=new AY.ptr(new BX(0),null);if((a.$high>0||(a.$high===0&&a.$low>=0))){b.Reset(a);}return b;};AY.ptr.prototype.Active=function(){var $ptr,a;a=this;return!(a.id===null);};AY.prototype.Active=function(){return this.$val.Active();};AY.ptr.prototype.Reset=function(a){var $ptr,a,b;b=this;b.Stop();b.id=$global.setTimeout($externalize((function(){var $ptr;b.id=null;$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(b.C,new BW.ptr());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);}),BS),$externalize(a,AX));};AY.prototype.Reset=function(a){return this.$val.Reset(a);};AY.ptr.prototype.Stop=function(){var $ptr,a;a=this;if(!(a.id===null)){$global.clearTimeout(a.id);a.id=null;}};AY.prototype.Stop=function(){return this.$val.Stop();};BC=function(a,b){var $ptr,a,b,c,d,e,f,g;c=CB.nil;c=new BB.ptr(new BX(1),false,$ifaceNil,new($global.WebSocket)($externalize(a,$String)),false,CC.nil);c.impl.binaryType=$externalize("arraybuffer",$String);d=false;e=(function(){var $ptr;if(!d){d=true;$go((function(){var $ptr;$close(c.notify);}),[]);}});f=$global.setTimeout($externalize((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c.err=A.New("timeout");$r=e();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),BS),$externalize(b,AX));g=(function(){var $ptr;if(!(f===null)){$global.clearTimeout(f);f=null;}});c.impl.onopen=$externalize((function $b(h){var $ptr,h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=g();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(!($interfaceIsEqual(c.err,$ifaceNil))){c.impl.close();return;}c.open=true;$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(!d){$s=1;continue;}$s=2;continue;case 1:$r=$send(c.notify,new BW.ptr());$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CD);c.impl.onmessage=$externalize((function(h){var $ptr,h;c.buf=$append(c.buf,h.data);$go((function $b(){var $ptr,i,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;i=$f.i;$r=$f.$r;}if(!d){i=$select([[c.notify,new BW.ptr()],[]]);if(i[0]===0){}else if(i[0]===1){}}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.i=i;$f.$r=$r;return $f;}),[]);}),CD);c.impl.onclose=$externalize((function $b(h){var $ptr,h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c.goingAway=(($parseInt(h.code)>>0)===1001);c.open=false;$r=e();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CD);c.impl.onerror=$externalize((function $b(h){var $ptr,h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=g();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if($interfaceIsEqual(c.err,$ifaceNil)){c.err=A.New($internalize(h.message,$String));}$r=e();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CD);return c;};BB.ptr.prototype.send=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=this;$deferred.push([(function(){var $ptr;b=S($recover());}),[]]);c.impl.send(a);return b;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return b;}}};BB.prototype.send=function(a){return this.$val.send(a);};BB.ptr.prototype.sendJSON=function(a){var $ptr,a,b,c,d,e;b=$ifaceNil;c=this;d=AJ(a);e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))){return b;}b=c.send(e);return b;};BB.prototype.sendJSON=function(a){return this.$val.sendJSON(a);};BB.ptr.prototype.sendPayload=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=this;$deferred.push([(function(){var $ptr;b=S($recover());}),[]]);d=a.String()==="update_user";e=a.Payload;f=0;while(true){if(!(f<e.$length)){break;}g=((f<0||f>=e.$length)?$throwRuntimeError("index out of range"):e.$array[e.$offset+f]);h=g;if(d){i=h.split($externalize(",",$String))[1];j=$global.atob(i);k=$parseInt(j.length);h=new($global.ArrayBuffer)(k);l=new($global.Uint8Array)(h);m=0;while(true){if(!(m<k)){break;}l[m]=j.charCodeAt(m);m=m+(1)>>0;}}c.impl.send(h);f++;}return b;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return b;}}};BB.prototype.sendPayload=function(a){return this.$val.sendPayload(a);};BB.ptr.prototype.receive=function(){var $ptr,a,b,c;a=null;b=this;if(b.buf.$length>0){a=(c=b.buf,(0>=c.$length?$throwRuntimeError("index out of range"):c.$array[c.$offset+0]));b.buf=$subslice(b.buf,1);}return a;};BB.prototype.receive=function(){return this.$val.receive();};BB.ptr.prototype.receiveJSON=function(){var $ptr,a,b,c,d,e;a=false;b=$ifaceNil;c=this;d=c.receive();if(d===null){return[a,b];}b=AL(P(d),(e||(e=new BO(function(){return a;},function($v){a=$v;}))));return[a,b];};BB.prototype.receiveJSON=function(){return this.$val.receiveJSON();};BB.ptr.prototype.close=function(){var $ptr,a,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=this;$deferred.push([(function(){var $ptr;$recover();}),[]]);a.impl.close();}catch(err){$err=err;}finally{$callDeferred($deferred,$err);}};BB.prototype.close=function(){return this.$val.close();};BD=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=false;e=false;c[0]=CB.nil;$deferred.push([(function(c){return function(){var $ptr;if(!(c[0]===CB.nil)){c[0].close();}};})(c),[]]);case 1:e=false;f=false;$r=a.log(new BI([new $String("connecting to"),new $String(b)]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}c[0]=BC("wss://"+b+"/v2/socket",AH(new AX(0,9000),0.1));h=$select([[c[0].notify],[a.closeNotify]]);$s=4;case 4:if($c){$c=false;h=h.$blk();}if(h&&h.$blk!==undefined){break s;}g=h;if(g[0]===0){$s=5;continue;}if(g[0]===1){$s=6;continue;}$s=7;continue;case 5:i=g[1];j=i[1];if(j){$s=8;continue;}$s=9;continue;case 8:$r=a.log(new BI([new $String("connected")]));$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a.connState("connected");$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d=true;l=BE(a,c[0]);$s=13;case 13:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;e=k[0];f=k[1];$s=10;continue;case 9:$r=a.log(new BI([new $String("connection failed:"),c[0].err]));$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 10:$s=7;continue;case 6:case 7:m=c[0].goingAway;c[0].close();c[0]=CB.nil;if(m){$s=15;continue;}$s=16;continue;case 15:$r=a.log(new BI([new $String("disconnected (server is going away)")]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=17;continue;case 16:$r=a.log(new BI([new $String("disconnected")]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 17:if(!e||!f||!a.running||m){return[d,e];}$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BD};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BE=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=false;d=false;e=false;if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BI([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeCreateSessionAction();$s=3;continue;case 2:$r=a.log(new BI([new $String("session resumption")]));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeResumeSessionAction(true);case 3:f=b.sendJSON(e);if(!($interfaceIsEqual(f,$ifaceNil))){$s=6;continue;}$s=7;continue;case 6:$r=a.log(new BI([new $String("send:"),f]));$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 7:if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=9;continue;}$s=10;continue;case 9:g=false;h=true;i=AZ(AH(new AX(0,13000),0.2));case 11:j=$ifaceNil;k=b.receiveJSON();g=k[0];j=k[1];if(!($interfaceIsEqual(j,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BI([new $String("session creation:"),j]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c,d];case 14:if(!(g===false)){i.Stop();$s=12;continue;}if(!h){$s=16;continue;}$s=17;continue;case 16:$r=a.log(new BI([new $String("disconnected during session creation:"),b.err]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}i.Stop();return[c,d];case 17:m=$select([[b.notify],[i.C]]);$s=19;case 19:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}l=m;if(l[0]===0){$s=20;continue;}if(l[0]===1){$s=21;continue;}$s=22;continue;case 20:n=l[1];h=n[1];$s=22;continue;case 21:$r=a.log(new BI([new $String("session creation timeout")]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c,d];case 22:$s=11;continue;case 12:o=a.handleSessionEvent(g);$s=26;case 26:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}if(!o){$s=24;continue;}$s=25;continue;case 24:return[c,d];case 25:c=true;d=true;$r=a.connActive();$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 10:p=new BX(1);q=new BX(0);$go(BF,[a,b,p,q]);s=BG(a,b,p);$s=28;case 28:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}r=s;t=r[0];d=r[1];if(t){c=true;}u=$recv(q);$s=29;case 29:if($c){$c=false;u=u.$blk();}if(u&&u.$blk!==undefined){break s;}u[0];return[c,d];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:BE};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};BF=function(a,b,c,d){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=[d];$deferred.push([(function(d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(d[0],new BW.ptr());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(d),[]]);e=AZ(AH(new AX(0,56000),-0.3));$deferred.push([$methodVal(e,"Stop"),[]]);a.numSent=0;case 1:case 3:if(!(a.numSent<a.sendBuffer.$length)){$s=4;continue;}h=(f=a.sendBuffer,g=a.numSent,((g<0||g>=f.$length)?$throwRuntimeError("index out of range"):f.$array[f.$offset+g]));if(!(h.Payload===BK.nil)){i="frames";(h.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(i)]={k:i,v:new $Int(h.Payload.$length)};}if(!((j=a.receivedEventId,k=a.ackedEventId,(j.$high===k.$high&&j.$low===k.$low)))){l="event_id";(h.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(l)]={k:l,v:a.receivedEventId};a.sendEventAck=false;a.ackedEventId=a.receivedEventId;}m=b.sendJSON(h.Params);delete h.Params[$String.keyFor("frames")];delete h.Params[$String.keyFor("event_id")];if(!($interfaceIsEqual(m,$ifaceNil))){$s=5;continue;}$s=6;continue;case 5:$r=a.log(new BI([new $String("send:"),m]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 6:if(!(h.Payload===BK.nil)){$s=9;continue;}$s=10;continue;case 9:n=b.sendPayload(h);if(!($interfaceIsEqual(n,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=a.log(new BI([new $String("send:"),n]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 12:case 10:if((o=h.id,(o.$high===0&&o.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{a.numSent=a.numSent+(1)>>0;}e.Reset(AH(new AX(0,56000),-0.3));$s=3;continue;case 4:if(a.sendEventAck&&!((p=a.receivedEventId,q=a.ackedEventId,(p.$high===q.$high&&p.$low===q.$low)))){$s=15;continue;}$s=16;continue;case 15:r=a.makeResumeSessionAction(false);s=b.sendJSON(r);if(!($interfaceIsEqual(s,$ifaceNil))){$s=17;continue;}$s=18;continue;case 17:$r=a.log(new BI([new $String("send:"),s]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 18:case 16:u=$select([[a.sendNotify],[e.C],[c]]);$s=21;case 21:if($c){$c=false;u=u.$blk();}if(u&&u.$blk!==undefined){break s;}t=u;if(t[0]===0){$s=22;continue;}if(t[0]===1){$s=23;continue;}if(t[0]===2){$s=24;continue;}$s=25;continue;case 22:v=t[1];w=v[1];if(!w){$s=26;continue;}$s=27;continue;case 26:x=$makeMap($String.keyFor,[{k:"action",v:new $String("close_session")}]);y=b.sendJSON(x);if(!($interfaceIsEqual(y,$ifaceNil))){$s=28;continue;}$s=29;continue;case 28:$r=a.log(new BI([new $String("send:"),y]));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 29:return;case 27:$s=25;continue;case 23:z=b.send(N());if(!($interfaceIsEqual(z,$ifaceNil))){$s=31;continue;}$s=32;continue;case 31:$r=a.log(new BI([new $String("send:"),z]));$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 32:e.Reset(AH(new AX(0,56000),-0.3));$s=25;continue;case 24:return;case 25:$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:BF};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BG=function(a,b,c){var $ptr,a,aa,ab,ac,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=false;e=false;f=BL.nil;g=0;h=AZ(AH(new AX(0,64000),0.3));$deferred.push([$methodVal(h,"Stop"),[]]);i=AZ(new AX(-1,4294967295));$deferred.push([$methodVal(i,"Stop"),[]]);case 1:j=false;case 3:k=[k];if(f===BL.nil){$s=5;continue;}$s=6;continue;case 5:l=b.receive();if(l===null){$s=4;continue;}h.Reset(AH(new AX(0,64000),0.7));$r=a.connActive();$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}m=P(l);if(O(m)===0){$s=9;continue;}$s=10;continue;case 9:$s=3;continue;case 10:k[0]=false;n=AL(m,(k.$ptr||(k.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},k))));if(!($interfaceIsEqual(n,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=a.log(new BI([new $String("receive:"),n]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,new BW.ptr());$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 12:f=new G.ptr(k[0],BK.nil,false);o=f.Int("frames");p=o[0];if(p>0){g=p;}$s=7;continue;case 6:q=b.receive();if(q===null){$s=4;continue;}f.Payload=$append(f.Payload,q);g=g-(1)>>0;case 7:if(g===0){$s=15;continue;}$s=16;continue;case 15:s=a.handleEvent(f);$s=17;case 17:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}r=s;t=r[1];u=r[2];v=r[3];if(!v){$s=18;continue;}$s=19;continue;case 18:if(t){d=true;}else{e=false;}$r=$send(c,new BW.ptr());$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 19:if(u){j=true;}f=BL.nil;g=0;d=true;e=true;case 16:w=$select([[a.closeNotify],[c],[]]);if(w[0]===0){return[d,e];}else if(w[0]===1){return[d,e];}else if(w[0]===2){}$s=3;continue;case 4:if(j&&!i.Active()){i.Reset(AH(new AX(0,7000),-0.3));}y=$select([[b.notify],[h.C],[i.C],[a.closeNotify],[c]]);$s=21;case 21:if($c){$c=false;y=y.$blk();}if(y&&y.$blk!==undefined){break s;}x=y;if(x[0]===0){$s=22;continue;}if(x[0]===1){$s=23;continue;}if(x[0]===2){$s=24;continue;}if(x[0]===3){$s=25;continue;}if(x[0]===4){$s=26;continue;}$s=27;continue;case 22:z=x[1];aa=z[1];if(!aa){$s=28;continue;}$s=29;continue;case 28:$r=a.log(new BI([new $String("receive:"),b.err]));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=31;case 31:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 29:$s=27;continue;case 23:$r=a.log(new BI([new $String("receive timeout")]));$s=32;case 32:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,new BW.ptr());$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];$s=27;continue;case 24:if(!a.sendEventAck&&!((ab=a.ackedEventId,ac=a.receivedEventId,(ab.$high===ac.$high&&ab.$low===ac.$low)))){a.sendAck();}$s=27;continue;case 25:return[d,e];$s=27;continue;case 26:return[d,e];case 27:$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BG};}$f.$ptr=$ptr;$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BY.methods=[{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)}];BL.methods=[{prop:"Bool",name:"Bool",pkg:"",typ:$funcType([$String],[$Bool],false)},{prop:"Int",name:"Int",pkg:"",typ:$funcType([$String],[$Int,$Bool],false)},{prop:"Int64",name:"Int64",pkg:"",typ:$funcType([$String],[$Int64,$Bool],false)},{prop:"Float64",name:"Float64",pkg:"",typ:$funcType([$String],[$Float64,$Bool],false)},{prop:"Str",name:"Str",pkg:"",typ:$funcType([$String],[$String,$Bool],false)},{prop:"Array",name:"Array",pkg:"",typ:$funcType([$String],[BI,$Bool],false)},{prop:"Map",name:"Map",pkg:"",typ:$funcType([$String],[BJ,$Bool],false)},{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)},{prop:"initLastReply",name:"initLastReply",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BY],[],false)},{prop:"getError",name:"getError",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[$String,$String,$Bool,$error],false)}];CF.methods=[{prop:"success",name:"success",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"failure",name:"failure",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([AX],[AX],false)}];CG.methods=[{prop:"Call",name:"Call",pkg:"",typ:$funcType([BY],[BM,$error],false)}];Z.methods=[{prop:"Set",name:"Set",pkg:"",typ:$funcType([$String,$String],[],false)}];CH.methods=[{prop:"SetParams",name:"SetParams",pkg:"",typ:$funcType([BJ],[],false)},{prop:"SetTransport",name:"SetTransport",pkg:"",typ:$funcType([$String],[],false)},{prop:"Open",name:"Open",pkg:"",typ:$funcType([],[],false)},{prop:"Close",name:"Close",pkg:"",typ:$funcType([],[],false)},{prop:"Send",name:"Send",pkg:"",typ:$funcType([BY],[],false)},{prop:"send",name:"send",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BY],[],false)},{prop:"sendAck",name:"sendAck",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"discover",name:"discover",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"connect",name:"connect",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([AW,BH,CF],[$Bool],false)},{prop:"backOff",name:"backOff",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([CF],[$Bool],false)},{prop:"canLogin",name:"canLogin",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[$Bool],false)},{prop:"makeCreateSessionAction",name:"makeCreateSessionAction",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BJ],false)},{prop:"makeResumeSessionAction",name:"makeResumeSessionAction",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([$Bool],[BJ],false)},{prop:"handleSessionEvent",name:"handleSessionEvent",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BJ],[$Bool],false)},{prop:"handleEvent",name:"handleEvent",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BL],[$Int64,$Bool,$Bool,$Bool],false)},{prop:"connState",name:"connState",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([$String],[],false)},{prop:"connActive",name:"connActive",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"log",name:"log",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BI],[],true)}];CA.methods=[{prop:"Active",name:"Active",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"Reset",name:"Reset",pkg:"",typ:$funcType([AX],[],false)},{prop:"Stop",name:"Stop",pkg:"",typ:$funcType([],[],false)}];CB.methods=[{prop:"send",name:"send",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BT],[$error],false)},{prop:"sendJSON",name:"sendJSON",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BJ],[$error],false)},{prop:"sendPayload",name:"sendPayload",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BY],[$error],false)},{prop:"receive",name:"receive",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BT],false)},{prop:"receiveJSON",name:"receiveJSON",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BJ,$error],false)},{prop:"close",name:"close",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)}];F.init([{prop:"Params",name:"Params",pkg:"",typ:BJ,tag:""},{prop:"Payload",name:"Payload",pkg:"",typ:BK,tag:""},{prop:"OnReply",name:"OnReply",pkg:"",typ:CE,tag:""},{prop:"id",name:"id",pkg:"github.com/ninchat/ninchat-go",typ:$Int64,tag:""}]);G.init([{prop:"Params",name:"Params",pkg:"",typ:BJ,tag:""},{prop:"Payload",name:"Payload",pkg:"",typ:BK,tag:""},{prop:"LastReply",name:"LastReply",pkg:"",typ:$Bool,tag:""}]);H.init(B.Object);J.init([{prop:"lastSlot",name:"lastSlot",pkg:"github.com/ninchat/ninchat-go",typ:$Int,tag:""}]);M.init([{prop:"Address",name:"Address",pkg:"",typ:$String,tag:""}]);Z.init($String,$String);AA.init([{prop:"Method",name:"Method",pkg:"",typ:$String,tag:""},{prop:"URL",name:"URL",pkg:"",typ:$String,tag:""},{prop:"Header",name:"Header",pkg:"",typ:Z,tag:""},{prop:"data",name:"data",pkg:"github.com/ninchat/ninchat-go",typ:BT,tag:""}]);AD.init([{prop:"data",name:"data",pkg:"github.com/ninchat/ninchat-go",typ:BT,tag:""},{prop:"err",name:"err",pkg:"github.com/ninchat/ninchat-go",typ:$error,tag:""}]);AV.init([{prop:"OnSessionEvent",name:"OnSessionEvent",pkg:"",typ:CE,tag:""},{prop:"OnEvent",name:"OnEvent",pkg:"",typ:CE,tag:""},{prop:"OnClose",name:"OnClose",pkg:"",typ:BS,tag:""},{prop:"OnConnState",name:"OnConnState",pkg:"",typ:CI,tag:""},{prop:"OnConnActive",name:"OnConnActive",pkg:"",typ:BS,tag:""},{prop:"OnLog",name:"OnLog",pkg:"",typ:CJ,tag:""},{prop:"Address",name:"Address",pkg:"",typ:$String,tag:""},{prop:"forceLongPoll",name:"forceLongPoll",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""},{prop:"sessionParams",name:"sessionParams",pkg:"github.com/ninchat/ninchat-go",typ:BJ,tag:""},{prop:"sessionId",name:"sessionId",pkg:"github.com/ninchat/ninchat-go",typ:$emptyInterface,tag:""},{prop:"latestConnState",name:"latestConnState",pkg:"github.com/ninchat/ninchat-go",typ:$String,tag:""},{prop:"lastActionId",name:"lastActionId",pkg:"github.com/ninchat/ninchat-go",typ:$Int64,tag:""},{prop:"sendNotify",name:"sendNotify",pkg:"github.com/ninchat/ninchat-go",typ:BX,tag:""},{prop:"sendBuffer",name:"sendBuffer",pkg:"github.com/ninchat/ninchat-go",typ:BZ,tag:""},{prop:"numSent",name:"numSent",pkg:"github.com/ninchat/ninchat-go",typ:$Int,tag:""},{prop:"sendEventAck",name:"sendEventAck",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""},{prop:"receivedEventId",name:"receivedEventId",pkg:"github.com/ninchat/ninchat-go",typ:$Int64,tag:""},{prop:"ackedEventId",name:"ackedEventId",pkg:"github.com/ninchat/ninchat-go",typ:$Int64,tag:""},{prop:"closeNotify",name:"closeNotify",pkg:"github.com/ninchat/ninchat-go",typ:BX,tag:""},{prop:"closed",name:"closed",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""},{prop:"running",name:"running",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""}]);AW.init([CH,$String],[$Bool,$Bool],false);AY.init([{prop:"C",name:"C",pkg:"",typ:BX,tag:""},{prop:"id",name:"id",pkg:"github.com/ninchat/ninchat-go",typ:BT,tag:""}]);BB.init([{prop:"notify",name:"notify",pkg:"github.com/ninchat/ninchat-go",typ:BX,tag:""},{prop:"goingAway",name:"goingAway",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""},{prop:"err",name:"err",pkg:"github.com/ninchat/ninchat-go",typ:$error,tag:""},{prop:"impl",name:"impl",pkg:"github.com/ninchat/ninchat-go",typ:BT,tag:""},{prop:"open",name:"open",pkg:"github.com/ninchat/ninchat-go",typ:$Bool,tag:""},{prop:"buf",name:"buf",pkg:"github.com/ninchat/ninchat-go",typ:CC,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=C.$init();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}W=null;X=false;AU=AI(new $Int64(0,4096),-0.25);BA=!($global.WebSocket===undefined);Y();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["ninchatclient/lib"]=(function(){var $pkg={},$init,A,B,H,I,J,K,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,AB,AC,AD,AE,AF,AG,AH,AI,AJ,AK,AL,AM,C,D,E,F,G,L,M;A=$packages["github.com/gopherjs/gopherjs/js"];B=$packages["github.com/ninchat/ninchat-go"];H=$pkg.callback1=$newType(4,$kindFunc,"clientlib.callback1","callback1","ninchatclient/lib",null);I=$pkg.callback2=$newType(4,$kindFunc,"clientlib.callback2","callback2","ninchatclient/lib",null);J=$pkg.promise=$newType(0,$kindStruct,"clientlib.promise","promise","ninchatclient/lib",function(resolvers_,rejecters_,notifiers_,onPanic_){this.$val=this;if(arguments.length===0){this.resolvers=N.nil;this.rejecters=O.nil;this.notifiers=N.nil;this.onPanic=$throwNilPointerError;return;}this.resolvers=resolvers_;this.rejecters=rejecters_;this.notifiers=notifiers_;this.onPanic=onPanic_;});K=$pkg.SessionAdapter=$newType(0,$kindStruct,"clientlib.SessionAdapter","SessionAdapter","ninchatclient/lib",function(Session_,OnPanic_){this.$val=this;if(arguments.length===0){this.Session=Z.nil;this.OnPanic=$throwNilPointerError;return;}this.Session=Session_;this.OnPanic=OnPanic_;});N=$sliceType(I);O=$sliceType(H);P=$sliceType(B.Frame);Q=$mapType($String,$emptyInterface);R=$sliceType(Q);S=$ptrType(A.Object);T=$funcType([Q,S,$String],[S],false);U=$funcType([],[Q],false);V=$funcType([S],[S],false);W=$sliceType(S);X=$funcType([I,H,I],[],false);Y=$ptrType(B.Event);Z=$ptrType(B.Session);AA=$sliceType($emptyInterface);AB=$structType([]);AC=$chanType(AB,false,false);AD=$ptrType(B.Action);AE=$sliceType(AD);AF=$funcType([S],[],false);AG=$funcType([Q],[],false);AH=$funcType([$String],[],false);AI=$funcType([],[],false);AJ=$funcType([Q,S],[S],false);AK=$ptrType(J);AL=$funcType([$String,$emptyInterface],[],false);AM=$ptrType(K);C=function(a,b,c){var $ptr,a,b,c,d;d=new J.ptr(N.nil,O.nil,N.nil,E((function(){var $ptr;return(function(d){var $ptr,d;b($externalize(d,$String));});})));$go((function $b(){var $ptr,e,f,g,h,i,j,k,l,m,n,o,p,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=new B.Caller.ptr(c);f=new B.Action.ptr(a,P.nil,$throwNilPointerError,new $Int64(0,0));h=e.Call(f);$s=1;case 1:if($c){$c=false;h=h.$blk();}if(h&&h.$blk!==undefined){break s;}g=h;i=g[0];j=g[1];if(!($interfaceIsEqual(j,$ifaceNil))){$s=2;continue;}$s=3;continue;case 2:k=j.Error();$s=4;case 4:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}l=k;b($externalize(l,$String));$r=d.onReply(new B.Event.ptr($makeMap($String.keyFor,[{k:"event",v:new $String("error")},{k:"error_type",v:new $String("internal")},{k:"error_reason",v:new $String(l)}]),P.nil,false));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 3:m=R.nil;n=i;o=0;while(true){if(!(o<n.$length)){break;}p=((o<0||o>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+o]);m=$append(m,p.Params);o++;}$r=d.resolveCall(m);$s=6;case 6:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.$s=$s;$f.$r=$r;return $f;}),[]);return d.object();};D=function(a){var $ptr,a;a.call=$externalize(C,T);a.newSession=$externalize(M,U);a.stringifyFrame=$externalize(B.StringifyFrame,V);};$pkg.Init=D;E=function(a){var $ptr,a;return(function $b(b,c){var $ptr,b,c,d,e,f,g,h,i,j,k,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(!($interfaceIsEqual(c,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:d=a();$s=3;case 3:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;if(!(e===$throwNilPointerError)){$s=4;continue;}$s=5;continue;case 4:f="";g=c;if($assertType(g,$String,true)[1]){$s=6;continue;}if($assertType(g,$error,true)[1]){$s=7;continue;}$s=8;continue;case 6:h=g.$val;f=h;$s=9;continue;case 7:i=g;j=i.Error();$s=10;case 10:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}f=j;$s=9;continue;case 8:k=g;f=$internalize($global.JSON.stringify($externalize(k,$emptyInterface)),$String);case 9:$r=e(b+" "+f);$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 5:case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.$s=$s;$f.$r=$r;return $f;});};F=function(a){var $ptr,a,b,c;b=P.nil;if(!(a===null)&&!(a===undefined)){c=0;while(true){if(!(c<$parseInt(a.length))){break;}b=$append(b,a[c]);c=c+(1)>>0;}}return b;};G=function(a){var $ptr,a,b,c,d,e;b=W.nil;c=a;d=0;while(true){if(!(d<c.$length)){break;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);b=$append(b,e);d++;}return b;};J.ptr.prototype.object=function(){var $ptr,a,b;a=null;b=this;a=new($global.Object)();a.then=$externalize((function(c,d,e){var $ptr,c,d,e;if(!(c===$throwNilPointerError)){b.resolvers=$append(b.resolvers,c);}if(!(d===$throwNilPointerError)){b.rejecters=$append(b.rejecters,d);}if(!(e===$throwNilPointerError)){b.notifiers=$append(b.notifiers,e);}}),X);return a;};J.prototype.object=function(){return this.$val.object();};J.ptr.prototype.onReply=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(a===Y.nil)){$s=1;continue;}$s=2;continue;case 1:if(a.String()==="error"){$s=3;continue;}if(a.LastReply){$s=4;continue;}$s=5;continue;case 3:c=b.rejecters;d=0;case 7:if(!(d<c.$length)){$s=8;continue;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);$r=b.invoke1(e,a,"Promise reject callback:");$s=9;case 9:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d++;$s=7;continue;case 8:$s=6;continue;case 4:f=b.resolvers;g=0;case 10:if(!(g<f.$length)){$s=11;continue;}h=((g<0||g>=f.$length)?$throwRuntimeError("index out of range"):f.$array[f.$offset+g]);$r=b.invoke2(h,a,"Promise resolve callback:");$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}g++;$s=10;continue;case 11:$s=6;continue;case 5:i=b.notifiers;j=0;case 13:if(!(j<i.$length)){$s=14;continue;}k=((j<0||j>=i.$length)?$throwRuntimeError("index out of range"):i.$array[i.$offset+j]);$r=b.invoke2(k,a,"Promise notify callback:");$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}j++;$s=13;continue;case 14:case 6:case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:J.ptr.prototype.onReply};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.$s=$s;$f.$r=$r;return $f;};J.prototype.onReply=function(a){return this.$val.onReply(a);};J.ptr.prototype.resolveCall=function(a){var $ptr,a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.resolvers;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);$r=b.invokeCall(e,a,"Promise resolve callback:");$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d++;$s=1;continue;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:J.ptr.prototype.resolveCall};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};J.prototype.resolveCall=function(a){return this.$val.resolveCall(a);};J.ptr.prototype.invoke1=function(a,b,c){var $ptr,a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=[d];d[0]=this;$deferred.push([(function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].onPanic(c[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]]);$r=a(b.Params);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:J.ptr.prototype.invoke1};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};J.prototype.invoke1=function(a,b,c){return this.$val.invoke1(a,b,c);};J.ptr.prototype.invoke2=function(a,b,c){var $ptr,a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=[d];d[0]=this;$deferred.push([(function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].onPanic(c[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]]);$r=a(new Q(b.Params),G(b.Payload));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:J.ptr.prototype.invoke2};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};J.prototype.invoke2=function(a,b,c){return this.$val.invoke2(a,b,c);};J.ptr.prototype.invokeCall=function(a,b,c){var $ptr,a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=[d];d[0]=this;$deferred.push([(function(c,d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].onPanic(c[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(c,d),[]]);$r=a(b,W.nil);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:J.ptr.prototype.invokeCall};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};J.prototype.invokeCall=function(a,b,c){return this.$val.invokeCall(a,b,c);};L=function(a){var $ptr,a;return new K.ptr(a,E((function(){var $ptr;return(function $b(b){var $ptr,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=a.OnLog(new AA([new $String(b)]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;});})));};$pkg.NewSessionAdapter=L;K.ptr.prototype.OnSessionEvent=function(a){var $ptr,a,b;b=this;b.Session.OnSessionEvent=(function $b(c){var $ptr,c,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session onSessionEvent callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]]);a($externalize(c.Params,Q));$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnSessionEvent=function(a){return this.$val.OnSessionEvent(a);};K.ptr.prototype.OnEvent=function(a){var $ptr,a,b;b=this;b.Session.OnEvent=(function $b(c){var $ptr,c,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session onEvent callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]]);a($externalize(c.Params,Q),$externalize(G(c.Payload),W));$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnEvent=function(a){return this.$val.OnEvent(a);};K.ptr.prototype.OnClose=function(a){var $ptr,a,b;b=this;b.Session.OnClose=(function $b(){var $ptr,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session onClose callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]]);a();$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnClose=function(a){return this.$val.OnClose(a);};K.ptr.prototype.OnConnState=function(a){var $ptr,a,b;b=this;if(a===null){b.Session.OnConnState=$throwNilPointerError;return;}b.Session.OnConnState=(function $b(c){var $ptr,c,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session onConnState callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]]);a($externalize(c,$String));$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnConnState=function(a){return this.$val.OnConnState(a);};K.ptr.prototype.OnConnActive=function(a){var $ptr,a,b;b=this;if(a===null){b.Session.OnConnActive=$throwNilPointerError;return;}b.Session.OnConnActive=(function $b(){var $ptr,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session onConnActive callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]]);a(new($global.Date)().getTime());$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnConnActive=function(a){return this.$val.OnConnActive(a);};K.ptr.prototype.OnLog=function(a){var $ptr,a,b;b=this;if(a===null){b.Session.OnLog=$throwNilPointerError;return;}b.Session.OnLog=(function $b(c){var $ptr,c,d,e,f,g,h,i,j,k,l,m,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function(){var $ptr;$recover();}),[]]);d="";e=c;f=0;case 1:if(!(f<e.$length)){$s=2;continue;}g=((f<0||f>=e.$length)?$throwRuntimeError("index out of range"):e.$array[e.$offset+f]);h="";i=g;if($assertType(i,$String,true)[1]){$s=3;continue;}if($assertType(i,$error,true)[1]){$s=4;continue;}$s=5;continue;case 3:j=i.$val;h=j;$s=6;continue;case 4:k=i;l=k.Error();$s=7;case 7:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}h=l;$s=6;continue;case 5:m=i;h=$internalize($global.JSON.stringify($externalize(m,$emptyInterface)),$String);case 6:if(d.length>0){d=d+(" ");}d=d+(h);f++;$s=1;continue;case 2:while(true){if(!(d.length>0&&(d.charCodeAt((d.length-1>>0))===32))){break;}d=d.substring(0,(d.length-1>>0));}a($externalize(d,$String));$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};K.prototype.OnLog=function(a){return this.$val.OnLog(a);};K.ptr.prototype.SetAddress=function(a){var $ptr,a,b;b=this;b.Session.Address=a;};K.prototype.SetAddress=function(a){return this.$val.SetAddress(a);};K.ptr.prototype.Send=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i;c=null;d=this;e=new B.Action.ptr(a,F(b),$throwNilPointerError,new $Int64(0,0));f=(g=a[$String.keyFor("action_id")],g!==undefined?[g.v,true]:[$ifaceNil,false]);h=f[1];if(!h){i=new J.ptr(N.nil,O.nil,N.nil,d.OnPanic);e.OnReply=$methodVal(i,"onReply");c=i.object();}d.Session.Send(e);return c;};K.prototype.Send=function(a,b){return this.$val.Send(a,b);};M=function(){var $ptr,a,b;a=new B.Session.ptr($throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,"",false,false,$ifaceNil,"",new $Int64(0,0),AC.nil,AE.nil,0,false,new $Int64(0,0),new $Int64(0,0),AC.nil,false,false);b=L(a);return $makeMap($String.keyFor,[{k:"onSessionEvent",v:new AF($methodVal(b,"OnSessionEvent"))},{k:"onEvent",v:new AF($methodVal(b,"OnEvent"))},{k:"onClose",v:new AF($methodVal(b,"OnClose"))},{k:"onConnState",v:new AF($methodVal(b,"OnConnState"))},{k:"onConnActive",v:new AF($methodVal(b,"OnConnActive"))},{k:"onLog",v:new AF($methodVal(b,"OnLog"))},{k:"setParams",v:new AG($methodVal(a,"SetParams"))},{k:"setTransport",v:new AH($methodVal(a,"SetTransport"))},{k:"setAddress",v:new AH($methodVal(b,"SetAddress"))},{k:"open",v:new AI($methodVal(a,"Open"))},{k:"close",v:new AI($methodVal(a,"Close"))},{k:"send",v:new AJ($methodVal(b,"Send"))}]);};AK.methods=[{prop:"object",name:"object",pkg:"ninchatclient/lib",typ:$funcType([],[S],false)},{prop:"onReply",name:"onReply",pkg:"ninchatclient/lib",typ:$funcType([Y],[],false)},{prop:"resolveCall",name:"resolveCall",pkg:"ninchatclient/lib",typ:$funcType([R],[],false)},{prop:"invoke1",name:"invoke1",pkg:"ninchatclient/lib",typ:$funcType([H,Y,$String],[],false)},{prop:"invoke2",name:"invoke2",pkg:"ninchatclient/lib",typ:$funcType([I,Y,$String],[],false)},{prop:"invokeCall",name:"invokeCall",pkg:"ninchatclient/lib",typ:$funcType([I,R,$String],[],false)}];AM.methods=[{prop:"OnSessionEvent",name:"OnSessionEvent",pkg:"",typ:$funcType([S],[],false)},{prop:"OnEvent",name:"OnEvent",pkg:"",typ:$funcType([S],[],false)},{prop:"OnClose",name:"OnClose",pkg:"",typ:$funcType([S],[],false)},{prop:"OnConnState",name:"OnConnState",pkg:"",typ:$funcType([S],[],false)},{prop:"OnConnActive",name:"OnConnActive",pkg:"",typ:$funcType([S],[],false)},{prop:"OnLog",name:"OnLog",pkg:"",typ:$funcType([S],[],false)},{prop:"SetAddress",name:"SetAddress",pkg:"",typ:$funcType([$String],[],false)},{prop:"Send",name:"Send",pkg:"",typ:$funcType([Q,S],[S],false)}];H.init([Q],[],false);I.init([$emptyInterface,W],[],false);J.init([{prop:"resolvers",name:"resolvers",pkg:"ninchatclient/lib",typ:N,tag:""},{prop:"rejecters",name:"rejecters",pkg:"ninchatclient/lib",typ:O,tag:""},{prop:"notifiers",name:"notifiers",pkg:"ninchatclient/lib",typ:N,tag:""},{prop:"onPanic",name:"onPanic",pkg:"ninchatclient/lib",typ:AL,tag:""}]);K.init([{prop:"Session",name:"Session",pkg:"",typ:Z,tag:""},{prop:"OnPanic",name:"OnPanic",pkg:"",typ:AL,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["ninchatclient"]=(function(){var $pkg={},$init,A,C,B,D;A=$packages["github.com/gopherjs/gopherjs/js"];C=$packages["github.com/ninchat/ninchat-go"];B=$packages["ninchatclient/lib"];D=function(){var $ptr,a;a=new($global.Object)();B.Init(a);$global.NinchatClient=a;};$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=C.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if($pkg===$mainPkg){D();}}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$synthesizeMethods();
var $mainPkg = $packages["ninchatclient"];
$packages["runtime"].$init();
$go($mainPkg.$init, [], true);
$flushConsole();

}).call(this);
//# sourceMappingURL=ninchatclient.min.js.map
