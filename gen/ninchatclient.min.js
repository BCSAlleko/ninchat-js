"use strict";
(function() {

Error.stackTraceLimit=Infinity;var $global,$module;if(typeof window!=="undefined"){$global=window;}else if(typeof self!=="undefined"){$global=self;}else if(typeof global!=="undefined"){$global=global;$global.require=require;}else{console.log("warning: no global object found");}if(typeof module!=="undefined"){$module=module;}var $packages={},$reflect,$idCounter=0;var $keys=function(m){return m?Object.keys(m):[];};var $min=Math.min;var $mod=function(x,y){return x%y;};var $parseInt=parseInt;var $parseFloat=function(f){if(f.constructor===Number){return f;}return parseFloat(f);};var $mapArray=function(array,f){var newArray=new array.constructor(array.length),i;for(i=0;i<array.length;i++){newArray[i]=f(array[i]);}return newArray;};var $methodVal=function(recv,name){var vals=recv.$methodVals||{};recv.$methodVals=vals;var f=vals[name];if(f!==undefined){return f;}var method=recv[name];f=function(){$stackDepthOffset--;try{return method.apply(recv,arguments);}finally{$stackDepthOffset++;}};vals[name]=f;return f;};var $methodExpr=function(method){if(method.$expr===undefined){method.$expr=function(){$stackDepthOffset--;try{return Function.call.apply(method,arguments);}finally{$stackDepthOffset++;}};}return method.$expr;};var $subslice=function(slice,low,high,max){if(low<0||high<low||max<high||high>slice.$capacity||max>slice.$capacity){$throwRuntimeError("slice bounds out of range");}var s=new slice.constructor(slice.$array);s.$offset=slice.$offset+low;s.$length=slice.$length-low;s.$capacity=slice.$capacity-low;if(high!==undefined){s.$length=high-low;}if(max!==undefined){s.$capacity=max-low;}return s;};var $sliceToArray=function(slice){if(slice.$length===0){return[];}if(slice.$array.constructor!==Array){return slice.$array.subarray(slice.$offset,slice.$offset+slice.$length);}return slice.$array.slice(slice.$offset,slice.$offset+slice.$length);};var $decodeRune=function(str,pos){var c0=str.charCodeAt(pos);if(c0<0x80){return[c0,1];}if(c0!==c0||c0<0xC0){return[0xFFFD,1];}var c1=str.charCodeAt(pos+1);if(c1!==c1||c1<0x80||0xC0<=c1){return[0xFFFD,1];}if(c0<0xE0){var r=(c0&0x1F)<<6|(c1&0x3F);if(r<=0x7F){return[0xFFFD,1];}return[r,2];}var c2=str.charCodeAt(pos+2);if(c2!==c2||c2<0x80||0xC0<=c2){return[0xFFFD,1];}if(c0<0xF0){var r=(c0&0x0F)<<12|(c1&0x3F)<<6|(c2&0x3F);if(r<=0x7FF){return[0xFFFD,1];}if(0xD800<=r&&r<=0xDFFF){return[0xFFFD,1];}return[r,3];}var c3=str.charCodeAt(pos+3);if(c3!==c3||c3<0x80||0xC0<=c3){return[0xFFFD,1];}if(c0<0xF8){var r=(c0&0x07)<<18|(c1&0x3F)<<12|(c2&0x3F)<<6|(c3&0x3F);if(r<=0xFFFF||0x10FFFF<r){return[0xFFFD,1];}return[r,4];}return[0xFFFD,1];};var $encodeRune=function(r){if(r<0||r>0x10FFFF||(0xD800<=r&&r<=0xDFFF)){r=0xFFFD;}if(r<=0x7F){return String.fromCharCode(r);}if(r<=0x7FF){return String.fromCharCode(0xC0|r>>6,0x80|(r&0x3F));}if(r<=0xFFFF){return String.fromCharCode(0xE0|r>>12,0x80|(r>>6&0x3F),0x80|(r&0x3F));}return String.fromCharCode(0xF0|r>>18,0x80|(r>>12&0x3F),0x80|(r>>6&0x3F),0x80|(r&0x3F));};var $stringToBytes=function(str){var array=new Uint8Array(str.length),i;for(i=0;i<str.length;i++){array[i]=str.charCodeAt(i);}return array;};var $bytesToString=function(slice){if(slice.$length===0){return"";}var str="",i;for(i=0;i<slice.$length;i+=10000){str+=String.fromCharCode.apply(null,slice.$array.subarray(slice.$offset+i,slice.$offset+Math.min(slice.$length,i+10000)));}return str;};var $stringToRunes=function(str){var array=new Int32Array(str.length);var rune,i,j=0;for(i=0;i<str.length;i+=rune[1],j++){rune=$decodeRune(str,i);array[j]=rune[0];}return array.subarray(0,j);};var $runesToString=function(slice){if(slice.$length===0){return"";}var str="",i;for(i=0;i<slice.$length;i++){str+=$encodeRune(slice.$array[slice.$offset+i]);}return str;};var $copyString=function(dst,src){var n=Math.min(src.length,dst.$length),i;for(i=0;i<n;i++){dst.$array[dst.$offset+i]=src.charCodeAt(i);}return n;};var $copySlice=function(dst,src){var n=Math.min(src.$length,dst.$length),i;$internalCopy(dst.$array,src.$array,dst.$offset,src.$offset,n,dst.constructor.elem);return n;};var $copy=function(dst,src,type){var i;switch(type.kind){case"Array":$internalCopy(dst,src,0,0,src.length,type.elem);return true;case"Struct":for(i=0;i<type.fields.length;i++){var field=type.fields[i];var name=field[0];if(!$copy(dst[name],src[name],field[3])){dst[name]=src[name];}}return true;default:return false;}};var $internalCopy=function(dst,src,dstOffset,srcOffset,n,elem){var i;if(n===0){return;}if(src.subarray){dst.set(src.subarray(srcOffset,srcOffset+n),dstOffset);return;}switch(elem.kind){case"Array":case"Struct":for(i=0;i<n;i++){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}for(i=0;i<n;i++){dst[dstOffset+i]=src[srcOffset+i];}};var $clone=function(src,type){var clone=type.zero();$copy(clone,src,type);return clone;};var $append=function(slice){return $internalAppend(slice,arguments,1,arguments.length-1);};var $appendSlice=function(slice,toAppend){return $internalAppend(slice,toAppend.$array,toAppend.$offset,toAppend.$length);};var $internalAppend=function(slice,array,offset,length){if(length===0){return slice;}var newArray=slice.$array;var newOffset=slice.$offset;var newLength=slice.$length+length;var newCapacity=slice.$capacity;if(newLength>newCapacity){newOffset=0;newCapacity=Math.max(newLength,slice.$capacity<1024?slice.$capacity*2:Math.floor(slice.$capacity*5/4));if(slice.$array.constructor===Array){newArray=slice.$array.slice(slice.$offset,slice.$offset+slice.$length);newArray.length=newCapacity;var zero=slice.constructor.elem.zero,i;for(i=slice.$length;i<newCapacity;i++){newArray[i]=zero();}}else{newArray=new slice.$array.constructor(newCapacity);newArray.set(slice.$array.subarray(slice.$offset,slice.$offset+slice.$length));}}$internalCopy(newArray,array,newOffset+slice.$length,offset,length,slice.constructor.elem);var newSlice=new slice.constructor(newArray);newSlice.$offset=newOffset;newSlice.$length=newLength;newSlice.$capacity=newCapacity;return newSlice;};var $equal=function(a,b,type){if(a===b){return true;}var i;switch(type.kind){case"Float32":return $float32IsEqual(a,b);case"Complex64":return $float32IsEqual(a.$real,b.$real)&&$float32IsEqual(a.$imag,b.$imag);case"Complex128":return a.$real===b.$real&&a.$imag===b.$imag;case"Int64":case"Uint64":return a.$high===b.$high&&a.$low===b.$low;case"Ptr":if(a.constructor.Struct){return false;}return $pointerIsEqual(a,b);case"Array":if(a.length!=b.length){return false;}var i;for(i=0;i<a.length;i++){if(!$equal(a[i],b[i],type.elem)){return false;}}return true;case"Struct":for(i=0;i<type.fields.length;i++){var field=type.fields[i];var name=field[0];if(!$equal(a[name],b[name],field[3])){return false;}}return true;default:return false;}};var $interfaceIsEqual=function(a,b){if(a===null||b===null||a===undefined||b===undefined||a.constructor!==b.constructor){return a===b;}switch(a.constructor.kind){case"Func":case"Map":case"Slice":case"Struct":$throwRuntimeError("comparing uncomparable type "+a.constructor.string);case undefined:return a===b;default:return $equal(a.$val,b.$val,a.constructor);}};var $float32IsEqual=function(a,b){if(a===b){return true;}if(a===0||b===0||a===1/0||b===1/0||a===-1/0||b===-1/0||a!==a||b!==b){return false;}var math=$packages["math"];return math!==undefined&&math.Float32bits(a)===math.Float32bits(b);};var $pointerIsEqual=function(a,b){if(a===b){return true;}if(a.$get===$throwNilPointerError||b.$get===$throwNilPointerError){return a.$get===$throwNilPointerError&&b.$get===$throwNilPointerError;}var va=a.$get();var vb=b.$get();if(va!==vb){return false;}var dummy=va+1;a.$set(dummy);var equal=b.$get()===dummy;a.$set(va);return equal;};var $newType=function(size,kind,string,name,pkgPath,constructor){var typ;switch(kind){case"Bool":case"Int":case"Int8":case"Int16":case"Int32":case"Uint":case"Uint8":case"Uint16":case"Uint32":case"Uintptr":case"String":case"UnsafePointer":typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+this.$val;};break;case"Float32":case"Float64":typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+$floatKey(this.$val);};break;case"Int64":typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case"Uint64":typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case"Complex64":case"Complex128":typ=function(real,imag){this.$real=real;this.$imag=imag;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$real+"$"+this.$imag;};break;case"Array":typ=function(v){this.$val=v;};typ.Ptr=$newType(4,"Ptr","*"+string,"","",function(array){this.$get=function(){return array;};this.$val=array;});typ.init=function(elem,len){typ.elem=elem;typ.len=len;typ.prototype.$key=function(){return string+"$"+Array.prototype.join.call($mapArray(this.$val,function(e){var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}),"$");};typ.extendReflectType=function(rt){rt.arrayType=new $reflect.arrayType.Ptr(rt,elem.reflectType(),undefined,len);};typ.Ptr.init(typ);Object.defineProperty(typ.Ptr.nil,"nilCheck",{get:$throwNilPointerError});};break;case"Chan":typ=function(capacity){this.$val=this;this.$capacity=capacity;this.$buffer=[];this.$sendQueue=[];this.$recvQueue=[];this.$closed=false;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem,sendOnly,recvOnly){typ.elem=elem;typ.sendOnly=sendOnly;typ.recvOnly=recvOnly;typ.nil=new typ(0);typ.nil.$sendQueue=typ.nil.$recvQueue={length:0,push:function(){},shift:function(){return undefined;},indexOf:function(){return-1;}};typ.extendReflectType=function(rt){rt.chanType=new $reflect.chanType.Ptr(rt,elem.reflectType(),sendOnly?$reflect.SendDir:(recvOnly?$reflect.RecvDir:$reflect.BothDir));};};break;case"Func":typ=function(v){this.$val=v;};typ.init=function(params,results,variadic){typ.params=params;typ.results=results;typ.variadic=variadic;typ.extendReflectType=function(rt){var typeSlice=($sliceType($ptrType($reflect.rtype.Ptr)));rt.funcType=new $reflect.funcType.Ptr(rt,variadic,new typeSlice($mapArray(params,function(p){return p.reflectType();})),new typeSlice($mapArray(results,function(p){return p.reflectType();})));};};break;case"Interface":typ={implementedBy:{},missingMethodFor:{}};typ.init=function(methods){typ.methods=methods;typ.extendReflectType=function(rt){var imethods=$mapArray(methods,function(m){return new $reflect.imethod.Ptr($newStringPtr(m[1]),$newStringPtr(m[2]),m[3].reflectType());});var methodSlice=($sliceType($ptrType($reflect.imethod.Ptr)));rt.interfaceType=new $reflect.interfaceType.Ptr(rt,new methodSlice(imethods));};};break;case"Map":typ=function(v){this.$val=v;};typ.init=function(key,elem){typ.key=key;typ.elem=elem;typ.extendReflectType=function(rt){rt.mapType=new $reflect.mapType.Ptr(rt,key.reflectType(),elem.reflectType(),undefined,undefined);};};break;case"Ptr":typ=constructor||function(getter,setter,target){this.$get=getter;this.$set=setter;this.$target=target;this.$val=this;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem){typ.nil=new typ($throwNilPointerError,$throwNilPointerError);typ.extendReflectType=function(rt){rt.ptrType=new $reflect.ptrType.Ptr(rt,elem.reflectType());};};break;case"Slice":var nativeArray;typ=function(array){if(array.constructor!==nativeArray){array=new nativeArray(array);}this.$array=array;this.$offset=0;this.$length=array.length;this.$capacity=array.length;this.$val=this;};typ.make=function(length,capacity){capacity=capacity||length;var array=new nativeArray(capacity),i;if(nativeArray===Array){for(i=0;i<capacity;i++){array[i]=typ.elem.zero();}}var slice=new typ(array);slice.$length=length;return slice;};typ.init=function(elem){typ.elem=elem;nativeArray=$nativeArray(elem.kind);typ.nil=new typ([]);typ.extendReflectType=function(rt){rt.sliceType=new $reflect.sliceType.Ptr(rt,elem.reflectType());};};break;case"Struct":typ=function(v){this.$val=v;};typ.Ptr=$newType(4,"Ptr","*"+string,"","",constructor);typ.Ptr.Struct=typ;typ.Ptr.prototype.$get=function(){return this;};typ.init=function(fields){var i;typ.fields=fields;typ.prototype.$key=function(){var val=this.$val;return string+"$"+$mapArray(fields,function(field){var e=val[field[0]];var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}).join("$");};typ.Ptr.extendReflectType=function(rt){rt.ptrType=new $reflect.ptrType.Ptr(rt,typ.reflectType());};typ.Ptr.nil=Object.create(constructor.prototype);typ.Ptr.nil.$val=typ.Ptr.nil;for(i=0;i<fields.length;i++){var field=fields[i];Object.defineProperty(typ.Ptr.nil,field[0],{get:$throwNilPointerError,set:$throwNilPointerError});}for(i=0;i<typ.methods.length;i++){var m=typ.methods[i];if(m[4]!=-1){(function(field,methodName){typ.prototype[methodName]=function(){var v=this.$val[field[0]];return v[methodName].apply(v,arguments);};})(fields[m[4]],m[0]);}}for(i=0;i<typ.Ptr.methods.length;i++){var m=typ.Ptr.methods[i];if(m[4]!=-1){(function(field,methodName){typ.Ptr.prototype[methodName]=function(){var v=this[field[0]];if(v.$val===undefined){v=new field[3](v);}return v[methodName].apply(v,arguments);};})(fields[m[4]],m[0]);}}typ.extendReflectType=function(rt){var reflectFields=new Array(fields.length),i;for(i=0;i<fields.length;i++){var field=fields[i];reflectFields[i]=new $reflect.structField.Ptr($newStringPtr(field[1]),$newStringPtr(field[2]),field[3].reflectType(),$newStringPtr(field[4]),i);}rt.structType=new $reflect.structType.Ptr(rt,new($sliceType($reflect.structField.Ptr))(reflectFields));};};break;default:$panic(new $String("invalid kind: "+kind));}switch(kind){case"Bool":case"Map":typ.zero=function(){return false;};break;case"Int":case"Int8":case"Int16":case"Int32":case"Uint":case"Uint8":case"Uint16":case"Uint32":case"Uintptr":case"UnsafePointer":case"Float32":case"Float64":typ.zero=function(){return 0;};break;case"String":typ.zero=function(){return"";};break;case"Int64":case"Uint64":case"Complex64":case"Complex128":var zero=new typ(0,0);typ.zero=function(){return zero;};break;case"Chan":case"Ptr":case"Slice":typ.zero=function(){return typ.nil;};break;case"Func":typ.zero=function(){return $throwNilPointerError;};break;case"Interface":typ.zero=function(){return $ifaceNil;};break;case"Array":typ.zero=function(){var arrayClass=$nativeArray(typ.elem.kind);if(arrayClass!==Array){return new arrayClass(typ.len);}var array=new Array(typ.len),i;for(i=0;i<typ.len;i++){array[i]=typ.elem.zero();}return array;};break;case"Struct":typ.zero=function(){return new typ.Ptr();};break;default:$panic(new $String("invalid kind: "+kind));}typ.kind=kind;typ.string=string;typ.typeName=name;typ.pkgPath=pkgPath;typ.methods=[];var rt=null;typ.reflectType=function(){if(rt===null){rt=new $reflect.rtype.Ptr(size,0,0,0,0,$reflect.kinds[kind],undefined,undefined,$newStringPtr(string),undefined,undefined);rt.jsType=typ;var methods=[];if(typ.methods!==undefined){var i;for(i=0;i<typ.methods.length;i++){var m=typ.methods[i];var t=m[3];methods.push(new $reflect.method.Ptr($newStringPtr(m[1]),$newStringPtr(m[2]),t.reflectType(),$funcType([typ].concat(t.params),t.results,t.variadic).reflectType(),undefined,undefined));}}if(name!==""||methods.length!==0){var methodSlice=($sliceType($ptrType($reflect.method.Ptr)));rt.uncommonType=new $reflect.uncommonType.Ptr($newStringPtr(name),$newStringPtr(pkgPath),new methodSlice(methods));rt.uncommonType.jsType=typ;}if(typ.extendReflectType!==undefined){typ.extendReflectType(rt);}}return rt;};return typ;};var $Bool=$newType(1,"Bool","bool","bool","",null);var $Int=$newType(4,"Int","int","int","",null);var $Int8=$newType(1,"Int8","int8","int8","",null);var $Int16=$newType(2,"Int16","int16","int16","",null);var $Int32=$newType(4,"Int32","int32","int32","",null);var $Int64=$newType(8,"Int64","int64","int64","",null);var $Uint=$newType(4,"Uint","uint","uint","",null);var $Uint8=$newType(1,"Uint8","uint8","uint8","",null);var $Uint16=$newType(2,"Uint16","uint16","uint16","",null);var $Uint32=$newType(4,"Uint32","uint32","uint32","",null);var $Uint64=$newType(8,"Uint64","uint64","uint64","",null);var $Uintptr=$newType(4,"Uintptr","uintptr","uintptr","",null);var $Float32=$newType(4,"Float32","float32","float32","",null);var $Float64=$newType(8,"Float64","float64","float64","",null);var $Complex64=$newType(8,"Complex64","complex64","complex64","",null);var $Complex128=$newType(16,"Complex128","complex128","complex128","",null);var $String=$newType(8,"String","string","string","",null);var $UnsafePointer=$newType(4,"UnsafePointer","unsafe.Pointer","Pointer","",null);var $nativeArray=function(elemKind){return({Int:Int32Array,Int8:Int8Array,Int16:Int16Array,Int32:Int32Array,Uint:Uint32Array,Uint8:Uint8Array,Uint16:Uint16Array,Uint32:Uint32Array,Uintptr:Uint32Array,Float32:Float32Array,Float64:Float64Array})[elemKind]||Array;};var $toNativeArray=function(elemKind,array){var nativeArray=$nativeArray(elemKind);if(nativeArray===Array){return array;}return new nativeArray(array);};var $arrayTypes={};var $arrayType=function(elem,len){var string="["+len+"]"+elem.string;var typ=$arrayTypes[string];if(typ===undefined){typ=$newType(12,"Array",string,"","",null);typ.init(elem,len);$arrayTypes[string]=typ;}return typ;};var $chanType=function(elem,sendOnly,recvOnly){var string=(recvOnly?"<-":"")+"chan"+(sendOnly?"<- ":" ")+elem.string;var field=sendOnly?"SendChan":(recvOnly?"RecvChan":"Chan");var typ=elem[field];if(typ===undefined){typ=$newType(4,"Chan",string,"","",null);typ.init(elem,sendOnly,recvOnly);elem[field]=typ;}return typ;};var $funcTypes={};var $funcType=function(params,results,variadic){var paramTypes=$mapArray(params,function(p){return p.string;});if(variadic){paramTypes[paramTypes.length-1]="..."+paramTypes[paramTypes.length-1].substr(2);}var string="func("+paramTypes.join(", ")+")";if(results.length===1){string+=" "+results[0].string;}else if(results.length>1){string+=" ("+$mapArray(results,function(r){return r.string;}).join(", ")+")";}var typ=$funcTypes[string];if(typ===undefined){typ=$newType(4,"Func",string,"","",null);typ.init(params,results,variadic);$funcTypes[string]=typ;}return typ;};var $interfaceTypes={};var $interfaceType=function(methods){var string="interface {}";if(methods.length!==0){string="interface { "+$mapArray(methods,function(m){return(m[2]!==""?m[2]+".":"")+m[1]+m[3].string.substr(4);}).join("; ")+" }";}var typ=$interfaceTypes[string];if(typ===undefined){typ=$newType(8,"Interface",string,"","",null);typ.init(methods);$interfaceTypes[string]=typ;}return typ;};var $emptyInterface=$interfaceType([]);var $ifaceNil={$key:function(){return"nil";}};var $error=$newType(8,"Interface","error","error","",null);$error.init([["Error","Error","",$funcType([],[$String],false)]]);var $Map=function(){};(function(){var names=Object.getOwnPropertyNames(Object.prototype),i;for(i=0;i<names.length;i++){$Map.prototype[names[i]]=undefined;}})();var $mapTypes={};var $mapType=function(key,elem){var string="map["+key.string+"]"+elem.string;var typ=$mapTypes[string];if(typ===undefined){typ=$newType(4,"Map",string,"","",null);typ.init(key,elem);$mapTypes[string]=typ;}return typ;};var $throwNilPointerError=function(){$throwRuntimeError("invalid memory address or nil pointer dereference");};var $ptrType=function(elem){var typ=elem.Ptr;if(typ===undefined){typ=$newType(4,"Ptr","*"+elem.string,"","",null);typ.init(elem);elem.Ptr=typ;}return typ;};var $stringPtrMap=new $Map();var $newStringPtr=function(str){if(str===undefined||str===""){return $ptrType($String).nil;}var ptr=$stringPtrMap[str];if(ptr===undefined){ptr=new($ptrType($String))(function(){return str;},function(v){str=v;});$stringPtrMap[str]=ptr;}return ptr;};var $newDataPointer=function(data,constructor){if(constructor.Struct){return data;}return new constructor(function(){return data;},function(v){data=v;});};var $sliceType=function(elem){var typ=elem.Slice;if(typ===undefined){typ=$newType(12,"Slice","[]"+elem.string,"","",null);typ.init(elem);elem.Slice=typ;}return typ;};var $structTypes={};var $structType=function(fields){var string="struct { "+$mapArray(fields,function(f){return f[1]+" "+f[3].string+(f[4]!==""?(" \""+f[4].replace(/\\/g,"\\\\").replace(/"/g, "\\\"")+"\""):"");}).join("; ")+" }";if(fields.length===0){string="struct {}";}var typ=$structTypes[string];if(typ===undefined){typ=$newType(0,"Struct",string,"","",function(){this.$val=this;var i;for(i=0;i<fields.length;i++){var field=fields[i];var arg=arguments[i];this[field[0]]=arg!==undefined?arg:field[3].zero();}});var i,j;for(i=0;i<fields.length;i++){var field=fields[i];if(field[1]===""){var methods=field[3].methods;for(j=0;j<methods.length;j++){var m=methods[j].slice(0,6).concat([i]);typ.methods.push(m);typ.Ptr.methods.push(m);}if(field[3].kind==="Struct"){var methods=field[3].Ptr.methods;for(j=0;j<methods.length;j++){typ.Ptr.methods.push(methods[j].slice(0,6).concat([i]));}}}}typ.init(fields);$structTypes[string]=typ;}return typ;};var $assertType=function(value,type,returnTuple){var isInterface=(type.kind==="Interface"),ok,missingMethod="";if(value===$ifaceNil){ok=false;}else if(!isInterface){ok=value.constructor===type;}else if(type.string==="js.Object"){ok=true;}else{var valueTypeString=value.constructor.string;ok=type.implementedBy[valueTypeString];if(ok===undefined){ok=true;var valueMethods=value.constructor.methods;var typeMethods=type.methods;for(var i=0;i<typeMethods.length;i++){var tm=typeMethods[i];var found=false;for(var j=0;j<valueMethods.length;j++){var vm=valueMethods[j];if(vm[1]===tm[1]&&vm[2]===tm[2]&&vm[3]===tm[3]){found=true;break;}}if(!found){ok=false;type.missingMethodFor[valueTypeString]=tm[1];break;}}type.implementedBy[valueTypeString]=ok;}if(!ok){missingMethod=type.missingMethodFor[valueTypeString];}}if(!ok){if(returnTuple){return[type.zero(),false];}$panic(new $packages["runtime"].TypeAssertionError.Ptr("",(value===$ifaceNil?"":value.constructor.string),type.string,missingMethod));}if(!isInterface){value=value.$val;}return returnTuple?[value,true]:value;};var $coerceFloat32=function(f){var math=$packages["math"];if(math===undefined){return f;}return math.Float32frombits(math.Float32bits(f));};var $floatKey=function(f){if(f!==f){$idCounter++;return"NaN$"+$idCounter;}return String(f);};var $flatten64=function(x){return x.$high*4294967296+x.$low;};var $shiftLeft64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high<<y|x.$low>>>(32-y),(x.$low<<y)>>>0);}if(y<64){return new x.constructor(x.$low<<(y-32),0);}return new x.constructor(0,0);};var $shiftRightInt64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(x.$high>>31,(x.$high>>(y-32))>>>0);}if(x.$high<0){return new x.constructor(-1,4294967295);}return new x.constructor(0,0);};var $shiftRightUint64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(0,x.$high>>>(y-32));}return new x.constructor(0,0);};var $mul64=function(x,y){var high=0,low=0,i;if((y.$low&1)!==0){high=x.$high;low=x.$low;}for(i=1;i<32;i++){if((y.$low&1<<i)!==0){high+=x.$high<<i|x.$low>>>(32-i);low+=(x.$low<<i)>>>0;}}for(i=0;i<32;i++){if((y.$high&1<<i)!==0){high+=x.$low<<i;}}return new x.constructor(high,low);};var $div64=function(x,y,returnRemainder){if(y.$high===0&&y.$low===0){$throwRuntimeError("integer divide by zero");}var s=1;var rs=1;var xHigh=x.$high;var xLow=x.$low;if(xHigh<0){s=-1;rs=-1;xHigh=-xHigh;if(xLow!==0){xHigh--;xLow=4294967296-xLow;}}var yHigh=y.$high;var yLow=y.$low;if(y.$high<0){s*=-1;yHigh=-yHigh;if(yLow!==0){yHigh--;yLow=4294967296-yLow;}}var high=0,low=0,n=0,i;while(yHigh<2147483648&&((xHigh>yHigh)||(xHigh===yHigh&&xLow>yLow))){yHigh=(yHigh<<1|yLow>>>31)>>>0;yLow=(yLow<<1)>>>0;n++;}for(i=0;i<=n;i++){high=high<<1|low>>>31;low=(low<<1)>>>0;if((xHigh>yHigh)||(xHigh===yHigh&&xLow>=yLow)){xHigh=xHigh-yHigh;xLow=xLow-yLow;if(xLow<0){xHigh--;xLow+=4294967296;}low++;if(low===4294967296){high++;low=0;}}yLow=(yLow>>>1|yHigh<<(32-1))>>>0;yHigh=yHigh>>>1;}if(returnRemainder){return new x.constructor(xHigh*rs,xLow*rs);}return new x.constructor(high*s,low*s);};var $divComplex=function(n,d){var ninf=n.$real===1/0||n.$real===-1/0||n.$imag===1/0||n.$imag===-1/0;var dinf=d.$real===1/0||d.$real===-1/0||d.$imag===1/0||d.$imag===-1/0;var nnan=!ninf&&(n.$real!==n.$real||n.$imag!==n.$imag);var dnan=!dinf&&(d.$real!==d.$real||d.$imag!==d.$imag);if(nnan||dnan){return new n.constructor(0/0,0/0);}if(ninf&&!dinf){return new n.constructor(1/0,1/0);}if(!ninf&&dinf){return new n.constructor(0,0);}if(d.$real===0&&d.$imag===0){if(n.$real===0&&n.$imag===0){return new n.constructor(0/0,0/0);}return new n.constructor(1/0,1/0);}var a=Math.abs(d.$real);var b=Math.abs(d.$imag);if(a<=b){var ratio=d.$real/d.$imag;var denom=d.$real*ratio+d.$imag;return new n.constructor((n.$real*ratio+n.$imag)/denom,(n.$imag*ratio-n.$real)/denom);}var ratio=d.$imag/d.$real;var denom=d.$imag*ratio+d.$real;return new n.constructor((n.$imag*ratio+n.$real)/denom,(n.$imag-n.$real*ratio)/denom);};var $stackDepthOffset=0;var $getStackDepth=function(){var err=new Error();if(err.stack===undefined){return undefined;}return $stackDepthOffset+err.stack.split("\n").length;};var $deferFrames=[],$skippedDeferFrames=0,$jumpToDefer=false,$panicStackDepth=null,$panicValue;var $callDeferred=function(deferred,jsErr){if($skippedDeferFrames!==0){$skippedDeferFrames--;throw jsErr;}if($jumpToDefer){$jumpToDefer=false;throw jsErr;}if(jsErr){var newErr=null;try{$deferFrames.push(deferred);$panic(new $packages["github.com/gopherjs/gopherjs/js"].Error.Ptr(jsErr));}catch(err){newErr=err;}$deferFrames.pop();$callDeferred(deferred,newErr);return;}$stackDepthOffset--;var outerPanicStackDepth=$panicStackDepth;var outerPanicValue=$panicValue;var localPanicValue=$curGoroutine.panicStack.pop();if(localPanicValue!==undefined){$panicStackDepth=$getStackDepth();$panicValue=localPanicValue;}var call;try{while(true){if(deferred===null){deferred=$deferFrames[$deferFrames.length-1-$skippedDeferFrames];if(deferred===undefined){if(localPanicValue.constructor===$String){throw new Error(localPanicValue.$val);}else if(localPanicValue.Error!==undefined){throw new Error(localPanicValue.Error());}else if(localPanicValue.String!==undefined){throw new Error(localPanicValue.String());}else{throw new Error(localPanicValue);}}}var call=deferred.pop();if(call===undefined){if(localPanicValue!==undefined){$skippedDeferFrames++;deferred=null;continue;}return;}var r=call[0].apply(undefined,call[1]);if(r&&r.$blocking){deferred.push([r,[]]);}if(localPanicValue!==undefined&&$panicStackDepth===null){throw null;}}}finally{if($curGoroutine.asleep){deferred.push(call);$jumpToDefer=true;}if(localPanicValue!==undefined){if($panicStackDepth!==null){$curGoroutine.panicStack.push(localPanicValue);}$panicStackDepth=outerPanicStackDepth;$panicValue=outerPanicValue;}$stackDepthOffset++;}};var $panic=function(value){$curGoroutine.panicStack.push(value);$callDeferred(null,null);};var $recover=function(){if($panicStackDepth===null||($panicStackDepth!==undefined&&$panicStackDepth!==$getStackDepth()-2)){return $ifaceNil;}$panicStackDepth=null;return $panicValue;};var $nonblockingCall=function(){$panic(new $packages["runtime"].NotSupportedError.Ptr("non-blocking call to blocking function (mark call with \"//gopherjs:blocking\" to fix)"));};var $throw=function(err){throw err;};var $throwRuntimeError;var $dummyGoroutine={asleep:false,exit:false,panicStack:[]};var $curGoroutine=$dummyGoroutine,$totalGoroutines=0,$awakeGoroutines=0,$checkForDeadlock=true;var $go=function(fun,args,direct){$totalGoroutines++;$awakeGoroutines++;args.push(true);var goroutine=function(){var rescheduled=false;try{$curGoroutine=goroutine;$skippedDeferFrames=0;$jumpToDefer=false;var r=fun.apply(undefined,args);if(r&&r.$blocking){fun=r;args=[];$schedule(goroutine,direct);rescheduled=true;return;}goroutine.exit=true;}catch(err){if(!$curGoroutine.asleep){goroutine.exit=true;throw err;}}finally{$curGoroutine=$dummyGoroutine;if(goroutine.exit&&!rescheduled){$totalGoroutines--;goroutine.asleep=true;}if(goroutine.asleep&&!rescheduled){$awakeGoroutines--;if($awakeGoroutines===0&&$totalGoroutines!==0&&$checkForDeadlock){console.error("fatal error: all goroutines are asleep - deadlock!");}}}};goroutine.asleep=false;goroutine.exit=false;goroutine.panicStack=[];$schedule(goroutine,direct);};var $scheduled=[],$schedulerLoopActive=false;var $schedule=function(goroutine,direct){if(goroutine.asleep){goroutine.asleep=false;$awakeGoroutines++;}if(direct){goroutine();return;}$scheduled.push(goroutine);if(!$schedulerLoopActive){$schedulerLoopActive=true;setTimeout(function(){while(true){var r=$scheduled.shift();if(r===undefined){$schedulerLoopActive=false;break;}r();};},0);}};var $send=function(chan,value){if(chan.$closed){$throwRuntimeError("send on closed channel");}var queuedRecv=chan.$recvQueue.shift();if(queuedRecv!==undefined){queuedRecv([value,true]);return;}if(chan.$buffer.length<chan.$capacity){chan.$buffer.push(value);return;}var thisGoroutine=$curGoroutine;chan.$sendQueue.push(function(){$schedule(thisGoroutine);return value;});var blocked=false;var f=function(){if(blocked){if(chan.$closed){$throwRuntimeError("send on closed channel");}return;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $recv=function(chan){var queuedSend=chan.$sendQueue.shift();if(queuedSend!==undefined){chan.$buffer.push(queuedSend());}var bufferedValue=chan.$buffer.shift();if(bufferedValue!==undefined){return[bufferedValue,true];}if(chan.$closed){return[chan.constructor.elem.zero(),false];}var thisGoroutine=$curGoroutine,value;var queueEntry=function(v){value=v;$schedule(thisGoroutine);};chan.$recvQueue.push(queueEntry);var blocked=false;var f=function(){if(blocked){return value;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $close=function(chan){if(chan.$closed){$throwRuntimeError("close of closed channel");}chan.$closed=true;while(true){var queuedSend=chan.$sendQueue.shift();if(queuedSend===undefined){break;}queuedSend();}while(true){var queuedRecv=chan.$recvQueue.shift();if(queuedRecv===undefined){break;}queuedRecv([chan.constructor.elem.zero(),false]);}};var $select=function(comms){var ready=[],i;var selection=-1;for(i=0;i<comms.length;i++){var comm=comms[i];var chan=comm[0];switch(comm.length){case 0:selection=i;break;case 1:if(chan.$sendQueue.length!==0||chan.$buffer.length!==0||chan.$closed){ready.push(i);}break;case 2:if(chan.$closed){$throwRuntimeError("send on closed channel");}if(chan.$recvQueue.length!==0||chan.$buffer.length<chan.$capacity){ready.push(i);}break;}}if(ready.length!==0){selection=ready[Math.floor(Math.random()*ready.length)];}if(selection!==-1){var comm=comms[selection];switch(comm.length){case 0:return[selection];case 1:return[selection,$recv(comm[0])];case 2:$send(comm[0],comm[1]);return[selection];}}var entries=[];var thisGoroutine=$curGoroutine;var removeFromQueues=function(){for(i=0;i<entries.length;i++){var entry=entries[i];var queue=entry[0];var index=queue.indexOf(entry[1]);if(index!==-1){queue.splice(index,1);}}};for(i=0;i<comms.length;i++){(function(i){var comm=comms[i];switch(comm.length){case 1:var queueEntry=function(value){selection=[i,value];removeFromQueues();$schedule(thisGoroutine);};entries.push([comm[0].$recvQueue,queueEntry]);comm[0].$recvQueue.push(queueEntry);break;case 2:var queueEntry=function(){if(comm[0].$closed){$throwRuntimeError("send on closed channel");}selection=[i];removeFromQueues();$schedule(thisGoroutine);return comm[1];};entries.push([comm[0].$sendQueue,queueEntry]);comm[0].$sendQueue.push(queueEntry);break;}})(i);}var blocked=false;var f=function(){if(blocked){return selection;};blocked=true;$curGoroutine.asleep=true;throw null;};f.$blocking=true;return f;};var $needsExternalization=function(t){switch(t.kind){case"Bool":case"Int":case"Int8":case"Int16":case"Int32":case"Uint":case"Uint8":case"Uint16":case"Uint32":case"Uintptr":case"Float32":case"Float64":return false;case"Interface":return t!==$packages["github.com/gopherjs/gopherjs/js"].Object;default:return true;}};var $externalize=function(v,t){switch(t.kind){case"Bool":case"Int":case"Int8":case"Int16":case"Int32":case"Uint":case"Uint8":case"Uint16":case"Uint32":case"Uintptr":case"Float32":case"Float64":return v;case"Int64":case"Uint64":return $flatten64(v);case"Array":if($needsExternalization(t.elem)){return $mapArray(v,function(e){return $externalize(e,t.elem);});}return v;case"Func":if(v===$throwNilPointerError){return null;}if(v.$externalizeWrapper===undefined){$checkForDeadlock=false;var convert=false;var i;for(i=0;i<t.params.length;i++){convert=convert||(t.params[i]!==$packages["github.com/gopherjs/gopherjs/js"].Object);}for(i=0;i<t.results.length;i++){convert=convert||$needsExternalization(t.results[i]);}if(!convert){return v;}v.$externalizeWrapper=function(){var args=[],i;for(i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=[],j;for(j=i;j<arguments.length;j++){varargs.push($internalize(arguments[j],vt));}args.push(new(t.params[i])(varargs));break;}args.push($internalize(arguments[i],t.params[i]));}var result=v.apply(this,args);switch(t.results.length){case 0:return;case 1:return $externalize(result,t.results[0]);default:for(i=0;i<t.results.length;i++){result[i]=$externalize(result[i],t.results[i]);}return result;}};}return v.$externalizeWrapper;case"Interface":if(v===$ifaceNil){return null;}if(t===$packages["github.com/gopherjs/gopherjs/js"].Object||v.constructor.kind===undefined){return v;}return $externalize(v.$val,v.constructor);case"Map":var m={};var keys=$keys(v),i;for(i=0;i<keys.length;i++){var entry=v[keys[i]];m[$externalize(entry.k,t.key)]=$externalize(entry.v,t.elem);}return m;case"Ptr":var o={},i;for(i=0;i<t.methods.length;i++){var m=t.methods[i];if(m[2]!==""){continue;}(function(m){o[m[1]]=$externalize(function(){return v[m[0]].apply(v,arguments);},m[3]);})(m);}return o;case"Slice":if($needsExternalization(t.elem)){return $mapArray($sliceToArray(v),function(e){return $externalize(e,t.elem);});}return $sliceToArray(v);case"String":var s="",r,i,j=0;for(i=0;i<v.length;i+=r[1],j++){r=$decodeRune(v,i);s+=String.fromCharCode(r[0]);}return s;case"Struct":var timePkg=$packages["time"];if(timePkg&&v.constructor===timePkg.Time.Ptr){var milli=$div64(v.UnixNano(),new $Int64(0,1000000));return new Date($flatten64(milli));}var o={},i;for(i=0;i<t.fields.length;i++){var f=t.fields[i];if(f[2]!==""){continue;}o[f[1]]=$externalize(v[f[0]],f[3]);}return o;}$panic(new $String("cannot externalize "+t.string));};var $internalize=function(v,t,recv){switch(t.kind){case"Bool":return!!v;case"Int":return parseInt(v);case"Int8":return parseInt(v)<<24>>24;case"Int16":return parseInt(v)<<16>>16;case"Int32":return parseInt(v)>>0;case"Uint":return parseInt(v);case"Uint8":return parseInt(v)<<24>>>24;case"Uint16":return parseInt(v)<<16>>>16;case"Uint32":case"Uintptr":return parseInt(v)>>>0;case"Int64":case"Uint64":return new t(0,v);case"Float32":case"Float64":return parseFloat(v);case"Array":if(v.length!==t.len){$throwRuntimeError("got array with wrong size from JavaScript native");}return $mapArray(v,function(e){return $internalize(e,t.elem);});case"Func":return function(){var args=[],i;for(i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=arguments[i],j;for(j=0;j<varargs.$length;j++){args.push($externalize(varargs.$array[varargs.$offset+j],vt));}break;}args.push($externalize(arguments[i],t.params[i]));}var result=v.apply(recv,args);switch(t.results.length){case 0:return;case 1:return $internalize(result,t.results[0]);default:for(i=0;i<t.results.length;i++){result[i]=$internalize(result[i],t.results[i]);}return result;}};case"Interface":if(t===$packages["github.com/gopherjs/gopherjs/js"].Object){return v;}if(v===null){return $ifaceNil;}switch(v.constructor){case Int8Array:return new($sliceType($Int8))(v);case Int16Array:return new($sliceType($Int16))(v);case Int32Array:return new($sliceType($Int))(v);case Uint8Array:return new($sliceType($Uint8))(v);case Uint16Array:return new($sliceType($Uint16))(v);case Uint32Array:return new($sliceType($Uint))(v);case Float32Array:return new($sliceType($Float32))(v);case Float64Array:return new($sliceType($Float64))(v);case Array:return $internalize(v,$sliceType($emptyInterface));case Boolean:return new $Bool(!!v);case Date:var timePkg=$packages["time"];if(timePkg){return new timePkg.Time(timePkg.Unix(new $Int64(0,0),new $Int64(0,v.getTime()*1000000)));}case Function:var funcType=$funcType([$sliceType($emptyInterface)],[$packages["github.com/gopherjs/gopherjs/js"].Object],true);return new funcType($internalize(v,funcType));case Number:return new $Float64(parseFloat(v));case String:return new $String($internalize(v,$String));default:if($global.Node&&v instanceof $global.Node){return v;}var mapType=$mapType($String,$emptyInterface);return new mapType($internalize(v,mapType));}case"Map":var m=new $Map();var keys=$keys(v),i;for(i=0;i<keys.length;i++){var key=$internalize(keys[i],t.key);m[key.$key?key.$key():key]={k:key,v:$internalize(v[keys[i]],t.elem)};}return m;case"Slice":return new t($mapArray(v,function(e){return $internalize(e,t.elem);}));case"String":v=String(v);var s="",i;for(i=0;i<v.length;i++){s+=$encodeRune(v.charCodeAt(i));}return s;default:$panic(new $String("cannot internalize "+t.string));}};
$packages["github.com/gopherjs/gopherjs/js"]=(function(){var $pkg={},A,B,H;A=$pkg.Object=$newType(8,"Interface","js.Object","Object","github.com/gopherjs/gopherjs/js",null);B=$pkg.Error=$newType(0,"Struct","js.Error","Error","github.com/gopherjs/gopherjs/js",function(Object_){this.$val=this;this.Object=Object_!==undefined?Object_:$ifaceNil;});B.Ptr.prototype.Error=function(){var a;a=this;return"JavaScript error: "+$internalize(a.Object.message,$String);};B.prototype.Error=function(){return this.$val.Error();};H=function(){var a;a=new B.Ptr($ifaceNil);};$pkg.$init=function(){A.init([["Bool","Bool","",$funcType([],[$Bool],false)],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true)],["Delete","Delete","",$funcType([$String],[],false)],["Float","Float","",$funcType([],[$Float64],false)],["Get","Get","",$funcType([$String],[A],false)],["Index","Index","",$funcType([$Int],[A],false)],["Int","Int","",$funcType([],[$Int],false)],["Int64","Int64","",$funcType([],[$Int64],false)],["Interface","Interface","",$funcType([],[$emptyInterface],false)],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true)],["IsNull","IsNull","",$funcType([],[$Bool],false)],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false)],["Length","Length","",$funcType([],[$Int],false)],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true)],["Set","Set","",$funcType([$String,$emptyInterface],[],false)],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false)],["Str","Str","",$funcType([],[$String],false)],["Uint64","Uint64","",$funcType([],[$Uint64],false)],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false)]]);B.methods=[["Bool","Bool","",$funcType([],[$Bool],false),0],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true),0],["Delete","Delete","",$funcType([$String],[],false),0],["Float","Float","",$funcType([],[$Float64],false),0],["Get","Get","",$funcType([$String],[A],false),0],["Index","Index","",$funcType([$Int],[A],false),0],["Int","Int","",$funcType([],[$Int],false),0],["Int64","Int64","",$funcType([],[$Int64],false),0],["Interface","Interface","",$funcType([],[$emptyInterface],false),0],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true),0],["IsNull","IsNull","",$funcType([],[$Bool],false),0],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false),0],["Length","Length","",$funcType([],[$Int],false),0],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true),0],["Set","Set","",$funcType([$String,$emptyInterface],[],false),0],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false),0],["Str","Str","",$funcType([],[$String],false),0],["Uint64","Uint64","",$funcType([],[$Uint64],false),0],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false),0]];($ptrType(B)).methods=[["Bool","Bool","",$funcType([],[$Bool],false),0],["Call","Call","",$funcType([$String,($sliceType($emptyInterface))],[A],true),0],["Delete","Delete","",$funcType([$String],[],false),0],["Error","Error","",$funcType([],[$String],false),-1],["Float","Float","",$funcType([],[$Float64],false),0],["Get","Get","",$funcType([$String],[A],false),0],["Index","Index","",$funcType([$Int],[A],false),0],["Int","Int","",$funcType([],[$Int],false),0],["Int64","Int64","",$funcType([],[$Int64],false),0],["Interface","Interface","",$funcType([],[$emptyInterface],false),0],["Invoke","Invoke","",$funcType([($sliceType($emptyInterface))],[A],true),0],["IsNull","IsNull","",$funcType([],[$Bool],false),0],["IsUndefined","IsUndefined","",$funcType([],[$Bool],false),0],["Length","Length","",$funcType([],[$Int],false),0],["New","New","",$funcType([($sliceType($emptyInterface))],[A],true),0],["Set","Set","",$funcType([$String,$emptyInterface],[],false),0],["SetIndex","SetIndex","",$funcType([$Int,$emptyInterface],[],false),0],["Str","Str","",$funcType([],[$String],false),0],["Uint64","Uint64","",$funcType([],[$Uint64],false),0],["Unsafe","Unsafe","",$funcType([],[$Uintptr],false),0]];B.init([["Object","","",A,""]]);H();};return $pkg;})();
$packages["runtime"]=(function(){var $pkg={},A=$packages["github.com/gopherjs/gopherjs/js"],B,AC,AE,AW,AX,C,AY;B=$pkg.NotSupportedError=$newType(0,"Struct","runtime.NotSupportedError","NotSupportedError","runtime",function(Feature_){this.$val=this;this.Feature=Feature_!==undefined?Feature_:"";});AC=$pkg.TypeAssertionError=$newType(0,"Struct","runtime.TypeAssertionError","TypeAssertionError","runtime",function(interfaceString_,concreteString_,assertedString_,missingMethod_){this.$val=this;this.interfaceString=interfaceString_!==undefined?interfaceString_:"";this.concreteString=concreteString_!==undefined?concreteString_:"";this.assertedString=assertedString_!==undefined?assertedString_:"";this.missingMethod=missingMethod_!==undefined?missingMethod_:"";});AE=$pkg.errorString=$newType(8,"String","runtime.errorString","errorString","runtime",null);AW=$pkg.MemStats=$newType(0,"Struct","runtime.MemStats","MemStats","runtime",function(Alloc_,TotalAlloc_,Sys_,Lookups_,Mallocs_,Frees_,HeapAlloc_,HeapSys_,HeapIdle_,HeapInuse_,HeapReleased_,HeapObjects_,StackInuse_,StackSys_,MSpanInuse_,MSpanSys_,MCacheInuse_,MCacheSys_,BuckHashSys_,GCSys_,OtherSys_,NextGC_,LastGC_,PauseTotalNs_,PauseNs_,NumGC_,EnableGC_,DebugGC_,BySize_){this.$val=this;this.Alloc=Alloc_!==undefined?Alloc_:new $Uint64(0,0);this.TotalAlloc=TotalAlloc_!==undefined?TotalAlloc_:new $Uint64(0,0);this.Sys=Sys_!==undefined?Sys_:new $Uint64(0,0);this.Lookups=Lookups_!==undefined?Lookups_:new $Uint64(0,0);this.Mallocs=Mallocs_!==undefined?Mallocs_:new $Uint64(0,0);this.Frees=Frees_!==undefined?Frees_:new $Uint64(0,0);this.HeapAlloc=HeapAlloc_!==undefined?HeapAlloc_:new $Uint64(0,0);this.HeapSys=HeapSys_!==undefined?HeapSys_:new $Uint64(0,0);this.HeapIdle=HeapIdle_!==undefined?HeapIdle_:new $Uint64(0,0);this.HeapInuse=HeapInuse_!==undefined?HeapInuse_:new $Uint64(0,0);this.HeapReleased=HeapReleased_!==undefined?HeapReleased_:new $Uint64(0,0);this.HeapObjects=HeapObjects_!==undefined?HeapObjects_:new $Uint64(0,0);this.StackInuse=StackInuse_!==undefined?StackInuse_:new $Uint64(0,0);this.StackSys=StackSys_!==undefined?StackSys_:new $Uint64(0,0);this.MSpanInuse=MSpanInuse_!==undefined?MSpanInuse_:new $Uint64(0,0);this.MSpanSys=MSpanSys_!==undefined?MSpanSys_:new $Uint64(0,0);this.MCacheInuse=MCacheInuse_!==undefined?MCacheInuse_:new $Uint64(0,0);this.MCacheSys=MCacheSys_!==undefined?MCacheSys_:new $Uint64(0,0);this.BuckHashSys=BuckHashSys_!==undefined?BuckHashSys_:new $Uint64(0,0);this.GCSys=GCSys_!==undefined?GCSys_:new $Uint64(0,0);this.OtherSys=OtherSys_!==undefined?OtherSys_:new $Uint64(0,0);this.NextGC=NextGC_!==undefined?NextGC_:new $Uint64(0,0);this.LastGC=LastGC_!==undefined?LastGC_:new $Uint64(0,0);this.PauseTotalNs=PauseTotalNs_!==undefined?PauseTotalNs_:new $Uint64(0,0);this.PauseNs=PauseNs_!==undefined?PauseNs_:($arrayType($Uint64,256)).zero();this.NumGC=NumGC_!==undefined?NumGC_:0;this.EnableGC=EnableGC_!==undefined?EnableGC_:false;this.DebugGC=DebugGC_!==undefined?DebugGC_:false;this.BySize=BySize_!==undefined?BySize_:($arrayType(($structType([["Size","Size","",$Uint32,""],["Mallocs","Mallocs","",$Uint64,""],["Frees","Frees","",$Uint64,""]])),61)).zero();});B.Ptr.prototype.Error=function(){var k;k=this;return"not supported by GopherJS: "+k.Feature;};B.prototype.Error=function(){return this.$val.Error();};C=function(){var k;$throwRuntimeError=(function(k){$panic(new AE(k));});k=$ifaceNil;k=new AC.Ptr("","","","");k=new B.Ptr("");};AC.Ptr.prototype.RuntimeError=function(){};AC.prototype.RuntimeError=function(){return this.$val.RuntimeError();};AC.Ptr.prototype.Error=function(){var k,l;k=this;l=k.interfaceString;if(l===""){l="interface";}if(k.concreteString===""){return"interface conversion: "+l+" is nil, not "+k.assertedString;}if(k.missingMethod===""){return"interface conversion: "+l+" is "+k.concreteString+", not "+k.assertedString;}return"interface conversion: "+k.concreteString+" is not "+k.assertedString+": missing method "+k.missingMethod;};AC.prototype.Error=function(){return this.$val.Error();};AE.prototype.RuntimeError=function(){var k;k=this.$val!==undefined?this.$val:this;};$ptrType(AE).prototype.RuntimeError=function(){return new AE(this.$get()).RuntimeError();};AE.prototype.Error=function(){var k;k=this.$val!==undefined?this.$val:this;return"runtime error: "+k;};$ptrType(AE).prototype.Error=function(){return new AE(this.$get()).Error();};AY=function(){var k;k=new AW.Ptr();$copy(k,new AW.Ptr(),AW);if(!((AX===3712))){console.log(AX,3712);$panic(new $String("MStats vs MemStatsType size mismatch"));}};$pkg.$init=function(){($ptrType(B)).methods=[["Error","Error","",$funcType([],[$String],false),-1]];B.init([["Feature","Feature","",$String,""]]);($ptrType(AC)).methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];AC.init([["interfaceString","interfaceString","runtime",$String,""],["concreteString","concreteString","runtime",$String,""],["assertedString","assertedString","runtime",$String,""],["missingMethod","missingMethod","runtime",$String,""]]);AE.methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];($ptrType(AE)).methods=[["Error","Error","",$funcType([],[$String],false),-1],["RuntimeError","RuntimeError","",$funcType([],[],false),-1]];AW.init([["Alloc","Alloc","",$Uint64,""],["TotalAlloc","TotalAlloc","",$Uint64,""],["Sys","Sys","",$Uint64,""],["Lookups","Lookups","",$Uint64,""],["Mallocs","Mallocs","",$Uint64,""],["Frees","Frees","",$Uint64,""],["HeapAlloc","HeapAlloc","",$Uint64,""],["HeapSys","HeapSys","",$Uint64,""],["HeapIdle","HeapIdle","",$Uint64,""],["HeapInuse","HeapInuse","",$Uint64,""],["HeapReleased","HeapReleased","",$Uint64,""],["HeapObjects","HeapObjects","",$Uint64,""],["StackInuse","StackInuse","",$Uint64,""],["StackSys","StackSys","",$Uint64,""],["MSpanInuse","MSpanInuse","",$Uint64,""],["MSpanSys","MSpanSys","",$Uint64,""],["MCacheInuse","MCacheInuse","",$Uint64,""],["MCacheSys","MCacheSys","",$Uint64,""],["BuckHashSys","BuckHashSys","",$Uint64,""],["GCSys","GCSys","",$Uint64,""],["OtherSys","OtherSys","",$Uint64,""],["NextGC","NextGC","",$Uint64,""],["LastGC","LastGC","",$Uint64,""],["PauseTotalNs","PauseTotalNs","",$Uint64,""],["PauseNs","PauseNs","",($arrayType($Uint64,256)),""],["NumGC","NumGC","",$Uint32,""],["EnableGC","EnableGC","",$Bool,""],["DebugGC","DebugGC","",$Bool,""],["BySize","BySize","",($arrayType(($structType([["Size","Size","",$Uint32,""],["Mallocs","Mallocs","",$Uint64,""],["Frees","Frees","",$Uint64,""]])),61)),""]]);AX=3712;C();AY();};return $pkg;})();
$packages["errors"]=(function(){var $pkg={},B,A;B=$pkg.errorString=$newType(0,"Struct","errors.errorString","errorString","errors",function(s_){this.$val=this;this.s=s_!==undefined?s_:"";});A=$pkg.New=function(a){return new B.Ptr(a);};B.Ptr.prototype.Error=function(){var a;a=this;return a.s;};B.prototype.Error=function(){return this.$val.Error();};$pkg.$init=function(){($ptrType(B)).methods=[["Error","Error","",$funcType([],[$String],false),-1]];B.init([["s","s","errors",$String,""]]);};return $pkg;})();
$packages["sort"]=(function(){var $pkg={},A;A=$pkg.Search=function(a,b){var c,d,e,f,g,h;c=0;d=a;e=c;f=d;while(e<f){h=e+(g=((f-e>>0))/2,(g===g&&g!==1/0&&g!==-1/0)?g>>0:$throwRuntimeError("integer divide by zero"))>>0;if(!b(h)){e=h+1>>0;}else{f=h;}}return e;};$pkg.$init=function(){};return $pkg;})();
$packages["ninchatclient"]=(function(){var $pkg={},A=$packages["errors"],B=$packages["github.com/gopherjs/gopherjs/js"],C=$packages["sort"],D,L,AN,AO,AR,AS,AU,AV,AX,BA,AC,AL,AQ,E,F,G,H,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,AB,AD,AE,AF,AG,AH,AI,AJ,AK,AM,AP,AT,AW,AY,AZ,BB,BC,BD,BE,BF,BG;D=$pkg.Action=$newType(0,"Struct","main.Action","Action","ninchatclient",function(Id_,Header_,Payload_,Resolve_,name_){this.$val=this;this.Id=Id_!==undefined?Id_:new $Uint64(0,0);this.Header=Header_!==undefined?Header_:$ifaceNil;this.Payload=Payload_!==undefined?Payload_:$ifaceNil;this.Resolve=Resolve_!==undefined?Resolve_:$throwNilPointerError;this.name=name_!==undefined?name_:"";});L=$pkg.Backoff=$newType(0,"Struct","main.Backoff","Backoff","ninchatclient",function(lastSlot_){this.$val=this;this.lastSlot=lastSlot_!==undefined?lastSlot_:0;});AN=$pkg.PromiseResolver=$newType(4,"Func","main.PromiseResolver","PromiseResolver","ninchatclient",null);AO=$pkg.Promise=$newType(0,"Struct","main.Promise","Promise","ninchatclient",function(settled_,successful_,args_,successCallbacks_,failureCallbacks_){this.$val=this;this.settled=settled_!==undefined?settled_:false;this.successful=successful_!==undefined?successful_:false;this.args=args_!==undefined?args_:($sliceType($emptyInterface)).nil;this.successCallbacks=successCallbacks_!==undefined?successCallbacks_:($sliceType(B.Object)).nil;this.failureCallbacks=failureCallbacks_!==undefined?failureCallbacks_:($sliceType(B.Object)).nil;});AR=$pkg.Transport=$newType(4,"Func","main.Transport","Transport","ninchatclient",null);AS=$pkg.Session=$newType(0,"Struct","main.Session","Session","ninchatclient",function(onSessionEvent_,onEvent_,onConnState_,onConnActive_,onLog_,address_,forceLongPoll_,sessionParams_,sessionId_,latestConnState_,latestConnActive_,lastActionId_,sendNotify_,sendBuffer_,numSent_,sendEventAck_,receivedEventId_,ackedEventId_,closeNotify_,closed_,stopped_){this.$val=this;this.onSessionEvent=onSessionEvent_!==undefined?onSessionEvent_:$ifaceNil;this.onEvent=onEvent_!==undefined?onEvent_:$ifaceNil;this.onConnState=onConnState_!==undefined?onConnState_:$ifaceNil;this.onConnActive=onConnActive_!==undefined?onConnActive_:$ifaceNil;this.onLog=onLog_!==undefined?onLog_:$ifaceNil;this.address=address_!==undefined?address_:"";this.forceLongPoll=forceLongPoll_!==undefined?forceLongPoll_:false;this.sessionParams=sessionParams_!==undefined?sessionParams_:$ifaceNil;this.sessionId=sessionId_!==undefined?sessionId_:$ifaceNil;this.latestConnState=latestConnState_!==undefined?latestConnState_:"";this.latestConnActive=latestConnActive_!==undefined?latestConnActive_:new AU(0,0);this.lastActionId=lastActionId_!==undefined?lastActionId_:new $Uint64(0,0);this.sendNotify=sendNotify_!==undefined?sendNotify_:($chanType($Bool,false,false)).nil;this.sendBuffer=sendBuffer_!==undefined?sendBuffer_:($sliceType(($ptrType(D)))).nil;this.numSent=numSent_!==undefined?numSent_:0;this.sendEventAck=sendEventAck_!==undefined?sendEventAck_:false;this.receivedEventId=receivedEventId_!==undefined?receivedEventId_:new $Uint64(0,0);this.ackedEventId=ackedEventId_!==undefined?ackedEventId_:new $Uint64(0,0);this.closeNotify=closeNotify_!==undefined?closeNotify_:($chanType($Bool,false,false)).nil;this.closed=closed_!==undefined?closed_:false;this.stopped=stopped_!==undefined?stopped_:false;});AU=$pkg.Time=$newType(8,"Int64","main.Time","Time","ninchatclient",null);AV=$pkg.Duration=$newType(8,"Int64","main.Duration","Duration","ninchatclient",null);AX=$pkg.Timer=$newType(0,"Struct","main.Timer","Timer","ninchatclient",function(C_,id_){this.$val=this;this.C=C_!==undefined?C_:($chanType($Bool,false,false)).nil;this.id=id_!==undefined?id_:$ifaceNil;});BA=$pkg.WebSocket=$newType(0,"Struct","main.WebSocket","WebSocket","ninchatclient",function(Notify_,impl_,open_,error_,buffer_){this.$val=this;this.Notify=Notify_!==undefined?Notify_:($chanType($Bool,false,false)).nil;this.impl=impl_!==undefined?impl_:$ifaceNil;this.open=open_!==undefined?open_:false;this.error=error_!==undefined?error_:$ifaceNil;this.buffer=buffer_!==undefined?buffer_:($sliceType(B.Object)).nil;});D.Ptr.prototype.Name=function(){var a;a=this;if(a.name===""){a.name=$internalize(a.Header.action,$String);}return a.name;};D.prototype.Name=function(){return this.$val.Name();};E=$pkg.GetAddress=function(a){if((a===undefined)||(a===null)){return"api.ninchat.com";}else{return $internalize(a,$String);}};F=$pkg.GetEndpointHosts=function(a){var b=($sliceType($String)).nil,c=$ifaceNil,$deferred=[],$err=null,d,e;try{$deferFrames.push($deferred);$deferred.push([(function(){var d;d=Q($recover());if(!($interfaceIsEqual(d,$ifaceNil))){c=d;}}),[]]);d=a.hosts;if($parseInt(d.length)===0){c=A.New("endpoint hosts array is empty");return[b,c];}b=($sliceType($String)).make($parseInt(d.length));e=0;while(e<$parseInt(d.length)){(e<0||e>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+e]=$internalize(d[e],$String);e=e+(1)>>0;}return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};G=$pkg.GetSessionEventCredentials=function(a){var b=$ifaceNil,c=$ifaceNil,d=$ifaceNil,e=new $Uint64(0,0),f=false,g=$ifaceNil,$deferred=[],$err=null,h;try{$deferFrames.push($deferred);$deferred.push([(function(){var h;h=Q($recover());if(!($interfaceIsEqual(h,$ifaceNil))){g=h;}}),[]]);if(!($internalize(a.event,$String)==="session_created")){return[b,c,d,e,f,g];}b=a.user_id;h=a.user_auth;if(!(h===undefined)){c=h;}d=a.session_id;e=$internalize(a.event_id,$Uint64);f=true;return[b,c,d,e,f,g];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d,e,f,g];}};H=$pkg.GetEventFrames=function(a){var b=0,c=$ifaceNil,$deferred=[],$err=null,d;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);d=a.frames;if(!(d===undefined)){b=$parseInt(d)>>0;if(b<0){b=0;}}return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};I=$pkg.GetEventAndActionId=function(a){var b=new $Uint64(0,0),c=new $Uint64(0,0),d=$ifaceNil,$deferred=[],$err=null,e,f;try{$deferFrames.push($deferred);$deferred.push([(function(){d=Q($recover());}),[]]);e=a.event_id;if(!(e===undefined)){b=$internalize(e,$Uint64);}f=a.action_id;if(!(f===undefined)){c=$internalize(f,$Uint64);}return[b,c,d];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d];}};J=$pkg.IsEventLastReply=function(a,b){var c=false,d=$ifaceNil,$deferred=[],$err=null,e,f,g,h;try{$deferFrames.push($deferred);$deferred.push([(function(){d=Q($recover());}),[]]);e=b.name;if(e==="load_history"){f=$parseInt(a.history_length)>>0;c=(f===0);}else if(e==="search"){g=a.users;h=a.channels;c=(g===undefined)&&(h===undefined);}else{c=true;}return[c,d];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[c,d];}};K=$pkg.GetEventError=function(a){var b="",c="",d=false,e=$ifaceNil,$deferred=[],$err=null,f,g;try{$deferFrames.push($deferred);$deferred.push([(function(){var f;f=Q($recover());if(!($interfaceIsEqual(f,$ifaceNil))){e=f;}}),[]]);if(!($internalize(a.event,$String)==="error")){return[b,c,d,e];}b=$internalize(a.error_type,$String);f=a.error_reason;if(!(f===undefined)){c=$internalize(f,$String);}g=b;if(g==="session_not_found"){d=true;if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}else if(g==="connection_superseded"||g==="message_has_too_many_parts"||g==="message_part_too_long"||g==="message_too_long"||g==="request_malformed"){if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}return[b,c,d,e];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c,d,e];}};L.Ptr.prototype.Success=function(){var a;a=this;a.lastSlot=0;};L.prototype.Success=function(){return this.$val.Success();};L.Ptr.prototype.Failure=function(a){var b=new AV(0,0),c;c=this;if(c.lastSlot>0){b=new AV(0,N($flatten64(a)*c.lastSlot/1024,-0.5));}if(c.lastSlot<1023){c.lastSlot=((((c.lastSlot+1>>0))<<1>>0))-1>>0;}return b;};L.prototype.Failure=function(a){return this.$val.Failure(a);};M=$pkg.Call=function(a,b,c){var d=$ifaceNil,e,f,g;e="https://"+E(c)+"/v2/call";f=AP();d=f[0];g=f[1];$go((function($b){var $this=this,$args=arguments,$r,$s=0,h,i,j,k,l;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:h=AE(e,a,O(new AV(0,11000),0.1));i=h[0];j=h[1];if(!($interfaceIsEqual(j,$ifaceNil))){AG("NinchatClient.call onLog callback",b,new($sliceType($emptyInterface))([new $String("call:"),j]));g(false,new($sliceType($emptyInterface))([]));return;}k=$recv(i,true);$s=1;case 1:if(k&&k.$blocking){k=k();}l=k[0];if(!(l===$ifaceNil)){}else{$s=2;continue;}g(true,new($sliceType($emptyInterface))([l]));$s=3;continue;case 2:g(false,new($sliceType($emptyInterface))([]));case 3:case-1:}return;}};$f.$blocking=true;return $f;}),[]);return d;};N=$pkg.Jitter=function(a,b){return a+a*b*Z();};O=$pkg.JitterDuration=function(a,b){return new AV(0,N($flatten64(a),b));};P=$pkg.JitterUint64=function(a,b){return new $Uint64(0,N($flatten64(a),b));};Q=function(a){var b=$ifaceNil,c,d,e,f;if($interfaceIsEqual(a,$ifaceNil)){return b;}c=$assertType(a,($ptrType(B.Error)),true);d=c[0];e=c[1];if(e){f=$internalize(d.Object.message,$String);if(f===""){f="error";}b=A.New(f);return b;}b=$assertType(a,$error);return b;};R=function(a,b,c){var d=false,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){var e;e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){console.log(a+" invocation error: "+e.Error());}}),[]]);b.apply(undefined,$externalize(c,($sliceType($emptyInterface))));d=true;return d;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return d;}};S=$pkg.EncodeBase64=function(a){var b=$ifaceNil,c=$ifaceNil,$deferred=[],$err=null,d;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);d=$global.String.fromCharCode.apply(null,a);b=$global.btoa(d);return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};T=$pkg.NewArray=function(){return new($global.Array)();};U=$pkg.NewUint8Array=function(a){return new($global.Uint8Array)(a);};V=$pkg.NewObject=function(){return new($global.Object)();};W=$pkg.EncodeURIComponent=function(a){return $internalize($global.encodeURIComponent($externalize(a,$String)),$String);};X=$pkg.ParseJSON=function(a){var b=$ifaceNil,c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=$global.JSON.parse($externalize(a,$String));return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};Y=$pkg.StringifyJSON=function(a){var b="",c=$ifaceNil,$deferred=[],$err=null;try{$deferFrames.push($deferred);$deferred.push([(function(){c=Q($recover());}),[]]);b=$internalize($global.JSON.stringify($externalize(a,$emptyInterface)),$String);return[b,c];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[b,c];}};Z=$pkg.Random=function(){return $parseFloat($global.Math.random());};AA=$pkg.SetTimeout=function(a,b){var c=$ifaceNil;c=$global.setTimeout($externalize(a,($funcType([],[],false))),$externalize(b,AV));return c;};AB=$pkg.ClearTimeout=function(a){$global.clearTimeout(a);};AD=$pkg.JSONP=function(a,b){var c=($chanType(B.Object,false,false)).nil,d=$ifaceNil,e;e=AF(a+"?callback=",b);c=e[0];d=e[1];return[c,d];};AE=$pkg.DataJSONP=function(a,b,c){var d=($chanType(B.Object,false,false)).nil,e=$ifaceNil,f,g,h;f=Y(b);g=f[0];e=f[1];if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}h=AF(a+"?data="+W(g)+"&callback=",c);d=h[0];e=h[1];return[d,e];};AF=function(a,b){var c=($chanType(B.Object,false,false)).nil,d=$ifaceNil,$deferred=[],$err=null,e,f,g,h,i,j,k,l;try{$deferFrames.push($deferred);$deferred.push([(function(){d=Q($recover());}),[]]);e=Y(new $Int(AC));f=e[0];AC=((AC+1>>0))&2147483647;g="_callback"+f;h="NinchatClient."+g;c=new($chanType(B.Object,false,false))(1);i=AA((function(){delete AL[$externalize(g,$String)];$go((function(){$close(c);}),[]);}),b);AL[$externalize(g,$String)]=$externalize((function(j){AB(i);delete AL[$externalize(g,$String)];$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:$r=$send(c,j,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),($funcType([B.Object],[],false)));j=$global.document;k=j.createElement($externalize("script",$String));k.type=$externalize("text/javascript",$String);k.async=$externalize(true,$Bool);k.src=$externalize(a+h,$String);l=j.getElementsByTagName($externalize("head",$String))[0];l.appendChild(k);return[c,d];}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return[c,d];}};AG=$pkg.Log=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(b===$ifaceNil||(b===undefined)||(b===null)){return;}d="";e=c;f=0;while(f<e.$length){g=((f<0||f>=e.$length)?$throwRuntimeError("index out of range"):e.$array[e.$offset+f]);h="?";i=$assertType(g,$String,true);j=i[0];k=i[1];if(k){h=j;}else{l=$assertType(g,$error,true);m=l[0];n=l[1];if(n){h=m.Error();}}if(d.length>0){d=d+(" ");}d=d+(h);f++;}while(d.length>0&&(d.charCodeAt((d.length-1>>0))===32)){d=d.substring(0,(d.length-1>>0));}R(a,b,new($sliceType($emptyInterface))([new $String(d)]));};AH=$pkg.LongPollTransport=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l,m,n,o;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);while(true){switch($s){case 0:$deferred.push([(function(){var e;e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll:"),e]));}}),[true]]);c=true;e="https://"+b+"/v2/poll";if(a.sessionId===$ifaceNil){}else{$s=1;continue;}a.log(new($sliceType($emptyInterface))([new $String("session creation")]));f=a.makeCreateSessionAction();g=AE(e,f,O(new AV(0,13000),0.2));h=g[0];i=g[1];if(!($interfaceIsEqual(i,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));return[c,d];}k=$select([[h],[a.closeNotify]],true);$s=3;case 3:if(k&&k.$blocking){k=k();}j=k;if(j[0]===0){l=j[1][0];if(l===$ifaceNil){a.log(new($sliceType($emptyInterface))([new $String("session creation timeout")]));return[c,d];}m=l[0];if(!a.handleSessionEvent(m)){return[c,d];}}else if(j[0]===1){AK(a,e);return[c,d];}d=true;a.connState("connected");a.connActive();$s=2;continue;case 1:a.log(new($sliceType($emptyInterface))([new $String("session resumption")]));n=AJ(a,e);if(!($interfaceIsEqual(n,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session resumption:"),n]));return[c,d];}case 2:o=AI(a,e,true);$s=4;case 4:if(o&&o.$blocking){o=o();}if(o){}else{$s=5;continue;}d=true;case 5:return[c,d];case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[c,d];}};$f.$blocking=true;return $f;};AI=function(a,b,$b){var $this=this,$args=arguments,c=false,$r,$s=0,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:d=($chanType(B.Object,false,true)).nil;e=($chanType(B.Object,false,true)).nil;f=new $Uint64(0,0);g=0;a.numSent=0;case 1:if(!(g<2)){$s=2;continue;}if(d===($chanType(B.Object,false,true)).nil){h=$ifaceNil;i=a.makeResumeSessionAction(true);j=AE(b,i,O(new AV(0,64000),0.2));d=j[0];h=j[1];if(!($interfaceIsEqual(h,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll:"),h]));return c;}}if(e===($chanType(B.Object,false,true)).nil&&a.numSent<a.sendBuffer.$length){m=(k=a.sendBuffer,l=a.numSent,((l<0||l>=k.$length)?$throwRuntimeError("index out of range"):k.$array[k.$offset+l]));if(!(m.Payload===$ifaceNil)){n=$ifaceNil;o=$ifaceNil;p=$parseInt(m.Payload.length);q=$assertType($internalize(m.Payload[0],$emptyInterface),$String,true);r=q[0];s=q[1];if(s&&(p===1)){t=X(r);n=t[0];o=t[1];if(!($interfaceIsEqual(o,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),o]));return c;}}else{n=T();u=0;while(u<p){v=S(m.Payload[u]);w=v[0];x=v[1];if(!($interfaceIsEqual(x,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),x]));return c;}n.push(w);u=u+(1)>>0;}}m.Header.payload=n;}m.Header.session_id=a.sessionId;y=AE(b,m.Header,O(new AV(0,7000),0.2));z=y[0];aa=y[1];delete m.Header[$externalize("payload",$String)];delete m.Header[$externalize("session_id",$String)];if(!($interfaceIsEqual(aa,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),aa]));return c;}if((ab=m.Id,(ab.$high===0&&ab.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{e=z;f=m.Id;}}ac=$ifaceNil;ae=$select([[d],[e],[a.sendNotify],[a.closeNotify]],true);$s=3;case 3:if(ae&&ae.$blocking){ae=ae();}ad=ae;if(ad[0]===0){ac=ad[1][0];if(ac===$ifaceNil){a.log(new($sliceType($emptyInterface))([new $String("poll timeout")]));}d=($chanType(B.Object,false,true)).nil;a.connActive();}else if(ad[0]===1){ac=ad[1][0];if(ac===$ifaceNil){a.log(new($sliceType($emptyInterface))([new $String("send timeout")]));}else if((f.$high>0||(f.$high===0&&f.$low>0))){a.numSent=a.numSent+(1)>>0;}e=($chanType(B.Object,false,true)).nil;f=new $Uint64(0,0);}else if(ad[0]===2){af=ad[1][0];if(!af){AK(a,b);return c;}$s=1;continue;}else if(ad[0]===3){AK(a,b);return c;}if(ac===$ifaceNil){g=g+(1)>>0;a.numSent=0;$s=1;continue;}g=0;ag=0;while(ag<$parseInt(ac.length)){ah=ac[ag];ai=T();aj=ah.payload;if(!(aj===undefined)){ak=Y(aj);al=ak[0];am=ak[1];if(!($interfaceIsEqual(am,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("poll payload:"),am]));return c;}ai.push($externalize(al,$String));}an=a.handleEvent(ah,ai);ao=an[0];ap=an[2];if((f.$high>0||(f.$high===0&&f.$low>0))&&(f.$high<ao.$high||(f.$high===ao.$high&&f.$low<=ao.$low))){f=new $Uint64(0,0);a.numSent=a.numSent+(1)>>0;}if(!ap){return c;}if(!c){c=true;a.connState("connected");}ag=ag+(1)>>0;}$s=1;continue;case 2:return c;case-1:}return;}};$f.$blocking=true;return $f;};AJ=function(a,b){var c=$ifaceNil,d,e,f,g;d=(e=new $Map(),f="action",e[f]={k:f,v:new $String("ping")},f="session_id",e[f]={k:f,v:a.sessionId},e);g=AE(b,new($mapType($String,$emptyInterface))(d),O(new AV(0,7000),0.9));c=g[1];return c;};AK=function(a,b){var c,d,e,f,g;c=(d=new $Map(),e="action",d[e]={k:e,v:new $String("close_session")},e="session_id",d[e]={k:e,v:a.sessionId},d);f=AE(b,new($mapType($String,$emptyInterface))(c),O(new AV(0,7000),0.9));g=f[1];if(!($interfaceIsEqual(g,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),g]));}};AM=function(){AL.call=$externalize(M,($funcType([B.Object,B.Object,B.Object],[B.Object],false)));AL.newSession=$externalize(AT,($funcType([],[($mapType($String,$emptyInterface))],false)));AL.stringifyFrame=$externalize(BC,($funcType([B.Object],[$String],false)));$global.NinchatClient=AL;};AP=$pkg.NewPromise=function(){var a=$ifaceNil,b=$throwNilPointerError,c;c=new AO.Ptr();$copy(c,new AO.Ptr(),AO);a=V();a.then=$externalize($methodVal(c,"Then"),($funcType([B.Object,B.Object],[],false)));b=$methodVal(c,"Resolve");return[a,b];};AO.Ptr.prototype.Then=function(a,b){var c,d,e;c=this;d=!(a===undefined)&&!(a===null);e=!(b===undefined)&&!(b===null);if(c.settled){if(c.successful){if(d){R("NinchatClient promise success callback",a,c.args);}}else{if(e){R("NinchatClient promise failure callback",b,c.args);}}}else{if(d){c.successCallbacks=$append(c.successCallbacks,a);}if(e){c.failureCallbacks=$append(c.failureCallbacks,b);}}};AO.prototype.Then=function(a,b){return this.$val.Then(a,b);};AO.Ptr.prototype.Resolve=function(a,b){var c,d,e,f,g,h,i;c=this;if(c.settled){$panic(new $String("promise has already been settled"));}c.settled=true;c.successful=a;c.args=b;if(a){d=c.successCallbacks;e=0;while(e<d.$length){f=((e<0||e>=d.$length)?$throwRuntimeError("index out of range"):d.$array[d.$offset+e]);R("NinchatClient promise success callback",f,c.args);e++;}}else{g=c.failureCallbacks;h=0;while(h<g.$length){i=((h<0||h>=g.$length)?$throwRuntimeError("index out of range"):g.$array[g.$offset+h]);R("NinchatClient promise failure callback",i,c.args);h++;}}};AO.prototype.Resolve=function(a,b){return this.$val.Resolve(a,b);};AT=$pkg.NewSession=function(){var a,b,c;a=new AS.Ptr($ifaceNil,$ifaceNil,$ifaceNil,$ifaceNil,$ifaceNil,"api.ninchat.com",false,$ifaceNil,$ifaceNil,"",new AU(0,0),new $Uint64(0,0),($chanType($Bool,false,false)).nil,($sliceType(($ptrType(D)))).nil,0,false,new $Uint64(0,0),new $Uint64(0,0),($chanType($Bool,false,false)).nil,false,true);return(b=new $Map(),c="onSessionEvent",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnSessionEvent"))},c="onEvent",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnEvent"))},c="onConnState",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnConnState"))},c="onConnActive",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnConnActive"))},c="onLog",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"OnLog"))},c="setParams",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetParams"))},c="setTransport",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetTransport"))},c="setAddress",b[c]={k:c,v:new($funcType([B.Object],[],false))($methodVal(a,"SetAddress"))},c="open",b[c]={k:c,v:new($funcType([],[],false))($methodVal(a,"Open"))},c="close",b[c]={k:c,v:new($funcType([],[],false))($methodVal(a,"Close"))},c="send",b[c]={k:c,v:new($funcType([B.Object,B.Object],[B.Object],false))($methodVal(a,"Send"))},b);};AS.Ptr.prototype.OnSessionEvent=function(a){var b;b=this;b.onSessionEvent=a;};AS.prototype.OnSessionEvent=function(a){return this.$val.OnSessionEvent(a);};AS.Ptr.prototype.OnEvent=function(a){var b;b=this;b.onEvent=a;};AS.prototype.OnEvent=function(a){return this.$val.OnEvent(a);};AS.Ptr.prototype.OnConnState=function(a){var b;b=this;if(a===null){a=$ifaceNil;}b.onConnState=a;if(!(b.onConnState===$ifaceNil)&&!(b.latestConnState==="")){R("NinchatClient.Session onConnState callback",b.onConnState,new($sliceType($emptyInterface))([new $String(b.latestConnState)]));}};AS.prototype.OnConnState=function(a){return this.$val.OnConnState(a);};AS.Ptr.prototype.OnConnActive=function(a){var b,c;b=this;if(a===null){a=$ifaceNil;}b.onConnActive=a;if(!(b.onConnActive===$ifaceNil)&&(c=b.latestConnActive,(c.$high>0||(c.$high===0&&c.$low>0)))){R("NinchatClient.Session onConnActive callback",b.onConnActive,new($sliceType($emptyInterface))([b.latestConnActive]));}};AS.prototype.OnConnActive=function(a){return this.$val.OnConnActive(a);};AS.Ptr.prototype.OnLog=function(a){var b;b=this;if(a===null){a=$ifaceNil;}b.onLog=a;};AS.prototype.OnLog=function(a){return this.$val.OnLog(a);};AS.Ptr.prototype.SetParams=function(a){var b,c;b=this;if(a.message_types===undefined){$panic(new $String("message_types parameter not defined"));}c=a.session_id;if(!(c===undefined)&&!(c===null)){b.sessionId=c;}delete a[$externalize("session_id",$String)];b.sessionParams=a;if(!(b.sendNotify===($chanType($Bool,false,false)).nil)&&b.stopped){$go($methodVal(b,"discover"),[]);}};AS.prototype.SetParams=function(a){return this.$val.SetParams(a);};AS.Ptr.prototype.SetTransport=function(a){var b,c,d;b=this;if(a===null){b.forceLongPoll=false;return;}c=$internalize(a,$String);d=c;if(d==="websocket"){$panic(new $String("websocket transport cannot be forced"));}else if(d==="longpoll"){b.forceLongPoll=true;}else{$panic(new $String("unknown transport: "+c));}};AS.prototype.SetTransport=function(a){return this.$val.SetTransport(a);};AS.Ptr.prototype.SetAddress=function(a){var b;b=this;b.address=E(a);};AS.prototype.SetAddress=function(a){return this.$val.SetAddress(a);};AS.Ptr.prototype.Open=function(){var a;a=this;if(a.closed){$panic(new $String("session already closed"));}if(!(a.sendNotify===($chanType($Bool,false,false)).nil)){$panic(new $String("session already initialized"));}if(a.onSessionEvent===$ifaceNil){$panic(new $String("onSessionEvent callback not defined"));}if(a.onEvent===$ifaceNil){$panic(new $String("onEvent callback not defined"));}if(a.sessionParams===$ifaceNil){$panic(new $String("session parameters not defined"));}a.sendNotify=new($chanType($Bool,false,false))(1);a.closeNotify=new($chanType($Bool,false,false))(1);a.stopped=false;$go($methodVal(a,"discover"),[]);};AS.prototype.Open=function(){return this.$val.Open();};AS.Ptr.prototype.Close=function(){var a,b,c,d;a=this;if(a.closed){return;}b=a.sendBuffer;c=0;while(c<b.$length){d=((c<0||c>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+c]);a.resolve(d,false,new($sliceType($emptyInterface))([]));c++;}a.sendBuffer=($sliceType(($ptrType(D)))).nil;a.numSent=0;a.closed=true;a.stopped=true;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:$r=$send(a.closeNotify,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}$close(a.sendNotify);case-1:}return;}};$f.$blocking=true;return $f;}),[]);};AS.prototype.Close=function(){return this.$val.Close();};AS.Ptr.prototype.Send=function(a,b){var c=$ifaceNil,d,e,f,g,h;d=this;if(d.sendNotify===($chanType($Bool,false,false)).nil){$panic(new $String("session not initialized"));}if(d.closed){$panic(new $String("session already closed"));}if((b===undefined)||(b===null)||($parseInt(b.length)===0)){b=$ifaceNil;}e=new D.Ptr(new $Uint64(0,0),a,b,$throwNilPointerError,"");if(a.action_id===null){delete a[$externalize("action_id",$String)];}else{d.lastActionId=(f=d.lastActionId,g=new $Uint64(0,1),new $Uint64(f.$high+g.$high,f.$low+g.$low));e.Id=d.lastActionId;a.action_id=$externalize(e.Id,$Uint64);h=AP();c=h[0];e.Resolve=h[1];}d.send(e);return c;};AS.prototype.Send=function(a,b){return this.$val.Send(a,b);};AS.Ptr.prototype.send=function(a){var b;b=this;b.sendBuffer=$append(b.sendBuffer,a);$go((function(){var c;c=$select([[b.sendNotify,true],[]]);}),[]);return;};AS.prototype.send=function(a){return this.$val.send(a);};AS.Ptr.prototype.sendAck=function(){var a;a=this;a.sendEventAck=true;$go((function(){var b;b=$select([[a.sendNotify,true],[]]);}),[]);};AS.prototype.sendAck=function(){return this.$val.sendAck();};AS.Ptr.prototype.discover=function($b){var $this=this,$args=arguments,$r,$deferred=[],$err=null,$s=0,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);while(true){switch($s){case 0:a=$this;a.log(new($sliceType($emptyInterface))([new $String("opening")]));$deferred.push([$methodVal(a,"log"),[new($sliceType($emptyInterface))([new $String("closed")]),true]]);$deferred.push([$methodVal(a,"connState"),["disconnected",true]]);b=new L.Ptr();$copy(b,new L.Ptr(),L);c=false;case 1:if(!(!a.stopped)){$s=2;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery")]));a.connState("connecting");d="https://"+a.address+"/v2/endpoint";e=AD(d,O(new AV(0,7000),0.1));f=e[0];g=e[1];if(!($interfaceIsEqual(g,$ifaceNil))){}else{$s=3;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery:"),g]));$s=4;continue;case 3:i=$select([[f],[a.closeNotify]],true);$s=5;case 5:if(i&&i.$blocking){i=i();}h=i;if(h[0]===0){}else if(h[0]===1){$s=6;continue;}else{$s=7;continue;}j=h[1][0];if(j===$ifaceNil){}else{$s=8;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery timed out")]));$s=9;continue;case 8:k=F(j);l=k[0];m=k[1];if(!($interfaceIsEqual(m,$ifaceNil))){}else{$s=10;continue;}a.log(new($sliceType($emptyInterface))([new $String("endpoint discovery:"),m]));$s=11;continue;case 10:a.log(new($sliceType($emptyInterface))([new $String("endpoint discovered")]));if(!$pkg.WebSocketSupported||a.forceLongPoll||c){}else{$s=12;continue;}n=a.connect(AH,l,b,true);$s=14;case 14:if(n&&n.$blocking){n=n();}n;$s=13;continue;case 12:o=a.connect(BD,l,b,true);$s=15;case 15:if(o&&o.$blocking){o=o();}c=!o;case 13:$s=1;continue;case 11:case 9:$s=7;continue;case 6:return;case 7:case 4:p=b.Failure(new AV(0,60000));if((p.$high>0||(p.$high===0&&p.$low>0))){}else{$s=16;continue;}a.log(new($sliceType($emptyInterface))([new $String("sleeping")]));a.connState("disconnected");$r=AZ(p,true);$s=17;case 17:if($r&&$r.$blocking){$r=$r();}case 16:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);}};$f.$blocking=true;return $f;};AS.prototype.discover=function($b){return this.$val.discover($b);};AS.Ptr.prototype.connect=function(a,b,c,$b){var $this=this,$args=arguments,d=false,$r,$s=0,e,f,g,h,i,j,k,l,m,n;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:e=$this;f=0;case 1:if(!(f<2)){$s=2;continue;}g=b;h=0;case 3:if(!(h<g.$length)){$s=4;continue;}i=((h<0||h>=g.$length)?$throwRuntimeError("index out of range"):g.$array[g.$offset+h]);e.connState("connecting");k=a(e,i,true);$s=5;case 5:if(k&&k.$blocking){k=k();}j=k;l=j[0];m=j[1];if(l){d=true;}if(m){c.Success();return d;}if(e.stopped){return d;}n=c.Failure(new AV(0,60000));if((n.$high>0||(n.$high===0&&n.$low>0))){}else{$s=6;continue;}e.log(new($sliceType($emptyInterface))([new $String("sleeping")]));e.connState("disconnected");$r=AZ(n,true);$s=7;case 7:if($r&&$r.$blocking){$r=$r();}case 6:h++;$s=3;continue;case 4:f=f+(1)>>0;$s=1;continue;case 2:return d;case-1:}return;}};$f.$blocking=true;return $f;};AS.prototype.connect=function(a,b,c,$b){return this.$val.connect(a,b,c,$b);};AS.Ptr.prototype.canLogin=function(){var a,b,c,d,e,f,g,h,i,j,k;a=this;b=a.sessionParams.access_key;if(!(b===undefined)&&!(b===null)){return true;}c=a.sessionParams.user_id;if(!(c===undefined)&&!(c===null)){d=new($sliceType($String))(["user_auth","master_sign"]);e=0;while(e<d.$length){f=((e<0||e>=d.$length)?$throwRuntimeError("index out of range"):d.$array[d.$offset+e]);g=a.sessionParams[$externalize(f,$String)];if(!(g===undefined)&&!(g===null)){return true;}e++;}return false;}h=new($sliceType($String))(["identity_type","identity_name","identity_auth"]);i=0;while(i<h.$length){j=((i<0||i>=h.$length)?$throwRuntimeError("index out of range"):h.$array[h.$offset+i]);k=a.sessionParams[$externalize(j,$String)];if((k===undefined)||(k===null)){return false;}i++;}return true;};AS.prototype.canLogin=function(){return this.$val.canLogin();};AS.Ptr.prototype.makeCreateSessionAction=function(){var a=$ifaceNil,b;b=this;a=b.sessionParams;a.action=$externalize("create_session",$String);return a;};AS.prototype.makeCreateSessionAction=function(){return this.$val.makeCreateSessionAction();};AS.Ptr.prototype.makeResumeSessionAction=function(a){var b=$ifaceNil,c;c=this;b=V();b.action=$externalize("resume_session",$String);b.event_id=$externalize(c.receivedEventId,$Uint64);if(a){b.session_id=c.sessionId;}c.sendEventAck=false;c.ackedEventId=c.receivedEventId;return b;};AS.prototype.makeResumeSessionAction=function(a){return this.$val.makeResumeSessionAction(a);};AS.Ptr.prototype.handleSessionEvent=function(a){var b=false,c,d,e,f,g,h,i,j,k,l,m;c=this;d=G(a);e=d[0];f=d[1];g=d[2];h=d[3];b=d[4];i=d[5];if(!($interfaceIsEqual(i,$ifaceNil))){c.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));}if(!R("NinchatClient.Session onSessionEvent callback",c.onSessionEvent,new($sliceType($emptyInterface))([a]))){b=false;}if(!b){c.sessionId=$ifaceNil;c.stopped=true;return b;}c.sessionParams.user_id=e;if(!(f===$ifaceNil)){c.sessionParams.user_auth=f;}j=new($sliceType($String))(["identity_type","identity_name","identity_auth"]);k=0;while(k<j.$length){l=((k<0||k>=j.$length)?$throwRuntimeError("index out of range"):j.$array[j.$offset+k]);m=c.sessionParams[$externalize(l+"_new",$String)];if(!(m===undefined)){c.sessionParams[$externalize(l,$String)]=m;}k++;}delete c.sessionParams[$externalize("access_key",$String)];delete c.sessionParams[$externalize("master_sign",$String)];c.sessionId=g;if(c.sendBuffer.$length===0){c.lastActionId=new $Uint64(0,0);}c.sendEventAck=false;c.receivedEventId=h;c.ackedEventId=new $Uint64(0,0);c.log(new($sliceType($emptyInterface))([new $String("session created")]));b=true;return b;};AS.prototype.handleSessionEvent=function(a){return this.$val.handleSessionEvent(a);};AS.Ptr.prototype.handleEvent=function(a,b){var c=new $Uint64(0,0),d=false,e=false,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;f=this;g=I(a);h=g[0];c=g[1];i=g[2];if(!($interfaceIsEqual(i,$ifaceNil))){f.log(new($sliceType($emptyInterface))([new $String("event:"),i]));return[c,d,e];}if((h.$high>0||(h.$high===0&&h.$low>0))){f.receivedEventId=h;if(!f.sendEventAck){if((j=(k=f.receivedEventId,l=f.ackedEventId,new $Uint64(k.$high-l.$high,k.$low-l.$low)),(j.$high>AQ.$high||(j.$high===AQ.$high&&j.$low>=AQ.$low)))){f.sendAck();}else{d=true;}}}if((c.$high>0||(c.$high===0&&c.$low>0))){m=C.Search(f.numSent,(function(m){var n,o,p;o=(n=f.sendBuffer,((m<0||m>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+m]));return(p=o.Id,(p.$high>c.$high||(p.$high===c.$high&&p.$low>=c.$low)));}));if(m<f.numSent){o=(n=f.sendBuffer,((m<0||m>=n.$length)?$throwRuntimeError("index out of range"):n.$array[n.$offset+m]));if((p=o.Id,(p.$high===c.$high&&p.$low===c.$low))){f.resolve(o,true,new($sliceType($emptyInterface))([a,b]));q=J(a,o);r=q[0];s=q[1];if(!($interfaceIsEqual(s,$ifaceNil))){f.log(new($sliceType($emptyInterface))([new $String("event:"),s]));return[c,d,e];}if(r){f.sendBuffer=$appendSlice($subslice(f.sendBuffer,0,m),$subslice(f.sendBuffer,(m+1>>0)));f.numSent=f.numSent-(1)>>0;}}}}t=K(a);u=t[0];v=t[1];w=t[2];i=t[3];if(!($interfaceIsEqual(i,$ifaceNil))){f.log(new($sliceType($emptyInterface))([new $String("event:"),i]));if(w){f.sessionId=$ifaceNil;if(!f.canLogin()){R("NinchatClient.Session onSessionEvent callback",f.onSessionEvent,new($sliceType($emptyInterface))([a]));f.stopped=true;}}return[c,d,e];}if(u==="deprecated"){f.log(new($sliceType($emptyInterface))([new $String("deprecated:"),new $String(v)]));}if(!R("NinchatClient.Session onEvent callback",f.onEvent,new($sliceType($emptyInterface))([a,b]))){return[c,d,e];}e=true;return[c,d,e];};AS.prototype.handleEvent=function(a,b){return this.$val.handleEvent(a,b);};AS.Ptr.prototype.resolve=function(a,b,c){var $deferred=[],$err=null,d;try{$deferFrames.push($deferred);d=this;$deferred.push([(function(){var e;e=$recover();if(!($interfaceIsEqual(e,$ifaceNil))){console.log(e);}}),[]]);if(!(a.Resolve===$throwNilPointerError)){a.Resolve(b,c);}}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);}};AS.prototype.resolve=function(a,b,c){return this.$val.resolve(a,b,c);};AS.Ptr.prototype.connState=function(a){var b;b=this;if(!(b.latestConnState===a)){b.latestConnState=a;if(!(b.onConnState===$ifaceNil)){R("NinchatClient.Session onConnState callback",b.onConnState,new($sliceType($emptyInterface))([new $String(b.latestConnState)]));}}};AS.prototype.connState=function(a){return this.$val.connState(a);};AS.Ptr.prototype.connActive=function(){var a;a=this;a.latestConnActive=AW();if(!(a.onConnActive===$ifaceNil)){R("NinchatClient.Session onConnActive callback",a.onConnActive,new($sliceType($emptyInterface))([a.latestConnActive]));}};AS.prototype.connActive=function(){return this.$val.connActive();};AS.Ptr.prototype.log=function(a){var b;b=this;AG("NinchatClient.Session onLog callback",b.onLog,a);};AS.prototype.log=function(a){return this.$val.log(a);};AW=$pkg.Now=function(){var a;return(a=$internalize(new($global.Date)().getTime(),$Int64),new AU(a.$high,a.$low));};AY=$pkg.NewTimer=function(a){var b=($ptrType(AX)).nil;b=new AX.Ptr(new($chanType($Bool,false,false))(0),$ifaceNil);if((a.$high>0||(a.$high===0&&a.$low>=0))){b.Reset(a);}return b;};AX.Ptr.prototype.Active=function(){var a;a=this;return!(a.id===$ifaceNil);};AX.prototype.Active=function(){return this.$val.Active();};AX.Ptr.prototype.Reset=function(a){var b;b=this;b.Stop();b.id=AA((function(){b.id=$ifaceNil;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:$r=$send(b.C,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),a);};AX.prototype.Reset=function(a){return this.$val.Reset(a);};AX.Ptr.prototype.Stop=function(){var a;a=this;if(!(a.id===$ifaceNil)){AB(a.id);a.id=$ifaceNil;}};AX.prototype.Stop=function(){return this.$val.Stop();};AZ=$pkg.Sleep=function(a,$b){var $this=this,$args=arguments,$r,$s=0,b;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:b=$recv(AY(a).C,true);$s=1;case 1:if(b&&b.$blocking){b=b();}b[0];case-1:}return;}};$f.$blocking=true;return $f;};BB=$pkg.NewWebSocket=function(a){var b=($ptrType(BA)).nil;b=new BA.Ptr(new($chanType($Bool,false,false))(1),new($global.WebSocket)($externalize(a,$String)),false,$ifaceNil,($sliceType(B.Object)).nil);b.impl.binaryType=$externalize("arraybuffer",$String);b.impl.onopen=$externalize((function(){b.open=true;$go((function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:$r=$send(b.Notify,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[]);}),($funcType([B.Object],[],false)));b.impl.onmessage=$externalize((function(c){b.buffer=$append(b.buffer,c.data);$go((function(){var d;d=$select([[b.Notify,true],[]]);}),[]);}),($funcType([B.Object],[],false)));b.impl.onclose=$externalize((function(){b.open=false;$go((function(){$close(b.Notify);}),[]);}),($funcType([B.Object],[],false)));b.impl.onerror=$externalize((function(c){b.error=A.New("WebSocket error event");}),($funcType([B.Object],[],false)));return b;};BA.Ptr.prototype.Send=function(a){var b=$ifaceNil,$deferred=[],$err=null,c;try{$deferFrames.push($deferred);c=this;$deferred.push([(function(){b=Q($recover());}),[]]);b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return b;}c.impl.send($externalize(a,$emptyInterface));return b;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return b;}};BA.prototype.Send=function(a){return this.$val.Send(a);};BA.Ptr.prototype.SendJSON=function(a){var b=$ifaceNil,c,d,e;c=this;d=Y(a);e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))){return b;}b=c.Send(new $String(e));return b;};BA.prototype.SendJSON=function(a){return this.$val.SendJSON(a);};BA.Ptr.prototype.Receive=function(){var a=$ifaceNil,b=$ifaceNil,c,d;c=this;b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return[a,b];}if(!c.open){return[a,b];}if(c.buffer.$length>0){a=(d=c.buffer,((0<0||0>=d.$length)?$throwRuntimeError("index out of range"):d.$array[d.$offset+0]));c.buffer=$subslice(c.buffer,1);}return[a,b];};BA.prototype.Receive=function(){return this.$val.Receive();};BA.Ptr.prototype.ReceiveJSON=function(){var a=$ifaceNil,b=$ifaceNil,c,d,e,f;c=this;d=c.Receive();e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))||e===$ifaceNil){return[a,b];}f=X(BC(e));a=f[0];b=f[1];return[a,b];};BA.prototype.ReceiveJSON=function(){return this.$val.ReceiveJSON();};BA.Ptr.prototype.Close=function(){var a=$ifaceNil,$deferred=[],$err=null,b;try{$deferFrames.push($deferred);b=this;$deferred.push([(function(){a=Q($recover());}),[]]);b.impl.close();a=b.error;return a;}catch(err){$err=err;}finally{$deferFrames.pop();$callDeferred($deferred,$err);return a;}};BA.prototype.Close=function(){return this.$val.Close();};BC=$pkg.StringifyFrame=function(a){var b="",c,d,e,f;c=$assertType($internalize(a,$emptyInterface),$String,true);b=c[0];d=c[1];if(d){return b;}e=U(a);f=$assertType($internalize(e,$emptyInterface),($sliceType($Uint8)));b=$bytesToString(f);return b;};BD=$pkg.WebSocketTransport=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);while(true){switch($s){case 0:e=($ptrType(BA)).nil;$deferred.push([(function(){if(!(e===($ptrType(BA)).nil)){e.Close();}}),[true]]);f=AY(new AV(-1,4294967295));$deferred.push([$methodVal(f,"Stop"),[true]]);case 1:if(!(true)){$s=2;continue;}d=false;g=false;a.log(new($sliceType($emptyInterface))([new $String("connecting to"),new $String(b)]));e=BB("wss://"+b+"/v2/socket");f.Reset(O(new AV(0,9000),0.1));i=$select([[e.Notify],[f.C],[a.closeNotify]],true);$s=3;case 3:if(i&&i.$blocking){i=i();}h=i;if(h[0]===0){}else if(h[0]===1){$s=4;continue;}else if(h[0]===2){$s=5;continue;}else{$s=6;continue;}j=h[1][0];f.Stop();if(j){}else{$s=7;continue;}a.log(new($sliceType($emptyInterface))([new $String("connected")]));a.connState("connected");c=true;l=BE(a,e,true);$s=9;case 9:if(l&&l.$blocking){l=l();}k=l;d=k[0];g=k[1];$s=8;continue;case 7:a.log(new($sliceType($emptyInterface))([new $String("connection failed")]));case 8:$s=6;continue;case 4:a.log(new($sliceType($emptyInterface))([new $String("connection timeout")]));$s=6;continue;case 5:f.Stop();case 6:e.Close();e=($ptrType(BA)).nil;a.log(new($sliceType($emptyInterface))([new $String("disconnected")]));if(!d||!g||a.stopped){return[c,d];}$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[c,d];}};$f.$blocking=true;return $f;};BE=function(a,b,$b){var $this=this,$args=arguments,c=false,d=false,$r,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:e=$ifaceNil;if(a.sessionId===$ifaceNil){a.log(new($sliceType($emptyInterface))([new $String("session creation")]));e=a.makeCreateSessionAction();}else{a.log(new($sliceType($emptyInterface))([new $String("session resumption")]));e=a.makeResumeSessionAction(true);}f=b.SendJSON(e);if(!($interfaceIsEqual(f,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),f]));}if(a.sessionId===$ifaceNil){}else{$s=1;continue;}g=$ifaceNil;h=AY(O(new AV(0,13000),0.2));case 2:if(!(true)){$s=3;continue;}i=$ifaceNil;j=b.ReceiveJSON();g=j[0];i=j[1];if(!($interfaceIsEqual(i,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("session creation:"),i]));return[c,d];}if(!(g===$ifaceNil)){h.Stop();$s=3;continue;}l=$select([[b.Notify],[h.C]],true);$s=4;case 4:if(l&&l.$blocking){l=l();}k=l;if(k[0]===0){m=k[1][0];if(!m){a.log(new($sliceType($emptyInterface))([new $String("disconnected during session creation")]));h.Stop();return[c,d];}}else if(k[0]===1){a.log(new($sliceType($emptyInterface))([new $String("session creation timeout")]));return[c,d];}$s=2;continue;case 3:if(!a.handleSessionEvent(g)){return[c,d];}c=true;d=true;a.connActive();case 1:n=new($chanType($Bool,false,false))(1);o=new($chanType($Bool,false,false))(0);$go(BF,[a,b,n,o]);q=BG(a,b,n,true);$s=5;case 5:if(q&&q.$blocking){q=q();}p=q;r=p[0];d=p[1];if(r){c=true;}s=$recv(o,true);$s=6;case 6:if(s&&s.$blocking){s=s();}s[0];return[c,d];case-1:}return;}};$f.$blocking=true;return $f;};BF=function(a,b,c,d,$b){var $this=this,$args=arguments,$r,$deferred=[],$err=null,$s=0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);while(true){switch($s){case 0:$deferred.push([(function($b){var $this=this,$args=arguments,$r,$s=0;if(!$b){$nonblockingCall();};var $f=function(){while(true){switch($s){case 0:$r=$send(d,true,true);$s=1;case 1:if($r&&$r.$blocking){$r=$r();}case-1:}return;}};$f.$blocking=true;return $f;}),[true]]);e=AY(O(new AV(0,56000),-0.3));$deferred.push([$methodVal(e,"Stop"),[true]]);a.numSent=0;case 1:if(!(true)){$s=2;continue;}case 3:if(!(a.numSent<a.sendBuffer.$length)){$s=4;continue;}h=(f=a.sendBuffer,g=a.numSent,((g<0||g>=f.$length)?$throwRuntimeError("index out of range"):f.$array[f.$offset+g]));if(!(h.Payload===$ifaceNil)){h.Header.frames=$parseInt(h.Payload.length);}if(!((i=a.receivedEventId,j=a.ackedEventId,(i.$high===j.$high&&i.$low===j.$low)))){h.Header.event_id=$externalize(a.receivedEventId,$Uint64);a.sendEventAck=false;a.ackedEventId=a.receivedEventId;}k=b.SendJSON(h.Header);delete h.Header[$externalize("frames",$String)];delete h.Header[$externalize("event_id",$String)];if(!($interfaceIsEqual(k,$ifaceNil))){}else{$s=5;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),k]));$r=$send(c,true,true);$s=6;case 6:if($r&&$r.$blocking){$r=$r();}return;case 5:if(!(h.Payload===$ifaceNil)){}else{$s=7;continue;}l=0;case 8:if(!(l<$parseInt(h.Payload.length))){$s=9;continue;}m=b.Send(h.Payload[0]);if(!($interfaceIsEqual(m,$ifaceNil))){}else{$s=10;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),m]));$r=$send(c,true,true);$s=11;case 11:if($r&&$r.$blocking){$r=$r();}return;case 10:l=l+(1)>>0;$s=8;continue;case 9:case 7:if((n=h.Id,(n.$high===0&&n.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{a.numSent=a.numSent+(1)>>0;}e.Reset(O(new AV(0,56000),-0.3));$s=3;continue;case 4:if(a.sendEventAck&&!((o=a.receivedEventId,p=a.ackedEventId,(o.$high===p.$high&&o.$low===p.$low)))){}else{$s=12;continue;}q=a.makeResumeSessionAction(false);r=b.SendJSON(q);if(!($interfaceIsEqual(r,$ifaceNil))){}else{$s=13;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),r]));$r=$send(c,true,true);$s=14;case 14:if($r&&$r.$blocking){$r=$r();}return;case 13:case 12:t=$select([[a.sendNotify],[e.C],[c]],true);$s=15;case 15:if(t&&t.$blocking){t=t();}s=t;if(s[0]===0){}else if(s[0]===1){$s=16;continue;}else if(s[0]===2){$s=17;continue;}else{$s=18;continue;}u=s[1][0];if(!u){v=(w=new $Map(),x="action",w[x]={k:x,v:new $String("close_session")},w);y=b.SendJSON(new($mapType($String,$emptyInterface))(v));if(!($interfaceIsEqual(y,$ifaceNil))){a.log(new($sliceType($emptyInterface))([new $String("send:"),y]));}return;}$s=18;continue;case 16:z=b.Send(new($sliceType($Uint8))([]));if(!($interfaceIsEqual(z,$ifaceNil))){}else{$s=19;continue;}a.log(new($sliceType($emptyInterface))([new $String("send:"),z]));$r=$send(c,true,true);$s=20;case 20:if($r&&$r.$blocking){$r=$r();}return;case 19:e.Reset(O(new AV(0,56000),-0.3));$s=18;continue;case 17:return;case 18:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);}};$f.$blocking=true;return $f;};BG=function(a,b,c,$b){var $this=this,$args=arguments,d=false,e=false,$r,$deferred=[],$err=null,$s=0,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ab,ac;if(!$b){$nonblockingCall();};var $f=function(){try{$deferFrames.push($deferred);while(true){switch($s){case 0:f=$ifaceNil;g=$ifaceNil;h=0;i=AY(O(new AV(0,64000),0.3));$deferred.push([$methodVal(i,"Stop"),[true]]);j=AY(new AV(-1,4294967295));$deferred.push([$methodVal(j,"Stop"),[true]]);case 1:if(!(true)){$s=2;continue;}k=false;case 3:if(!(true)){$s=4;continue;}if(f===$ifaceNil){}else{$s=5;continue;}l=$ifaceNil;m=b.Receive();n=m[0];l=m[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=7;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=8;case 8:if($r&&$r.$blocking){$r=$r();}return[d,e];case 7:if(n===$ifaceNil){$s=4;continue;}i.Reset(O(new AV(0,64000),0.7));a.connActive();o=BC(n);if(o.length===0){$s=3;continue;}p=X(o);f=p[0];l=p[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=9;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=10;case 10:if($r&&$r.$blocking){$r=$r();}return[d,e];case 9:g=T();q=H(f);h=q[0];l=q[1];if(!($interfaceIsEqual(l,$ifaceNil))){}else{$s=11;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),l]));e=false;$r=$send(c,true,true);$s=12;case 12:if($r&&$r.$blocking){$r=$r();}return[d,e];case 11:$s=6;continue;case 5:r=b.Receive();s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){}else{$s=13;continue;}a.log(new($sliceType($emptyInterface))([new $String("receive:"),t]));e=false;$r=$send(c,true,true);$s=14;case 14:if($r&&$r.$blocking){$r=$r();}return[d,e];case 13:if(s===$ifaceNil){$s=4;continue;}g.push(s);h=h-(1)>>0;case 6:if(h===0){}else{$s=15;continue;}u=a.handleEvent(f,g);v=u[1];w=u[2];if(!w){}else{$s=16;continue;}e=false;$r=$send(c,true,true);$s=17;case 17:if($r&&$r.$blocking){$r=$r();}return[d,e];case 16:if(v){k=true;}f=$ifaceNil;g=$ifaceNil;h=0;d=true;e=true;case 15:x=$select([[a.closeNotify],[c],[]]);if(x[0]===0){return[d,e];}else if(x[0]===1){return[d,e];}$s=3;continue;case 4:if(k&&!j.Active()){j.Reset(O(new AV(0,7000),-0.3));}z=$select([[b.Notify],[i.C],[j.C],[a.closeNotify],[c]],true);$s=18;case 18:if(z&&z.$blocking){z=z();}y=z;if(y[0]===0){}else if(y[0]===1){$s=19;continue;}else if(y[0]===2){$s=20;continue;}else if(y[0]===3){$s=21;continue;}else if(y[0]===4){$s=22;continue;}else{$s=23;continue;}aa=y[1][0];if(!aa){}else{$s=24;continue;}$r=$send(c,true,true);$s=25;case 25:if($r&&$r.$blocking){$r=$r();}return[d,e];case 24:$s=23;continue;case 19:a.log(new($sliceType($emptyInterface))([new $String("receive timeout")]));$r=$send(c,true,true);$s=26;case 26:if($r&&$r.$blocking){$r=$r();}return[d,e];$s=23;continue;case 20:if(!a.sendEventAck&&!((ab=a.ackedEventId,ac=a.receivedEventId,(ab.$high===ac.$high&&ab.$low===ac.$low)))){a.sendAck();}$s=23;continue;case 21:return[d,e];$s=23;continue;case 22:return[d,e];case 23:$s=1;continue;case 2:case-1:}return;}}catch(err){$err=err;}finally{$deferFrames.pop();if($curGoroutine.asleep&&!$jumpToDefer){throw null;}$s=-1;$callDeferred($deferred,$err);return[d,e];}};$f.$blocking=true;return $f;};$pkg.$run=function($b){$packages["github.com/gopherjs/gopherjs/js"].$init();$packages["runtime"].$init();$packages["errors"].$init();$packages["sort"].$init();$pkg.$init();AM();};$pkg.$init=function(){($ptrType(D)).methods=[["Name","Name","",$funcType([],[$String],false),-1]];D.init([["Id","Id","",$Uint64,""],["Header","Header","",B.Object,""],["Payload","Payload","",B.Object,""],["Resolve","Resolve","",AN,""],["name","name","ninchatclient",$String,""]]);($ptrType(L)).methods=[["Failure","Failure","",$funcType([AV],[AV],false),-1],["Success","Success","",$funcType([],[],false),-1]];L.init([["lastSlot","lastSlot","ninchatclient",$Int,""]]);AN.init([$Bool,($sliceType($emptyInterface))],[],true);($ptrType(AO)).methods=[["Resolve","Resolve","",$funcType([$Bool,($sliceType($emptyInterface))],[],true),-1],["Then","Then","",$funcType([B.Object,B.Object],[],false),-1]];AO.init([["settled","settled","ninchatclient",$Bool,""],["successful","successful","ninchatclient",$Bool,""],["args","args","ninchatclient",($sliceType($emptyInterface)),""],["successCallbacks","successCallbacks","ninchatclient",($sliceType(B.Object)),""],["failureCallbacks","failureCallbacks","ninchatclient",($sliceType(B.Object)),""]]);AR.init([($ptrType(AS)),$String],[$Bool,$Bool],false);($ptrType(AS)).methods=[["Close","Close","",$funcType([],[],false),-1],["OnConnActive","OnConnActive","",$funcType([B.Object],[],false),-1],["OnConnState","OnConnState","",$funcType([B.Object],[],false),-1],["OnEvent","OnEvent","",$funcType([B.Object],[],false),-1],["OnLog","OnLog","",$funcType([B.Object],[],false),-1],["OnSessionEvent","OnSessionEvent","",$funcType([B.Object],[],false),-1],["Open","Open","",$funcType([],[],false),-1],["Send","Send","",$funcType([B.Object,B.Object],[B.Object],false),-1],["SetAddress","SetAddress","",$funcType([B.Object],[],false),-1],["SetParams","SetParams","",$funcType([B.Object],[],false),-1],["SetTransport","SetTransport","",$funcType([B.Object],[],false),-1],["canLogin","canLogin","ninchatclient",$funcType([],[$Bool],false),-1],["connActive","connActive","ninchatclient",$funcType([],[],false),-1],["connState","connState","ninchatclient",$funcType([$String],[],false),-1],["connect","connect","ninchatclient",$funcType([AR,($sliceType($String)),($ptrType(L))],[$Bool],false),-1],["discover","discover","ninchatclient",$funcType([],[],false),-1],["handleEvent","handleEvent","ninchatclient",$funcType([B.Object,B.Object],[$Uint64,$Bool,$Bool],false),-1],["handleSessionEvent","handleSessionEvent","ninchatclient",$funcType([B.Object],[$Bool],false),-1],["log","log","ninchatclient",$funcType([($sliceType($emptyInterface))],[],true),-1],["makeCreateSessionAction","makeCreateSessionAction","ninchatclient",$funcType([],[B.Object],false),-1],["makeResumeSessionAction","makeResumeSessionAction","ninchatclient",$funcType([$Bool],[B.Object],false),-1],["resolve","resolve","ninchatclient",$funcType([($ptrType(D)),$Bool,($sliceType($emptyInterface))],[],true),-1],["send","send","ninchatclient",$funcType([($ptrType(D))],[],false),-1],["sendAck","sendAck","ninchatclient",$funcType([],[],false),-1]];AS.init([["onSessionEvent","onSessionEvent","ninchatclient",B.Object,""],["onEvent","onEvent","ninchatclient",B.Object,""],["onConnState","onConnState","ninchatclient",B.Object,""],["onConnActive","onConnActive","ninchatclient",B.Object,""],["onLog","onLog","ninchatclient",B.Object,""],["address","address","ninchatclient",$String,""],["forceLongPoll","forceLongPoll","ninchatclient",$Bool,""],["sessionParams","sessionParams","ninchatclient",B.Object,""],["sessionId","sessionId","ninchatclient",B.Object,""],["latestConnState","latestConnState","ninchatclient",$String,""],["latestConnActive","latestConnActive","ninchatclient",AU,""],["lastActionId","lastActionId","ninchatclient",$Uint64,""],["sendNotify","sendNotify","ninchatclient",($chanType($Bool,false,false)),""],["sendBuffer","sendBuffer","ninchatclient",($sliceType(($ptrType(D)))),""],["numSent","numSent","ninchatclient",$Int,""],["sendEventAck","sendEventAck","ninchatclient",$Bool,""],["receivedEventId","receivedEventId","ninchatclient",$Uint64,""],["ackedEventId","ackedEventId","ninchatclient",$Uint64,""],["closeNotify","closeNotify","ninchatclient",($chanType($Bool,false,false)),""],["closed","closed","ninchatclient",$Bool,""],["stopped","stopped","ninchatclient",$Bool,""]]);($ptrType(AX)).methods=[["Active","Active","",$funcType([],[$Bool],false),-1],["Reset","Reset","",$funcType([AV],[],false),-1],["Stop","Stop","",$funcType([],[],false),-1]];AX.init([["C","C","",($chanType($Bool,false,false)),""],["id","id","ninchatclient",B.Object,""]]);($ptrType(BA)).methods=[["Close","Close","",$funcType([],[$error],false),-1],["Receive","Receive","",$funcType([],[B.Object,$error],false),-1],["ReceiveJSON","ReceiveJSON","",$funcType([],[B.Object,$error],false),-1],["Send","Send","",$funcType([$emptyInterface],[$error],false),-1],["SendJSON","SendJSON","",$funcType([$emptyInterface],[$error],false),-1]];BA.init([["Notify","Notify","",($chanType($Bool,false,false)),""],["impl","impl","ninchatclient",B.Object,""],["open","open","ninchatclient",$Bool,""],["error","error","ninchatclient",$error,""],["buffer","buffer","ninchatclient",($sliceType(B.Object)),""]]);AC=0;AL=V();AQ=P(new $Uint64(0,4096),-0.25);$pkg.WebSocketSupported=!($global.WebSocket===undefined);};return $pkg;})();
$go($packages["ninchatclient"].$run, [], true);

})();
//# sourceMappingURL=ninchatclient.min.js.map
